<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content=0x5h1n0k0><link href=https://0x5h1n0k0.github.io/tryhackme/room/hacking-with-powershell/ rel=canonical><link rel=icon href=../../../assets/favicon.png><meta name=generator content="mkdocs-1.5.2, mkdocs-material-8.3.9"><title>TryHackMe - Hacking with Powershell - Walkthrough | 0x5h1n0k0</title><link rel=stylesheet href=../../../assets/stylesheets/main.1d29e8d0.min.css><link rel=stylesheet href=../../../assets/stylesheets/cur.css><link rel=stylesheet href=../../../assets/stylesheets/footer.scss><link rel=stylesheet href=../../../assets/stylesheets/palette.cbb835fc.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Fira+Sans:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Fira Sans";--md-code-font:"Fira Code"}</style><link rel=stylesheet href=../../../stylesheets/extra.css><script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-XXXXXXXXXX"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&gtag("event","search",{search_term:this.value})}),"undefined"!=typeof location$&&location$.subscribe(function(e){gtag("config","G-XXXXXXXXXX",{page_path:e.pathname})})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script><link rel=stylesheet href=../../../overrides/assets/stylesheets/main.82a244a8.min.css><!-- live 2d --><link href=https://r18-nmsl.cn/pio/pio.css rel=stylesheet type=text/css><!-- <link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css">
    <script src="https://fastly.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/autoload.js"></script> --></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#tryhackme-hacking-with-powershell-walkthrough class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title=0x5h1n0k0 class="md-header__button md-logo" aria-label=0x5h1n0k0 data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82z"></path></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> 0x5h1n0k0 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> TryHackMe - Hacking with Powershell - Walkthrough </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/0x5h1n0k0/0x5h1n0k0.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> 0x5h1n0k0/0x5h1n0k0.github.io <ul class=md-source__facts> </ul> </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=0x5h1n0k0 class="md-nav__button md-logo" aria-label=0x5h1n0k0 data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82z"></path></svg> </a> 0x5h1n0k0 </label> <div class=md-nav__source> <a href=https://github.com/0x5h1n0k0/0x5h1n0k0.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> 0x5h1n0k0/0x5h1n0k0.github.io <ul class=md-source__facts> </ul> </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1> PINNED <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=PINNED data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> PINNED </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1_1 type=checkbox id=__nav_1_1> <label class=md-nav__link for=__nav_1_1> Privilege Escalation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Privilege Escalation" data-md-level=2> <label class=md-nav__title for=__nav_1_1> <span class="md-nav__icon md-icon"></span> Privilege Escalation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../notes/privilege-escalation/linux/ class=md-nav__link> Linux Privilege Escalation </a> </li> <li class=md-nav__item> <a href=../../../notes/privilege-escalation/windows/ class=md-nav__link> Windows Privilege Escalation </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../notes/reverse-shell/ class=md-nav__link> Reverse Shell Cheatsheet </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> Try Hack Me <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Try Hack Me" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Try Hack Me </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_1 type=checkbox id=__nav_2_1> <label class=md-nav__link for=__nav_2_1> Learning Paths <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Learning Paths" data-md-level=2> <label class=md-nav__title for=__nav_2_1> <span class="md-nav__icon md-icon"></span> Learning Paths </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_1_1 type=checkbox id=__nav_2_1_1> <label class=md-nav__link for=__nav_2_1_1> Red Teaming <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Red Teaming" data-md-level=3> <label class=md-nav__title for=__nav_2_1_1> <span class="md-nav__icon md-icon"></span> Red Teaming </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_1_1_1 type=checkbox id=__nav_2_1_1_1> <label class=md-nav__link for=__nav_2_1_1_1> Init Access <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Init Access" data-md-level=4> <label class=md-nav__title for=__nav_2_1_1_1> <span class="md-nav__icon md-icon"></span> Init Access </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../red-team-weaponization/ class=md-nav__link> Weaponization </a> </li> <li class=md-nav__item> <a href=../password-attacks/ class=md-nav__link> Password Attacks </a> </li> <li class=md-nav__item> <a href=../phishing/ class=md-nav__link> Phishing </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_1_1_2 type=checkbox id=__nav_2_1_1_2> <label class=md-nav__link for=__nav_2_1_1_2> Post Compromise <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Post Compromise" data-md-level=4> <label class=md-nav__title for=__nav_2_1_1_2> <span class="md-nav__icon md-icon"></span> Post Compromise </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../the-lay-of-the-land/ class=md-nav__link> The Lay of the Land </a> </li> <li class=md-nav__item> <a href=../enumeration/ class=md-nav__link> Enumeration </a> </li> <li class=md-nav__item> <a href=../windows-local-persistence/ class=md-nav__link> Windows Local Persistence </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2 type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2> Practice <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Practice data-md-level=2> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Practice </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../startup/ class=md-nav__link> Startup </a> </li> <li class=md-nav__item> <a href=../skynet/ class=md-nav__link> Skynet </a> </li> <li class=md-nav__item> <a href=../easyctf/ class=md-nav__link> Simple CTF </a> </li> <li class=md-nav__item> <a href=../lazyadmin/ class=md-nav__link> LazyAdmin </a> </li> <li class=md-nav__item> <a href=../rootme/ class=md-nav__link> RootMe </a> </li> <li class=md-nav__item> <a href=../basic-pentesting/ class=md-nav__link> Basic Pentesting </a> </li> <li class=md-nav__item> <a href=../lianyu/ class=md-nav__link> Lian_Yu </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../tags/tags/ class=md-nav__link> Categories </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#task-1-objectives class=md-nav__link> Task 1: Objectives </a> </li> <li class=md-nav__item> <a href=#task-2-what-is-powershell class=md-nav__link> Task 2: What is Powershell? </a> </li> <li class=md-nav__item> <a href=#task-3-basic-powershell-commands class=md-nav__link> Task 3: Basic Powershell Commands </a> <nav class=md-nav aria-label="Task 3: Basic Powershell Commands"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#using-get-help class=md-nav__link> Using Get-Help </a> </li> <li class=md-nav__item> <a href=#using-get-command class=md-nav__link> Using Get-Command </a> </li> <li class=md-nav__item> <a href=#object-manipulation class=md-nav__link> Object Manipulation </a> </li> <li class=md-nav__item> <a href=#creating-objects-from-previous-cmdlets class=md-nav__link> Creating Objects From Previous cmdlets </a> </li> <li class=md-nav__item> <a href=#filtering-objects class=md-nav__link> Filtering Objects </a> </li> <li class=md-nav__item> <a href=#sort-object class=md-nav__link> Sort-Object </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#task-4-enumeration class=md-nav__link> Task 4: Enumeration </a> </li> <li class=md-nav__item> <a href=#task-5-basic-scripting-challenge class=md-nav__link> Task 5: Basic Scripting Challenge </a> </li> <li class=md-nav__item> <a href=#task-6-intermediate-scripting class=md-nav__link> Task 6: Intermediate Scripting </a> </li> <li class=md-nav__item> <a href=#more class=md-nav__link> More </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <aside class=mdx-author> </aside> <div class=tags-items style="color: var(--md-default-fg-color--light); padding-bottom: 10px; opacity: 0.9">Tags</div> <a href=https://github.com/0x5h1n0k0/0x5h1n0k0.github.io/edit/master/docs/tryhackme/room/hacking-with-powershell/index.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg> </a> <a href=https://github.com/0x5h1n0k0/0x5h1n0k0.github.io/edit/master/docs/tryhackme/room/hacking-with-powershell/index.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg> </a> <nav class=md-tags> <a href=../../../tags/tags/#thm-room class=md-tag> THM-Room </a> </nav> <h1 id=tryhackme-hacking-with-powershell-walkthrough><strong>TryHackMe - Hacking with Powershell - Walkthrough</strong><a class=headerlink href=#tryhackme-hacking-with-powershell-walkthrough title="Permanent link">&para;</a></h1><p style="color:#bdbdbd"><i>Estimated time to read: 31 minutes</i></p>
 <hr> <h2 id=task-1-objectives><strong>Task 1: Objectives</strong><a class=headerlink href=#task-1-objectives title="Permanent link">&para;</a></h2> <p><span> <span class="twemoji mdx-heart content-heart"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14 20.408c-.492.308-.903.546-1.192.709-.153.086-.308.17-.463.252h-.002a.75.75 0 0 1-.686 0 16.709 16.709 0 0 1-.465-.252 31.147 31.147 0 0 1-4.803-3.34C3.8 15.572 1 12.331 1 8.513 1 5.052 3.829 2.5 6.736 2.5 9.03 2.5 10.881 3.726 12 5.605 13.12 3.726 14.97 2.5 17.264 2.5 20.17 2.5 23 5.052 23 8.514c0 3.818-2.801 7.06-5.389 9.262A31.146 31.146 0 0 1 14 20.408z"></path></svg> </span> <span class=content-wu> Content </span> </span></p> <p>Before completing this room, you should be aware of some fundamentals. For example, the differences between CMD, PS and some syntax. This room will cover the following:</p> <ul> <li>What is Powershell</li> <li>Basic Powershell commands</li> <li>Windows enumeration skills</li> <li>Powershell scripting</li> </ul> <p><span> <span class="twemoji mdx-heart ans-wu"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14 20.408c-.492.308-.903.546-1.192.709-.153.086-.308.17-.463.252h-.002a.75.75 0 0 1-.686 0 16.709 16.709 0 0 1-.465-.252 31.147 31.147 0 0 1-4.803-3.34C3.8 15.572 1 12.331 1 8.513 1 5.052 3.829 2.5 6.736 2.5 9.03 2.5 10.881 3.726 12 5.605 13.12 3.726 14.97 2.5 17.264 2.5 20.17 2.5 23 5.052 23 8.514c0 3.818-2.801 7.06-5.389 9.262A31.146 31.146 0 0 1 14 20.408z"></path></svg> </span> <span class="content-wu ans-wu"> Answer the questions below </span> </span></p> <div class="admonition question"> <p class=admonition-title><strong>Read the above and deploy the machine!</strong></p> <p>No answer needed</p> </div> <h2 id=task-2-what-is-powershell><strong>Task 2: What is Powershell?</strong><a class=headerlink href=#task-2-what-is-powershell title="Permanent link">&para;</a></h2> <p><span> <span class="twemoji mdx-heart content-heart"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14 20.408c-.492.308-.903.546-1.192.709-.153.086-.308.17-.463.252h-.002a.75.75 0 0 1-.686 0 16.709 16.709 0 0 1-.465-.252 31.147 31.147 0 0 1-4.803-3.34C3.8 15.572 1 12.331 1 8.513 1 5.052 3.829 2.5 6.736 2.5 9.03 2.5 10.881 3.726 12 5.605 13.12 3.726 14.97 2.5 17.264 2.5 20.17 2.5 23 5.052 23 8.514c0 3.818-2.801 7.06-5.389 9.262A31.146 31.146 0 0 1 14 20.408z"></path></svg> </span> <span class=content-wu> Content </span> </span></p> <p>Powershell is the Windows Scripting Language and shell environment built using the .NET framework.</p> <p>This also allows Powershell to execute .NET functions directly from its shell. Most Powershell commands, called cmdlets, are written in .NET. Unlike other scripting languages and shell environments, the output of these cmdlets are objects - making Powershell somewhat object-oriented.</p> <p>This also means that running cmdlets allows you to perform actions on the output object (which makes it convenient to pass output from one cmdlet to another). The normal format of a cmdlet is represented using <strong>Verb-Noun</strong>; for example, the cmdlet to list commands is called <code>Get-Command</code></p> <p>Common verbs to use include:</p> <ul> <li>Get</li> <li>Start</li> <li>Stop </li> <li>Read</li> <li>Write</li> <li>New</li> <li>Out</li> </ul> <p>To get the complete list of approved verbs, visit <a href="https://docs.microsoft.com/en-us/powershell/scripting/developer/cmdlet/approved-verbs-for-windows-powershell-commands?view=powershell-7">this</a> link.</p> <p><span> <span class="twemoji mdx-heart ans-wu"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14 20.408c-.492.308-.903.546-1.192.709-.153.086-.308.17-.463.252h-.002a.75.75 0 0 1-.686 0 16.709 16.709 0 0 1-.465-.252 31.147 31.147 0 0 1-4.803-3.34C3.8 15.572 1 12.331 1 8.513 1 5.052 3.829 2.5 6.736 2.5 9.03 2.5 10.881 3.726 12 5.605 13.12 3.726 14.97 2.5 17.264 2.5 20.17 2.5 23 5.052 23 8.514c0 3.818-2.801 7.06-5.389 9.262A31.146 31.146 0 0 1 14 20.408z"></path></svg> </span> <span class="content-wu ans-wu"> Answer the questions below </span> </span></p> <div class="admonition question"> <p class=admonition-title><strong>What is the command to get a new object?</strong></p> <p>Get-New</p> </div> <p>To see the usage of a cmdlet we use the syntax <code>Get-Help + &lt;name of cmdlet&gt; -Examples</code>. For example, we want to see the usage of the Get-Command[^2] command, we use the <code>Get-Help Get-Command -Examples</code> syntax. See picture bellow.</p> <figure> <p><img alt="Image title" src=/blog/offensive-security/init-access/red-team-weaponization/images/powershell-getcommand.png#zoom> </p> <figcaption>This pic describes how to use the Get-Command command syntax</figcaption> </figure> <h2 id=task-3-basic-powershell-commands><strong>Task 3: Basic Powershell Commands</strong><a class=headerlink href=#task-3-basic-powershell-commands title="Permanent link">&para;</a></h2> <p><span> <span class="twemoji mdx-heart content-heart"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14 20.408c-.492.308-.903.546-1.192.709-.153.086-.308.17-.463.252h-.002a.75.75 0 0 1-.686 0 16.709 16.709 0 0 1-.465-.252 31.147 31.147 0 0 1-4.803-3.34C3.8 15.572 1 12.331 1 8.513 1 5.052 3.829 2.5 6.736 2.5 9.03 2.5 10.881 3.726 12 5.605 13.12 3.726 14.97 2.5 17.264 2.5 20.17 2.5 23 5.052 23 8.514c0 3.818-2.801 7.06-5.389 9.262A31.146 31.146 0 0 1 14 20.408z"></path></svg> </span> <span class=content-wu> Content </span> </span></p> <p>Now that we've understood how cmdlets work - let's explore how to use them! The main thing to remember here is that <code>Get-Command</code> and <code>Get-Help</code> are your best friends! </p> <h3 id=using-get-help><strong>Using Get-Help</strong><a class=headerlink href=#using-get-help title="Permanent link">&para;</a></h3> <p><code>Get-Help</code> displays information about a cmdlet. To get help with a particular command, run the following:</p> <p><code>Get-Help Command-Name</code></p> <p>You can also understand how exactly to use the command by passing in the <code>-examples</code> flag. This would return output like the following: </p> <div class=result> <div class=highlight><span class=filename>Running the Get-Help cmdlet to explain a command</span><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nb>PS </span><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>Administrator</span><span class=p>&gt;</span> <span class=nb>Get-Help</span> <span class=nb>Get-Command</span> <span class=n>-Examples</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=n>NAME</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>    <span class=nb>Get-Command</span>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=n>SYNOPSIS</span>
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=n>Gets</span> <span class=n>all</span> <span class=n>commands</span><span class=p>.</span>
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=n>Example</span> <span class=n>1</span><span class=p>:</span> <span class=n>Get</span> <span class=n>cmdlets</span><span class=p>,</span> <span class=n>functions</span><span class=p>,</span> <span class=n>and</span> <span class=n>aliases</span>
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=nb>PS </span><span class=n>C</span><span class=p>:\&gt;</span><span class=nb>Get-Command</span>
</code></pre></div> </div> <h3 id=using-get-command><strong>Using Get-Command</strong><a class=headerlink href=#using-get-command title="Permanent link">&para;</a></h3> <p><code>Get-Command</code> gets all the cmdlets installed on the current Computer. The great thing about this cmdlet is that it allows for pattern matching like the following <code>Get-Command Verb-*</code> or <code>Get-Command *-Noun</code></p> <p>Running <code>Get-Command New-*</code> to view all the cmdlets for the verb new displays the following: </p> <div class=result> <div class=highlight><span class=filename>Using the Get-Command to list all cmdlets installed</span><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=nb>PS </span><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>Administrator</span><span class=p>&gt;</span> <span class=nb>Get-Command</span> <span class=n>New</span><span class=p>-*</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=n>CommandType</span>     <span class=n>Name</span>                                               <span class=n>Version</span>    <span class=n>Source</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=p>-----------</span>     <span class=p>----</span>                                               <span class=p>-------</span>    <span class=p>------</span>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=k>Alias</span>           <span class=nb>New-AWSCredentials</span>                                 <span class=n>3</span><span class=p>.</span><span class=n>3</span><span class=p>.</span><span class=n>563</span><span class=p>.</span><span class=n>1</span>  <span class=n>AWSPowerShell</span>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=k>Alias</span>           <span class=nb>New-EC2FlowLogs</span>                                    <span class=n>3</span><span class=p>.</span><span class=n>3</span><span class=p>.</span><span class=n>563</span><span class=p>.</span><span class=n>1</span>  <span class=n>AWSPowerShell</span>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=k>Alias</span>           <span class=nb>New-EC2Hosts</span>                                       <span class=n>3</span><span class=p>.</span><span class=n>3</span><span class=p>.</span><span class=n>563</span><span class=p>.</span><span class=n>1</span>  <span class=n>AWSPowerShell</span>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=k>Alias</span>           <span class=nb>New-RSTags</span>                                         <span class=n>3</span><span class=p>.</span><span class=n>3</span><span class=p>.</span><span class=n>563</span><span class=p>.</span><span class=n>1</span>  <span class=n>AWSPowerShell</span>
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=k>Alias</span>           <span class=nb>New-SGTapes</span>                                        <span class=n>3</span><span class=p>.</span><span class=n>3</span><span class=p>.</span><span class=n>563</span><span class=p>.</span><span class=n>1</span>  <span class=n>AWSPowerShell</span>
<a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=k>Function</span>        <span class=nb>New-AutologgerConfig</span>                               <span class=n>1</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span>    <span class=n>EventTracingManagement</span>
<a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=k>Function</span>        <span class=nb>New-DAEntryPointTableItem</span>                          <span class=n>1</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span>    <span class=n>DirectAccessClientComponents</span>
<a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a><span class=k>Function</span>        <span class=nb>New-DscChecksum</span>                                    <span class=n>1</span><span class=p>.</span><span class=n>1</span>        <span class=n>PSDesiredStateConfiguration</span>
<a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a><span class=k>Function</span>        <span class=nb>New-EapConfiguration</span>                               <span class=n>2</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span>    <span class=n>VpnClient</span>
<a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a><span class=k>Function</span>        <span class=nb>New-EtwTraceSession</span>                                <span class=n>1</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span>    <span class=n>EventTracingManagement</span>
<a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a><span class=k>Function</span>        <span class=nb>New-FileShare</span>                                      <span class=n>2</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span>    <span class=n>Storage</span>
<a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a><span class=k>Function</span>        <span class=nb>New-Fixture</span>                                        <span class=n>3</span><span class=p>.</span><span class=n>4</span><span class=p>.</span><span class=n>0</span>      <span class=n>Pester</span>
<a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a><span class=k>Function</span>        <span class=nb>New-Guid</span>                                           <span class=n>3</span><span class=p>.</span><span class=n>1</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span>    <span class=n>Microsoft</span><span class=p>.</span><span class=n>PowerShell</span><span class=p>.</span><span class=n>Utility</span>
<a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a><span class=p>-</span><span class=n>-cropped</span> <span class=k>for</span> <span class=n>brevity</span><span class=p>--</span>
</code></pre></div> </div> <h3 id=object-manipulation><strong>Object Manipulation</strong><a class=headerlink href=#object-manipulation title="Permanent link">&para;</a></h3> <p>In the previous task, we saw how the output of every cmdlet is an object. If we want to manipulate the output, we need to figure out a few things:</p> <ul> <li>passing the output to other cmdlets</li> <li>using specific object cmdlets to extract information</li> </ul> <p>The Pipeline(<code>|</code>) is used to pass output from one cmdlet to another. A major difference compared to other shells is that Powershell passes an object to the next cmdlet instead of passing text or string to the command after the pipe. Like every object in object-oriented frameworks, an object will contain methods and properties.</p> <p>You can think of methods as functions that can be applied to output from the cmdlet, and you can think of properties as variables in the output from a cmdlet. To view these details, pass the output of a cmdlet to the <code>Get-Member</code> cmdlet:</p> <p><code>Verb-Noun | Get-Member</code> </p> <p>An example of running this to view the members for <code>Get-Command</code> is:</p> <p><code>Get-Command | Get-Member -MemberType Method</code></p> <div class=result> <div class=highlight><span class=filename>Using pipe (|) to pass output from one cmdlet to another</span><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=nb>PS </span><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>Administrator</span><span class=p>&gt;</span> <span class=nb>Get-Command</span> <span class=p>|</span> <span class=nb>Get-Member</span> <span class=n>-MemberType</span> <span class=n>Method</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>   <span class=n>TypeName</span><span class=p>:</span> <span class=n>System</span><span class=p>.</span><span class=n>Management</span><span class=p>.</span><span class=n>Automation</span><span class=p>.</span><span class=n>AliasInfo</span>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=n>Name</span>             <span class=n>MemberType</span> <span class=n>Definition</span>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=p>----</span>             <span class=p>----------</span> <span class=p>----------</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=n>Equals</span>           <span class=n>Method</span>     <span class=n>bool</span> <span class=n>Equals</span><span class=p>(</span><span class=n>System</span><span class=p>.</span><span class=n>Object</span> <span class=n>obj</span><span class=p>)</span>
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=n>GetHashCode</span>      <span class=n>Method</span>     <span class=n>int</span> <span class=n>GetHashCode</span><span class=p>()</span>
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=n>GetType</span>          <span class=n>Method</span>     <span class=nb>type </span><span class=n>GetType</span><span class=p>()</span>
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=n>ResolveParameter</span> <span class=n>Method</span>     <span class=n>System</span><span class=p>.</span><span class=n>Management</span><span class=p>.</span><span class=n>Automation</span><span class=p>.</span><span class=n>ParameterMetadata</span> <span class=n>ResolveParameter</span><span class=p>(</span><span class=n>string</span> <span class=n>name</span><span class=p>)</span>
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=n>ToString</span>         <span class=n>Method</span>     <span class=n>string</span> <span class=n>ToString</span><span class=p>()</span>
<a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a>
<a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a>
<a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a>   <span class=n>TypeName</span><span class=p>:</span> <span class=n>System</span><span class=p>.</span><span class=n>Management</span><span class=p>.</span><span class=n>Automation</span><span class=p>.</span><span class=n>FunctionInfo</span>
<a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a>
<a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a><span class=n>Name</span>             <span class=n>MemberType</span> <span class=n>Definition</span>
<a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a><span class=p>----</span>             <span class=p>----------</span> <span class=p>----------</span>
<a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a><span class=n>Equals</span>           <span class=n>Method</span>     <span class=n>bool</span> <span class=n>Equals</span><span class=p>(</span><span class=n>System</span><span class=p>.</span><span class=n>Object</span> <span class=n>obj</span><span class=p>)</span>
<a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a><span class=n>GetHashCode</span>      <span class=n>Method</span>     <span class=n>int</span> <span class=n>GetHashCode</span><span class=p>()</span>
<a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a><span class=n>GetType</span>          <span class=n>Method</span>     <span class=nb>type </span><span class=n>GetType</span><span class=p>()</span>
<a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a><span class=n>ResolveParameter</span> <span class=n>Method</span>     <span class=n>System</span><span class=p>.</span><span class=n>Management</span><span class=p>.</span><span class=n>Automation</span><span class=p>.</span><span class=n>ParameterMetadata</span> <span class=n>ResolveParameter</span><span class=p>(</span><span class=n>string</span> <span class=n>name</span><span class=p>)</span>
<a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a><span class=n>ToString</span>         <span class=n>Method</span>     <span class=n>string</span> <span class=n>ToString</span><span class=p>()</span>
<a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a>
<a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a>
<a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a>   <span class=n>TypeName</span><span class=p>:</span> <span class=n>System</span><span class=p>.</span><span class=n>Management</span><span class=p>.</span><span class=n>Automation</span><span class=p>.</span><span class=n>CmdletInfo</span>
<a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a>
<a id=__codelineno-2-28 name=__codelineno-2-28 href=#__codelineno-2-28></a><span class=n>Name</span>             <span class=n>MemberType</span> <span class=n>Definition</span>
<a id=__codelineno-2-29 name=__codelineno-2-29 href=#__codelineno-2-29></a><span class=p>----</span>             <span class=p>----------</span> <span class=p>----------</span>
<a id=__codelineno-2-30 name=__codelineno-2-30 href=#__codelineno-2-30></a><span class=n>Equals</span>           <span class=n>Method</span>     <span class=n>bool</span> <span class=n>Equals</span><span class=p>(</span><span class=n>System</span><span class=p>.</span><span class=n>Object</span> <span class=n>obj</span><span class=p>)</span>
<a id=__codelineno-2-31 name=__codelineno-2-31 href=#__codelineno-2-31></a><span class=n>GetHashCode</span>      <span class=n>Method</span>     <span class=n>int</span> <span class=n>GetHashCode</span><span class=p>()</span>
<a id=__codelineno-2-32 name=__codelineno-2-32 href=#__codelineno-2-32></a><span class=n>GetType</span>          <span class=n>Method</span>     <span class=nb>type </span><span class=n>GetType</span><span class=p>()</span>
<a id=__codelineno-2-33 name=__codelineno-2-33 href=#__codelineno-2-33></a><span class=n>ResolveParameter</span> <span class=n>Method</span>     <span class=n>System</span><span class=p>.</span><span class=n>Management</span><span class=p>.</span><span class=n>Automation</span><span class=p>.</span><span class=n>ParameterMetadata</span> <span class=n>ResolveParameter</span><span class=p>(</span><span class=n>string</span> <span class=n>name</span><span class=p>)</span>
<a id=__codelineno-2-34 name=__codelineno-2-34 href=#__codelineno-2-34></a><span class=n>ToString</span>         <span class=n>Method</span>     <span class=n>string</span> <span class=n>ToString</span><span class=p>()</span>
<a id=__codelineno-2-35 name=__codelineno-2-35 href=#__codelineno-2-35></a>
<a id=__codelineno-2-36 name=__codelineno-2-36 href=#__codelineno-2-36></a>
<a id=__codelineno-2-37 name=__codelineno-2-37 href=#__codelineno-2-37></a><span class=nb>PS </span><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>Administrator</span><span class=p>&gt;</span>
</code></pre></div> <div class="admonition note"> <p class=admonition-title>From the above flag in the command, you can see that you can also select between methods and properties.</p> </div> </div> <h3 id=creating-objects-from-previous-cmdlets><strong>Creating Objects From Previous <em>cmdlets</em></strong><a class=headerlink href=#creating-objects-from-previous-cmdlets title="Permanent link">&para;</a></h3> <p>One way of manipulating objects is pulling out the properties from the output of a cmdlet and creating a new object. This is done using the <code>Select-Object</code> cmdlet. </p> <p>Here's an example of listing the directories and just selecting the mode and the name:</p> <div class=result> <div class=highlight><span class=filename>Listing the directories and filtering via mode and name</span><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=nb>PS </span><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>Administrator</span><span class=p>&gt;</span> <span class=nb>Get-ChildItem</span> <span class=p>|</span> <span class=nb>Select-Object</span> <span class=n>-Property</span> <span class=n>Mode</span><span class=p>,</span> <span class=n>Name</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=n>Mode</span>   <span class=n>Name</span>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=p>----</span>   <span class=p>----</span>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=n>d-r</span><span class=p>---</span> <span class=n>Contacts</span>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=n>d-r</span><span class=p>---</span> <span class=n>Desktop</span>
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=n>d-r</span><span class=p>---</span> <span class=n>Documents</span>
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=n>d-r</span><span class=p>---</span> <span class=n>Downloads</span>
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=n>d-r</span><span class=p>---</span> <span class=n>Favorites</span>
<a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=n>d-r</span><span class=p>---</span> <span class=n>Links</span>
<a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=n>d-r</span><span class=p>---</span> <span class=n>Music</span>
<a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a><span class=n>d-r</span><span class=p>---</span> <span class=n>Pictures</span>
<a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a><span class=n>d-r</span><span class=p>---</span> <span class=n>Saved</span> <span class=n>Games</span>
<a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a><span class=n>d-r</span><span class=p>---</span> <span class=n>Searches</span>
<a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a><span class=n>d-r</span><span class=p>---</span> <span class=n>Videos</span>
<a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a>
<a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a><span class=nb>PS </span><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>Administrator</span><span class=p>&gt;</span>
</code></pre></div> </div> <p>You can also use the following flags to select particular information:</p> <ul> <li>first - gets the first x object</li> <li>last - gets the last x object</li> <li>unique - shows the unique objects</li> <li>skip - skips x objects</li> </ul> <h3 id=filtering-objects><strong>Filtering Objects</strong><a class=headerlink href=#filtering-objects title="Permanent link">&para;</a></h3> <p>When retrieving output objects, you may want to select objects that match a very specific value. You can do this using the <code>Where-Object</code> to filter based on the value of properties. </p> <p>The general format for using this <em>cmdlet</em> is </p> <p><code>Verb-Noun | Where-Object -Property PropertyName -operator Value</code></p> <p><code>Verb-Noun | Where-Object {$_.PropertyName -operator Value}</code></p> <p>The second version uses the <code>$_</code> operator to iterate through every object passed to the <code>Where-Object</code> <em>cmdlet</em>.</p> <p><strong>Powershell is quite sensitive, so don't put quotes around the command!</strong></p> <p>Where <code>-operator</code> is a list of the following operators:</p> <ul> <li><code>-Contains</code>: if any item in the property value is an exact match for the specified value</li> <li><code>-EQ</code>: if the property value is the same as the specified value</li> <li><code>-GT</code>: if the property value is greater than the specified value</li> </ul> <p>For a full list of operators, use <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/where-object?view=powershell-6">this</a> link.</p> <p>Here's an example of checking the stopped processes:</p> <div class=result> <div class=highlight><span class=filename>Demonstrating the use of operators only to show stopped services</span><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=nb>PS </span><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>Administrator</span><span class=p>&gt;</span> <span class=nb>Get-Service</span> <span class=p>|</span> <span class=nb>Where-Object</span> <span class=n>-Property</span> <span class=n>Status</span> <span class=o>-eq</span> <span class=n>Stopped</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=n>Status</span>   <span class=n>Name</span>               <span class=n>DisplayName</span>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=p>------</span>   <span class=p>----</span>               <span class=p>-----------</span>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=n>Stopped</span>  <span class=n>AJRouter</span>           <span class=n>AllJoyn</span> <span class=n>Router</span> <span class=n>Service</span>
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=n>Stopped</span>  <span class=n>ALG</span>                <span class=n>Application</span> <span class=n>Layer</span> <span class=n>Gateway</span> <span class=n>Service</span>
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=n>Stopped</span>  <span class=n>AppIDSvc</span>           <span class=n>Application</span> <span class=n>Identity</span>
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=n>Stopped</span>  <span class=n>AppMgmt</span>            <span class=n>Application</span> <span class=n>Management</span>
<a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=n>Stopped</span>  <span class=n>AppReadiness</span>       <span class=n>App</span> <span class=n>Readiness</span>
<a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=n>Stopped</span>  <span class=n>AppVClient</span>         <span class=n>Microsoft</span> <span class=n>App-V</span> <span class=n>Client</span>
<a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a><span class=n>Stopped</span>  <span class=n>AppXSvc</span>            <span class=n>AppX</span> <span class=n>Deployment</span> <span class=n>Service</span> <span class=p>(</span><span class=n>AppXSVC</span><span class=p>)</span>
<a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a><span class=n>Stopped</span>  <span class=n>AudioEndpointBu</span><span class=p>...</span> <span class=n>Windows</span> <span class=n>Audio</span> <span class=n>Endpoint</span> <span class=n>Builder</span>
<a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a><span class=n>Stopped</span>  <span class=n>Audiosrv</span>           <span class=n>Windows</span> <span class=n>Audio</span>
<a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a><span class=n>Stopped</span>  <span class=n>AxInstSV</span>           <span class=n>ActiveX</span> <span class=n>Installer</span> <span class=p>(</span><span class=n>AxInstSV</span><span class=p>)</span>
<a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a><span class=n>Stopped</span>  <span class=n>BITS</span>               <span class=n>Background</span> <span class=n>Intelligent</span> <span class=n>Transfer</span> <span class=n>Ser</span><span class=p>...</span>
<a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a><span class=n>Stopped</span>  <span class=n>Browser</span>            <span class=n>Computer</span> <span class=n>Browser</span>
<a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a><span class=n>Stopped</span>  <span class=n>bthserv</span>            <span class=n>Bluetooth</span> <span class=n>Support</span> <span class=n>Service</span>
<a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a><span class=p>--</span> <span class=n>cropped</span> <span class=k>for</span> <span class=n>brevity</span><span class=p>--</span>
</code></pre></div> </div> <h3 id=sort-object><strong>Sort-Object</strong><a class=headerlink href=#sort-object title="Permanent link">&para;</a></h3> <p>When a <em>cmdlet</em> outputs a lot of information, you may need to sort it to extract the information more efficiently. You do this by pipe-lining the output of a <em>cmdlet</em> to the <code>Sort-Object</code> <em>cmdlet</em>.</p> <p>The format of the command would be:</p> <p><code>Verb-Noun | Sort-Object</code></p> <p>Here's an example of sorting the list of directories:</p> <div class=result> <div class=highlight><span class=filename>Using the Sort-Object cmdlet to sort piped information</span><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=nb>PS </span><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>Administrator</span><span class=p>&gt;</span> <span class=nb>Get-ChildItem</span> <span class=p>|</span> <span class=nb>Sort-Object</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>    <span class=n>Directory</span><span class=p>:</span> <span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>Administrator</span>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=n>Mode</span>                <span class=n>LastWriteTime</span>         <span class=n>Length</span> <span class=n>Name</span>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=p>----</span>                <span class=p>-------------</span>         <span class=p>------</span> <span class=p>----</span>
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=n>d-r</span><span class=p>---</span>        <span class=n>10</span><span class=p>/</span><span class=n>3</span><span class=p>/</span><span class=n>2019</span>   <span class=n>5</span><span class=p>:</span><span class=n>11</span> <span class=n>PM</span>                <span class=n>Contacts</span>
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=n>d-r</span><span class=p>---</span>        <span class=n>10</span><span class=p>/</span><span class=n>5</span><span class=p>/</span><span class=n>2019</span>   <span class=n>2</span><span class=p>:</span><span class=n>38</span> <span class=n>PM</span>                <span class=n>Desktop</span>
<a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=n>d-r</span><span class=p>---</span>        <span class=n>10</span><span class=p>/</span><span class=n>3</span><span class=p>/</span><span class=n>2019</span>  <span class=n>10</span><span class=p>:</span><span class=n>55</span> <span class=n>PM</span>                <span class=n>Documents</span>
<a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=n>d-r</span><span class=p>---</span>        <span class=n>10</span><span class=p>/</span><span class=n>3</span><span class=p>/</span><span class=n>2019</span>  <span class=n>11</span><span class=p>:</span><span class=n>51</span> <span class=n>PM</span>                <span class=n>Downloads</span>
<a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=n>d-r</span><span class=p>---</span>        <span class=n>10</span><span class=p>/</span><span class=n>3</span><span class=p>/</span><span class=n>2019</span>   <span class=n>5</span><span class=p>:</span><span class=n>11</span> <span class=n>PM</span>                <span class=n>Favorites</span>
<a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=n>d-r</span><span class=p>---</span>        <span class=n>10</span><span class=p>/</span><span class=n>3</span><span class=p>/</span><span class=n>2019</span>   <span class=n>5</span><span class=p>:</span><span class=n>11</span> <span class=n>PM</span>                <span class=n>Links</span>
<a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a><span class=n>d-r</span><span class=p>---</span>        <span class=n>10</span><span class=p>/</span><span class=n>3</span><span class=p>/</span><span class=n>2019</span>   <span class=n>5</span><span class=p>:</span><span class=n>11</span> <span class=n>PM</span>                <span class=n>Music</span>
<a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a><span class=n>d-r</span><span class=p>---</span>        <span class=n>10</span><span class=p>/</span><span class=n>3</span><span class=p>/</span><span class=n>2019</span>   <span class=n>5</span><span class=p>:</span><span class=n>11</span> <span class=n>PM</span>                <span class=n>Pictures</span>
<a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a><span class=n>d-r</span><span class=p>---</span>        <span class=n>10</span><span class=p>/</span><span class=n>3</span><span class=p>/</span><span class=n>2019</span>   <span class=n>5</span><span class=p>:</span><span class=n>11</span> <span class=n>PM</span>                <span class=n>Saved</span> <span class=n>Games</span>
<a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a><span class=n>d-r</span><span class=p>---</span>        <span class=n>10</span><span class=p>/</span><span class=n>3</span><span class=p>/</span><span class=n>2019</span>   <span class=n>5</span><span class=p>:</span><span class=n>11</span> <span class=n>PM</span>                <span class=n>Searches</span>
<a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a><span class=n>d-r</span><span class=p>---</span>        <span class=n>10</span><span class=p>/</span><span class=n>3</span><span class=p>/</span><span class=n>2019</span>   <span class=n>5</span><span class=p>:</span><span class=n>11</span> <span class=n>PM</span>                <span class=n>Videos</span>
<a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a><span class=nb>PS </span><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>Administrator</span><span class=p>&gt;</span>
</code></pre></div> </div> <div class="admonition note"> <p class=admonition-title>Now that you've understood how Powershell works let's try some commands to apply this knowledge!</p> </div> <hr> <p><span> <span class="twemoji mdx-heart ans-wu"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14 20.408c-.492.308-.903.546-1.192.709-.153.086-.308.17-.463.252h-.002a.75.75 0 0 1-.686 0 16.709 16.709 0 0 1-.465-.252 31.147 31.147 0 0 1-4.803-3.34C3.8 15.572 1 12.331 1 8.513 1 5.052 3.829 2.5 6.736 2.5 9.03 2.5 10.881 3.726 12 5.605 13.12 3.726 14.97 2.5 17.264 2.5 20.17 2.5 23 5.052 23 8.514c0 3.818-2.801 7.06-5.389 9.262A31.146 31.146 0 0 1 14 20.408z"></path></svg> </span> <span class="content-wu ans-wu"> Answer the questions below </span> </span></p> <div class="admonition question"> <p class=admonition-title><strong>What is the location of the file "interesting-file.txt"</strong></p> <div class="tabbed-set tabbed-alternate" data-tabs=1:2><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>Answer</label><label for=__tabbed_1_2>Explain</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=n>C</span><span class=p>:\</span><span class=n>Program</span> <span class=n>Files</span>
</code></pre></div> </div> <div class=tabbed-block> <p>To find the file interesting-file.txt we will scan the directory with the following command: <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=nb>Get-ChildItem</span> <span class=n>-Path</span> <span class=n>D</span><span class=p>:\</span> <span class=n>-Include</span> <span class=p>*</span><span class=n>interesting</span><span class=o>-file</span><span class=p>*.</span><span class=n>txt</span> <span class=o>-File</span> <span class=n>-Recurse</span> <span class=n>-ErrorAction</span> <span class=n>SilentlyContinue</span>
</code></pre></div> I will explain the flags:</p> <ol> <li>Flag -Path: Specify the path to scan</li> <li>Flag -Include: Specify the file to scan (You can use the <code>*</code> operator to specify to find files whose filename includes the string between the two <code>*</code> operators we have set.)</li> <li>Flag -File: Specify only file</li> <li>Flag -Recurse: Recursive search</li> <li>Flag -ErrorAction SilentlyContinue: Ignore error</li> </ol> </div> </div> </div> </div> <div class="admonition question"> <p class=admonition-title><strong>Specify the contents of this file</strong></p> <div class="tabbed-set tabbed-alternate" data-tabs=2:2><input checked=checked id=__tabbed_2_1 name=__tabbed_2 type=radio><input id=__tabbed_2_2 name=__tabbed_2 type=radio><div class=tabbed-labels><label for=__tabbed_2_1>Answer</label><label for=__tabbed_2_2>Explain</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=n>notsointerestingcontent</span>
</code></pre></div> </div> <div class=tabbed-block> <p>To view content of file, you can use: <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=n>1</span><span class=p>.</span> <span class=nb>Get-Content</span> <span class=n>-Path</span> <span class=p>+</span> <span class=n>path_of_file</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=n>2</span><span class=p>.</span> <span class=n>More</span> <span class=p>+</span> <span class=n>path_of_file</span>
</code></pre></div></p> </div> </div> </div> </div> <div class="admonition question"> <p class=admonition-title><strong>How many cmdlets are installed on the system(only cmdlets, not functions and aliases)?</strong></p> <div class="tabbed-set tabbed-alternate" data-tabs=3:2><input checked=checked id=__tabbed_3_1 name=__tabbed_3 type=radio><input id=__tabbed_3_2 name=__tabbed_3 type=radio><div class=tabbed-labels><label for=__tabbed_3_1>Answer</label><label for=__tabbed_3_2>Explain</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=n>6638</span>
</code></pre></div> </div> <div class=tabbed-block> <p>First of all, you must know all functions and cmdlets on the system by listing them. Use <code>Get-Commnad</code>. You see that the output consists of 4 columns in order: CommandType, Name, Version, Source. Focus at CommandType to filter. Second, filter the results to find the number of cmdlets by: <code>Where-Object -Property CommandType -like Cmdlet</code>. Ye, you have filtered out all cmdlets on the system. Last, let's count them by <code>Measure command</code></p> <p><figure markdown> <img alt="Image title" src=/blog/room/hacking-with-powershell/images/t3q3.png#zoom> <figcaption>The image describes the result</figcaption> </figure></p> </div> </div> </div> </div> <div class="admonition question"> <p class=admonition-title><strong>Get the MD5 hash of interesting-file.txt</strong></p> <div class="tabbed-set tabbed-alternate" data-tabs=4:2><input checked=checked id=__tabbed_4_1 name=__tabbed_4 type=radio><input id=__tabbed_4_2 name=__tabbed_4 type=radio><div class=tabbed-labels><label for=__tabbed_4_1>Answer</label><label for=__tabbed_4_2>Explain</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=n>49A586A2A9456226F8A1B4CEC6FAB329</span>
</code></pre></div> </div> <div class=tabbed-block> <p>To get hash of file, you can use Get-FileHash + <file path_of_file> -Algorithm -MD5. The full syntax to solve this question is: <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=nb>Get-FileHash</span> <span class=n>C</span><span class=p>:\</span><span class=s1>&#39;Program Files&#39;</span><span class=p>\</span><span class=n>interesting</span><span class=o>-file</span><span class=p>.</span><span class=n>txt</span><span class=p>.</span><span class=n>txt</span> <span class=n>-Algorithm</span> <span class=n>-MD5</span>
</code></pre></div></p> </div> </div> </div> </div> <div class="admonition question"> <p class=admonition-title><strong>What is the command to get the current working directory?</strong></p> <div class="tabbed-set tabbed-alternate" data-tabs=5:2><input checked=checked id=__tabbed_5_1 name=__tabbed_5 type=radio><input id=__tabbed_5_2 name=__tabbed_5 type=radio><div class=tabbed-labels><label for=__tabbed_5_1>Answer</label><label for=__tabbed_5_2>Explain</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=nb>Get-Location</span>
</code></pre></div> </div> <div class=tabbed-block> <p>To get the current working directory, you will use Get-Location command. Furthermore, you can use Get-LocalUser command to computer show up <code>all user</code> in computer.</p> </div> </div> </div> </div> <div class="admonition question"> <p class=admonition-title><strong>Does the path "C:\Users\Administrator\Documents\Passwords" Exist (Y/N)?</strong></p> <div class="tabbed-set tabbed-alternate" data-tabs=6:2><input checked=checked id=__tabbed_6_1 name=__tabbed_6 type=radio><input id=__tabbed_6_2 name=__tabbed_6 type=radio><div class=tabbed-labels><label for=__tabbed_6_1>Answer</label><label for=__tabbed_6_2>Explain</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=n>N</span>
</code></pre></div> </div> <div class=tabbed-block> <p>Like the previous scenario, we will use <code>Get-Location + path</code> to check if the working directory exists or not. </p> <p>Full syntax: <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=nb>Get-Location</span> <span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>Administrator</span><span class=p>\</span><span class=n>Documents</span><span class=p>\</span><span class=n>Passwords</span>
</code></pre></div></p> <p><figure markdown> <img alt="Image title" src=/blog/room/hacking-with-powershell/images/t3q4.png#zoom> <figcaption>The image describes the result</figcaption> </figure></p> </div> </div> </div> </div> <div class="admonition question"> <p class=admonition-title><strong>What command would you use to make a request to a web server?</strong></p> <div class="tabbed-set tabbed-alternate" data-tabs=7:2><input checked=checked id=__tabbed_7_1 name=__tabbed_7 type=radio><input id=__tabbed_7_2 name=__tabbed_7 type=radio><div class=tabbed-labels><label for=__tabbed_7_1>Answer</label><label for=__tabbed_7_2>Explain</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=nb>Invoke-WebRequest</span>
</code></pre></div> </div> <div class=tabbed-block> <p><a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/invoke-webrequest?view=powershell-7.1&viewFallbackFrom=powershell-6">Search</a> google or find in all cmdlets on the system by filtering as follows:</p> <ol> <li>Find all cmdlets and funtions by <code>Get-Command command</code></li> <li>Filter to get cmdlets which itself has one and keywords like call, request,... in the name by <code>Where-Object -Property Name -like *request*</code>. You will see Invoke-WebRequest command in results.</li> </ol> </div> </div> </div> </div> <div class="admonition question"> <p class=admonition-title><strong>Base64 decode the file b64.txt on Windows.</strong></p> <div class="tabbed-set tabbed-alternate" data-tabs=8:2><input checked=checked id=__tabbed_8_1 name=__tabbed_8 type=radio><input id=__tabbed_8_2 name=__tabbed_8 type=radio><div class=tabbed-labels><label for=__tabbed_8_1>Answer</label><label for=__tabbed_8_2>Explain</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=n>ihopeyoudidthisonwindows</span>
</code></pre></div> </div> <div class=tabbed-block> <p>To showup this question, use <code>Certutil command</code> with flag decode. Besides, Certutil command also has some useful flags:</p> <ul> <li>encode: encode according to base64</li> <li>decodehex: decode according to hexadecimal</li> </ul> <p>View more at <a href=https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/certutil>https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/certutil</a></p> <p>Full step: </p> <ol> <li>Certutil -decode b64.txt output.txt</li> <li>Get-Content output.txt</li> </ol> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=nb>PS </span><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>Administrator</span><span class=p>\</span><span class=n>Desktop</span><span class=p>&gt;</span> <span class=n>certutil</span> <span class=n>-decode</span> <span class=p>.\</span><span class=n>b64</span><span class=p>.</span><span class=n>txt</span> <span class=n>a</span><span class=p>.</span><span class=n>txt</span>        
<a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=n>Input</span> <span class=n>Length</span> <span class=p>=</span> <span class=n>432</span>                                                         
<a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=n>Output</span> <span class=n>Length</span> <span class=p>=</span> <span class=n>323</span>                                                        
<a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=n>CertUtil</span><span class=p>:</span> <span class=n>-decode</span> <span class=n>command</span> <span class=n>completed</span> <span class=n>successfully</span><span class=p>.</span>                          
<a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a><span class=nb>PS </span><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>Administrator</span><span class=p>\</span><span class=n>Desktop</span><span class=p>&gt;</span> <span class=nb>Get-Content</span> <span class=n>a</span><span class=p>.</span><span class=n>txt</span>                              
<a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a><span class=hll><span class=n>this</span> <span class=n>is</span> <span class=n>the</span> <span class=n>flag</span> <span class=p>-</span> <span class=n>ihopeyoudidthisonwindows</span>                                
</span><a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a><span class=n>the</span> <span class=n>rest</span> <span class=n>is</span> <span class=n>garbage</span>                                                        
<a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a><span class=n>the</span> <span class=n>rest</span> <span class=n>is</span> <span class=n>garbage</span>                                                        
<a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a><span class=n>the</span> <span class=n>rest</span> <span class=n>is</span> <span class=n>garbage</span>                                                        
<a id=__codelineno-18-10 name=__codelineno-18-10 href=#__codelineno-18-10></a><span class=n>the</span> <span class=n>rest</span> <span class=n>is</span> <span class=n>garbage</span>                                                        
<a id=__codelineno-18-11 name=__codelineno-18-11 href=#__codelineno-18-11></a><span class=n>the</span> <span class=n>rest</span> <span class=n>is</span> <span class=n>garbage</span>                                                        
<a id=__codelineno-18-12 name=__codelineno-18-12 href=#__codelineno-18-12></a><span class=n>the</span> <span class=n>rest</span> <span class=n>is</span> <span class=n>garbage</span>                                                        
<a id=__codelineno-18-13 name=__codelineno-18-13 href=#__codelineno-18-13></a><span class=n>the</span> <span class=n>rest</span> <span class=n>is</span> <span class=n>garbage</span>                                                        
<a id=__codelineno-18-14 name=__codelineno-18-14 href=#__codelineno-18-14></a><span class=n>the</span> <span class=n>rest</span> <span class=n>is</span> <span class=n>garbage</span>                                                        
<a id=__codelineno-18-15 name=__codelineno-18-15 href=#__codelineno-18-15></a><span class=n>the</span> <span class=n>rest</span> <span class=n>is</span> <span class=n>garbage</span>                                                        
<a id=__codelineno-18-16 name=__codelineno-18-16 href=#__codelineno-18-16></a><span class=n>the</span> <span class=n>rest</span> <span class=n>is</span> <span class=n>garbage</span>                                                        
<a id=__codelineno-18-17 name=__codelineno-18-17 href=#__codelineno-18-17></a><span class=n>the</span> <span class=n>rest</span> <span class=n>is</span> <span class=n>garbage</span>                                                        
<a id=__codelineno-18-18 name=__codelineno-18-18 href=#__codelineno-18-18></a><span class=n>the</span> <span class=n>rest</span> <span class=n>is</span> <span class=n>garbage</span>                                                        
<a id=__codelineno-18-19 name=__codelineno-18-19 href=#__codelineno-18-19></a><span class=n>the</span> <span class=n>rest</span> <span class=n>is</span> <span class=n>garbage</span>                                                        
<a id=__codelineno-18-20 name=__codelineno-18-20 href=#__codelineno-18-20></a><span class=n>the</span> <span class=n>rest</span> <span class=n>is</span> <span class=n>garbage</span>                                                                                                                                    
</code></pre></div> </div> </div> </div> </div> <h2 id=task-4-enumeration><strong>Task 4: Enumeration</strong><a class=headerlink href=#task-4-enumeration title="Permanent link">&para;</a></h2> <p><span> <span class="twemoji mdx-heart content-heart"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14 20.408c-.492.308-.903.546-1.192.709-.153.086-.308.17-.463.252h-.002a.75.75 0 0 1-.686 0 16.709 16.709 0 0 1-.465-.252 31.147 31.147 0 0 1-4.803-3.34C3.8 15.572 1 12.331 1 8.513 1 5.052 3.829 2.5 6.736 2.5 9.03 2.5 10.881 3.726 12 5.605 13.12 3.726 14.97 2.5 17.264 2.5 20.17 2.5 23 5.052 23 8.514c0 3.818-2.801 7.06-5.389 9.262A31.146 31.146 0 0 1 14 20.408z"></path></svg> </span> <span class=content-wu> Content </span> </span></p> <p>The first step when you have gained initial access to any machine would be to enumerate. We'll be enumerating the following:</p> <ul> <li>users</li> <li>basic networking information</li> <li>file permissions</li> <li>registry permissions</li> <li>scheduled and running tasks</li> <li>insecure files</li> </ul> <p>Your task will be to answer the following questions to enumerate the machine using Powershell commands! </p> <p><span> <span class="twemoji mdx-heart ans-wu"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14 20.408c-.492.308-.903.546-1.192.709-.153.086-.308.17-.463.252h-.002a.75.75 0 0 1-.686 0 16.709 16.709 0 0 1-.465-.252 31.147 31.147 0 0 1-4.803-3.34C3.8 15.572 1 12.331 1 8.513 1 5.052 3.829 2.5 6.736 2.5 9.03 2.5 10.881 3.726 12 5.605 13.12 3.726 14.97 2.5 17.264 2.5 20.17 2.5 23 5.052 23 8.514c0 3.818-2.801 7.06-5.389 9.262A31.146 31.146 0 0 1 14 20.408z"></path></svg> </span> <span class="content-wu ans-wu"> Answer the questions below </span> </span></p> <div class="admonition question"> <p class=admonition-title><strong>How many users are there on the machine?</strong></p> <div class="tabbed-set tabbed-alternate" data-tabs=9:2><input checked=checked id=__tabbed_9_1 name=__tabbed_9 type=radio><input id=__tabbed_9_2 name=__tabbed_9 type=radio><div class=tabbed-labels><label for=__tabbed_9_1>Answer</label><label for=__tabbed_9_2>Explain</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=n>5</span>
</code></pre></div> </div> <div class=tabbed-block> <p>Use Get-LocalUser command which I explained at <strong>What is the command to get the current working directory?</strong> question </p> </div> </div> </div> </div> <div class="admonition question"> <p class=admonition-title><strong>Which local user does this SID(S-1-5-21-1394777289-3961777894-1791813945-501) belong to?</strong></p> <div class="tabbed-set tabbed-alternate" data-tabs=10:2><input checked=checked id=__tabbed_10_1 name=__tabbed_10 type=radio><input id=__tabbed_10_2 name=__tabbed_10 type=radio><div class=tabbed-labels><label for=__tabbed_10_1>Answer</label><label for=__tabbed_10_2>Explain</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=n>Guest</span>
</code></pre></div> </div> <div class=tabbed-block> <p>Use <code>Get-LocalUser | Select *</code> command to showup full property. Then, filter output and get results.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=nb>PS </span><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>Administrator</span><span class=p>\</span><span class=n>Desktop</span><span class=p>&gt;</span> <span class=nb>get-localuser</span> <span class=p>|</span> <span class=nb>select </span><span class=p>*</span> <span class=p>|</span> <span class=nb>where-object</span> <span class=n>sid</span> <span class=o>-like</span> <span class=p>*</span><span class=n>501</span><span class=p>*</span>
<a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a><span class=n>AccountExpires</span>         <span class=p>:</span>                                                                         
<a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=n>Description</span>            <span class=p>:</span> <span class=n>Built-in</span> <span class=n>account</span> <span class=k>for</span> <span class=n>guest</span> <span class=n>access</span> <span class=n>to</span> <span class=n>the</span> <span class=n>computer</span><span class=p>/</span><span class=n>domain</span>                
<a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a><span class=n>Enabled</span>                <span class=p>:</span> <span class=n>False</span>                                                                   
<a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a><span class=n>FullName</span>               <span class=p>:</span>                                                                         
<a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a><span class=n>PasswordChangeableDate</span> <span class=p>:</span>                                                                         
<a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a><span class=n>PasswordExpires</span>        <span class=p>:</span>                                                                         
<a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a><span class=n>UserMayChangePassword</span>  <span class=p>:</span> <span class=n>False</span>                                                                   
<a id=__codelineno-21-9 name=__codelineno-21-9 href=#__codelineno-21-9></a><span class=n>PasswordRequired</span>       <span class=p>:</span> <span class=n>False</span>                                                                   
<a id=__codelineno-21-10 name=__codelineno-21-10 href=#__codelineno-21-10></a><span class=n>PasswordLastSet</span>        <span class=p>:</span>                                                                         
<a id=__codelineno-21-11 name=__codelineno-21-11 href=#__codelineno-21-11></a><span class=n>LastLogon</span>              <span class=p>:</span>                                                                        
<a id=__codelineno-21-12 name=__codelineno-21-12 href=#__codelineno-21-12></a><span class=n>Name</span>                   <span class=p>:</span> <span class=n>Guest</span>                                                                   
<a id=__codelineno-21-13 name=__codelineno-21-13 href=#__codelineno-21-13></a><span class=hll><span class=n>SID</span>                    <span class=p>:</span> <span class=n>S</span><span class=p>-</span><span class=n>1</span><span class=p>-</span><span class=n>5</span><span class=p>-</span><span class=n>21</span><span class=p>-</span><span class=n>1394777289</span><span class=p>-</span><span class=n>3961777894</span><span class=p>-</span><span class=n>1791813945</span><span class=p>-</span><span class=n>501</span>                          
</span><a id=__codelineno-21-14 name=__codelineno-21-14 href=#__codelineno-21-14></a><span class=n>PrincipalSource</span>        <span class=p>:</span> <span class=n>Local</span>                                                                   
<a id=__codelineno-21-15 name=__codelineno-21-15 href=#__codelineno-21-15></a><span class=n>ObjectClass</span>            <span class=p>:</span> <span class=n>User</span>                                                                    
</code></pre></div> </div> </div> </div> </div> <div class="admonition question"> <p class=admonition-title><strong>How many users have their password required values set to False?</strong></p> <div class="tabbed-set tabbed-alternate" data-tabs=11:2><input checked=checked id=__tabbed_11_1 name=__tabbed_11 type=radio><input id=__tabbed_11_2 name=__tabbed_11 type=radio><div class=tabbed-labels><label for=__tabbed_11_1>Answer</label><label for=__tabbed_11_2>Explain</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=n>4</span>
</code></pre></div> </div> <div class=tabbed-block> <p>Filter, filter, filter,...</p> <div class=highlight><pre><span></span><code><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=nb>PS </span><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>Administrator</span><span class=p>\</span><span class=n>Desktop</span><span class=p>&gt;</span> <span class=nb>get-localuser</span> <span class=p>|</span> <span class=nb>select </span><span class=p>*</span> <span class=p>|</span> <span class=nb>where-object</span> <span class=n>passwordrequired</span> <span class=o>-match</span> <span class=n>false</span> <span class=p>|</span> <span class=nb>measure </span>       
<a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a>
<a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a><span class=n>Count</span>    <span class=p>:</span> <span class=n>4</span>                                                                                                    
<a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a><span class=n>Average</span>  <span class=p>:</span>                                                                                                      
<a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a><span class=n>Sum</span>      <span class=p>:</span>                                                                                                      
<a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a><span class=n>Maximum</span>  <span class=p>:</span>                                                                                                      
<a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a><span class=n>Minimum</span>  <span class=p>:</span>                                                                                                      
<a id=__codelineno-23-8 name=__codelineno-23-8 href=#__codelineno-23-8></a><span class=n>Property</span> <span class=p>:</span>
</code></pre></div> </div> </div> </div> </div> <div class="admonition question"> <p class=admonition-title><strong>How many local groups exist?</strong></p> <div class="tabbed-set tabbed-alternate" data-tabs=12:2><input checked=checked id=__tabbed_12_1 name=__tabbed_12 type=radio><input id=__tabbed_12_2 name=__tabbed_12 type=radio><div class=tabbed-labels><label for=__tabbed_12_1>Answer</label><label for=__tabbed_12_2>Explain</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=n>24</span>
</code></pre></div> </div> <div class=tabbed-block> <p>Use <code>get-command | where name -like *group* | where name -like *local*</code> to file cmdlet, and filter then.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=nb>PS </span><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>Administrator</span><span class=p>\</span><span class=n>Desktop</span><span class=p>&gt;</span> <span class=nb>get-command</span> <span class=p>|</span> <span class=nb>where-object</span> <span class=n>name</span> <span class=o>-like</span> <span class=p>*</span><span class=n>group</span><span class=p>*</span> <span class=p>|</span> <span class=nb>where-object</span> <span class=n>name</span> <span class=o>-like</span> <span class=p>*</span><span class=n>local</span><span class=p>*</span>                                          
<a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a>
<a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a><span class=n>CommandType</span>     <span class=n>Name</span>                                               <span class=n>Version</span>    <span class=n>Source</span>                                    
<a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a><span class=p>-----------</span>     <span class=p>----</span>                                               <span class=p>-------</span>    <span class=p>------</span>                                    
<a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a><span class=n>Cmdlet</span>          <span class=nb>Add-LocalGroupMember</span>                               <span class=n>1</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span>    <span class=n>Microsoft</span><span class=p>.</span><span class=n>PowerShell</span><span class=p>.</span><span class=n>LocalAccounts</span>        
<a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a><span class=n>Cmdlet</span>          <span class=nb>Get-LocalGroup</span>                                     <span class=n>1</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span>    <span class=n>Microsoft</span><span class=p>.</span><span class=n>PowerShell</span><span class=p>.</span><span class=n>LocalAccounts</span>        
<a id=__codelineno-25-7 name=__codelineno-25-7 href=#__codelineno-25-7></a><span class=n>Cmdlet</span>          <span class=nb>Get-LocalGroupMember</span>                               <span class=n>1</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span>    <span class=n>Microsoft</span><span class=p>.</span><span class=n>PowerShell</span><span class=p>.</span><span class=n>LocalAccounts</span>        
<a id=__codelineno-25-8 name=__codelineno-25-8 href=#__codelineno-25-8></a><span class=n>Cmdlet</span>          <span class=nb>New-LocalGroup</span>                                     <span class=n>1</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span>    <span class=n>Microsoft</span><span class=p>.</span><span class=n>PowerShell</span><span class=p>.</span><span class=n>LocalAccounts</span>        
<a id=__codelineno-25-9 name=__codelineno-25-9 href=#__codelineno-25-9></a><span class=n>Cmdlet</span>          <span class=nb>Remove-LocalGroup</span>                                  <span class=n>1</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span>    <span class=n>Microsoft</span><span class=p>.</span><span class=n>PowerShell</span><span class=p>.</span><span class=n>LocalAccounts</span>        
<a id=__codelineno-25-10 name=__codelineno-25-10 href=#__codelineno-25-10></a><span class=n>Cmdlet</span>          <span class=nb>Remove-LocalGroupMember</span>                            <span class=n>1</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span>    <span class=n>Microsoft</span><span class=p>.</span><span class=n>PowerShell</span><span class=p>.</span><span class=n>LocalAccounts</span>        
<a id=__codelineno-25-11 name=__codelineno-25-11 href=#__codelineno-25-11></a><span class=n>Cmdlet</span>          <span class=nb>Rename-LocalGroup</span>                                  <span class=n>1</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span>    <span class=n>Microsoft</span><span class=p>.</span><span class=n>PowerShell</span><span class=p>.</span><span class=n>LocalAccounts</span>        
<a id=__codelineno-25-12 name=__codelineno-25-12 href=#__codelineno-25-12></a><span class=n>Cmdlet</span>          <span class=nb>Set-LocalGroup</span>                                     <span class=n>1</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span>    <span class=n>Microsoft</span><span class=p>.</span><span class=n>PowerShell</span><span class=p>.</span><span class=n>LocalAccounts</span> 
<a id=__codelineno-25-13 name=__codelineno-25-13 href=#__codelineno-25-13></a>
<a id=__codelineno-25-14 name=__codelineno-25-14 href=#__codelineno-25-14></a><span class=nb>PS </span><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>Administrator</span><span class=p>\</span><span class=n>Desktop</span><span class=p>&gt;</span> <span class=nb>get-command</span> <span class=p>|</span> <span class=nb>where </span><span class=n>name</span> <span class=o>-like</span> <span class=p>*</span><span class=n>group</span><span class=p>*</span> <span class=p>|</span> <span class=nb>where </span><span class=n>name</span> <span class=o>-like</span> <span class=p>*</span><span class=n>local</span><span class=p>*</span>        
<a id=__codelineno-25-15 name=__codelineno-25-15 href=#__codelineno-25-15></a>
<a id=__codelineno-25-16 name=__codelineno-25-16 href=#__codelineno-25-16></a><span class=n>CommandType</span>     <span class=n>Name</span>                                               <span class=n>Version</span>    <span class=n>Source</span>                                    
<a id=__codelineno-25-17 name=__codelineno-25-17 href=#__codelineno-25-17></a><span class=p>-----------</span>     <span class=p>----</span>                                               <span class=p>-------</span>    <span class=p>------</span>                                    
<a id=__codelineno-25-18 name=__codelineno-25-18 href=#__codelineno-25-18></a><span class=n>Cmdlet</span>          <span class=nb>Add-LocalGroupMember</span>                               <span class=n>1</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span>    <span class=n>Microsoft</span><span class=p>.</span><span class=n>PowerShell</span><span class=p>.</span><span class=n>LocalAccounts</span>        
<a id=__codelineno-25-19 name=__codelineno-25-19 href=#__codelineno-25-19></a><span class=n>Cmdlet</span>          <span class=nb>Get-LocalGroup</span>                                     <span class=n>1</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span>    <span class=n>Microsoft</span><span class=p>.</span><span class=n>PowerShell</span><span class=p>.</span><span class=n>LocalAccounts</span>        
<a id=__codelineno-25-20 name=__codelineno-25-20 href=#__codelineno-25-20></a><span class=n>Cmdlet</span>          <span class=nb>Get-LocalGroupMember</span>                               <span class=n>1</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span>    <span class=n>Microsoft</span><span class=p>.</span><span class=n>PowerShell</span><span class=p>.</span><span class=n>LocalAccounts</span>        
<a id=__codelineno-25-21 name=__codelineno-25-21 href=#__codelineno-25-21></a><span class=n>Cmdlet</span>          <span class=nb>New-LocalGroup</span>                                     <span class=n>1</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span>    <span class=n>Microsoft</span><span class=p>.</span><span class=n>PowerShell</span><span class=p>.</span><span class=n>LocalAccounts</span>        
<a id=__codelineno-25-22 name=__codelineno-25-22 href=#__codelineno-25-22></a><span class=n>Cmdlet</span>          <span class=nb>Remove-LocalGroup</span>                                  <span class=n>1</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span>    <span class=n>Microsoft</span><span class=p>.</span><span class=n>PowerShell</span><span class=p>.</span><span class=n>LocalAccounts</span>        
<a id=__codelineno-25-23 name=__codelineno-25-23 href=#__codelineno-25-23></a><span class=n>Cmdlet</span>          <span class=nb>Remove-LocalGroupMember</span>                            <span class=n>1</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span>    <span class=n>Microsoft</span><span class=p>.</span><span class=n>PowerShell</span><span class=p>.</span><span class=n>LocalAccounts</span>        
<a id=__codelineno-25-24 name=__codelineno-25-24 href=#__codelineno-25-24></a><span class=n>Cmdlet</span>          <span class=nb>Rename-LocalGroup</span>                                  <span class=n>1</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span>    <span class=n>Microsoft</span><span class=p>.</span><span class=n>PowerShell</span><span class=p>.</span><span class=n>LocalAccounts</span>        
<a id=__codelineno-25-25 name=__codelineno-25-25 href=#__codelineno-25-25></a><span class=n>Cmdlet</span>          <span class=nb>Set-LocalGroup</span>                                     <span class=n>1</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span>    <span class=n>Microsoft</span><span class=p>.</span><span class=n>PowerShell</span><span class=p>.</span><span class=n>LocalAccounts</span>  
<a id=__codelineno-25-26 name=__codelineno-25-26 href=#__codelineno-25-26></a>
<a id=__codelineno-25-27 name=__codelineno-25-27 href=#__codelineno-25-27></a>
<a id=__codelineno-25-28 name=__codelineno-25-28 href=#__codelineno-25-28></a><span class=nb>PS </span><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>Administrator</span><span class=p>\</span><span class=n>Desktop</span><span class=p>&gt;</span> <span class=nb>get-localgroup</span>                      
<a id=__codelineno-25-29 name=__codelineno-25-29 href=#__codelineno-25-29></a>
<a id=__codelineno-25-30 name=__codelineno-25-30 href=#__codelineno-25-30></a><span class=n>Name</span>                                <span class=n>Description</span>                                                                         
<a id=__codelineno-25-31 name=__codelineno-25-31 href=#__codelineno-25-31></a><span class=p>----</span>                                <span class=p>-----------</span>                                                                         
<a id=__codelineno-25-32 name=__codelineno-25-32 href=#__codelineno-25-32></a><span class=n>Access</span> <span class=n>Control</span> <span class=n>Assistance</span> <span class=n>Operators</span> <span class=n>Members</span> <span class=n>of</span> <span class=n>this</span> <span class=nb>group </span><span class=n>can</span> <span class=n>remotely</span> <span class=n>query</span> <span class=n>authorization</span> <span class=n>attributes</span> <span class=n>and</span> <span class=n>permission</span><span class=p>...</span> 
<a id=__codelineno-25-33 name=__codelineno-25-33 href=#__codelineno-25-33></a><span class=n>Administrators</span>                      <span class=n>Administrators</span> <span class=n>have</span> <span class=n>complete</span> <span class=n>and</span> <span class=n>unrestricted</span> <span class=n>access</span> <span class=n>to</span> <span class=n>the</span> <span class=n>computer</span><span class=p>/</span><span class=n>domain</span>         
<a id=__codelineno-25-34 name=__codelineno-25-34 href=#__codelineno-25-34></a><span class=n>Backup</span> <span class=n>Operators</span>                    <span class=n>Backup</span> <span class=n>Operators</span> <span class=n>can</span> <span class=n>override</span> <span class=n>security</span> <span class=n>restrictions</span> <span class=k>for</span> <span class=n>the</span> <span class=n>sole</span> <span class=n>purpose</span> <span class=n>of</span> <span class=n>back</span><span class=p>...</span> 
<a id=__codelineno-25-35 name=__codelineno-25-35 href=#__codelineno-25-35></a><span class=n>Certificate</span> <span class=n>Service</span> <span class=n>DCOM</span> <span class=n>Access</span>     <span class=n>Members</span> <span class=n>of</span> <span class=n>this</span> <span class=nb>group </span><span class=n>are</span> <span class=n>allowed</span> <span class=n>to</span> <span class=n>connect</span> <span class=n>to</span> <span class=n>Certification</span> <span class=n>Authorities</span> <span class=k>in</span> <span class=n>the</span><span class=p>...</span> 
<a id=__codelineno-25-36 name=__codelineno-25-36 href=#__codelineno-25-36></a><span class=n>Cryptographic</span> <span class=n>Operators</span>             <span class=n>Members</span> <span class=n>are</span> <span class=n>authorized</span> <span class=n>to</span> <span class=n>perform</span> <span class=n>cryptographic</span> <span class=n>operations</span><span class=p>.</span>                         
<a id=__codelineno-25-37 name=__codelineno-25-37 href=#__codelineno-25-37></a><span class=n>Distributed</span> <span class=n>COM</span> <span class=n>Users</span>               <span class=n>Members</span> <span class=n>are</span> <span class=n>allowed</span> <span class=n>to</span> <span class=n>launch</span><span class=p>,</span> <span class=n>activate</span> <span class=n>and</span> <span class=n>use</span> <span class=n>Distributed</span> <span class=n>COM</span> <span class=n>objects</span> <span class=n>on</span> <span class=n>this</span> <span class=p>...</span> 
<a id=__codelineno-25-38 name=__codelineno-25-38 href=#__codelineno-25-38></a><span class=n>Event</span> <span class=n>Log</span> <span class=n>Readers</span>                   <span class=n>Members</span> <span class=n>of</span> <span class=n>this</span> <span class=nb>group </span><span class=n>can</span> <span class=n>read</span> <span class=n>event</span> <span class=n>logs</span> <span class=n>from</span> <span class=n>local</span> <span class=n>machine</span>                        
<a id=__codelineno-25-39 name=__codelineno-25-39 href=#__codelineno-25-39></a><span class=n>Guests</span>                              <span class=n>Guests</span> <span class=n>have</span> <span class=n>the</span> <span class=n>same</span> <span class=n>access</span> <span class=n>as</span> <span class=n>members</span> <span class=n>of</span> <span class=n>the</span> <span class=n>Users</span> <span class=nb>group </span><span class=n>by</span> <span class=k>default</span><span class=p>,</span> <span class=n>except</span> <span class=k>for</span><span class=p>...</span> 
<a id=__codelineno-25-40 name=__codelineno-25-40 href=#__codelineno-25-40></a><span class=n>Hyper-V</span> <span class=n>Administrators</span>              <span class=n>Members</span> <span class=n>of</span> <span class=n>this</span> <span class=nb>group </span><span class=n>have</span> <span class=n>complete</span> <span class=n>and</span> <span class=n>unrestricted</span> <span class=n>access</span> <span class=n>to</span> <span class=n>all</span> <span class=n>features</span> <span class=n>of</span> <span class=n>H</span><span class=p>...</span> 
<a id=__codelineno-25-41 name=__codelineno-25-41 href=#__codelineno-25-41></a><span class=n>IIS_IUSRS</span>                           <span class=n>Built-in</span> <span class=nb>group </span><span class=n>used</span> <span class=n>by</span> <span class=n>Internet</span> <span class=n>Information</span> <span class=n>Services</span><span class=p>.</span>                               
<a id=__codelineno-25-42 name=__codelineno-25-42 href=#__codelineno-25-42></a><span class=n>Network</span> <span class=n>Configuration</span> <span class=n>Operators</span>     <span class=n>Members</span> <span class=k>in</span> <span class=n>this</span> <span class=nb>group </span><span class=n>can</span> <span class=n>have</span> <span class=n>some</span> <span class=n>administrative</span> <span class=n>privileges</span> <span class=n>to</span> <span class=n>manage</span> <span class=n>configur</span><span class=p>...</span> 
<a id=__codelineno-25-43 name=__codelineno-25-43 href=#__codelineno-25-43></a><span class=n>Performance</span> <span class=n>Log</span> <span class=n>Users</span>               <span class=n>Members</span> <span class=n>of</span> <span class=n>this</span> <span class=nb>group </span><span class=n>may</span> <span class=n>schedule</span> <span class=n>logging</span> <span class=n>of</span> <span class=n>performance</span> <span class=n>counters</span><span class=p>,</span> <span class=n>enable</span> <span class=n>trace</span><span class=p>...</span> 
<a id=__codelineno-25-44 name=__codelineno-25-44 href=#__codelineno-25-44></a><span class=n>Performance</span> <span class=n>Monitor</span> <span class=n>Users</span>           <span class=n>Members</span> <span class=n>of</span> <span class=n>this</span> <span class=nb>group </span><span class=n>can</span> <span class=n>access</span> <span class=n>performance</span> <span class=n>counter</span> <span class=n>data</span> <span class=n>locally</span> <span class=n>and</span> <span class=n>remotely</span>      
<a id=__codelineno-25-45 name=__codelineno-25-45 href=#__codelineno-25-45></a><span class=n>Power</span> <span class=n>Users</span>                         <span class=n>Power</span> <span class=n>Users</span> <span class=n>are</span> <span class=n>included</span> <span class=k>for</span> <span class=n>backwards</span> <span class=n>compatibility</span> <span class=n>and</span> <span class=n>possess</span> <span class=n>limited</span> <span class=n>adminis</span><span class=p>...</span> 
<a id=__codelineno-25-46 name=__codelineno-25-46 href=#__codelineno-25-46></a><span class=n>Print</span> <span class=n>Operators</span>                     <span class=n>Members</span> <span class=n>can</span> <span class=n>administer</span> <span class=n>printers</span> <span class=n>installed</span> <span class=n>on</span> <span class=n>domain</span> <span class=n>controllers</span>                     
<a id=__codelineno-25-47 name=__codelineno-25-47 href=#__codelineno-25-47></a><span class=n>RDS</span> <span class=n>Endpoint</span> <span class=n>Servers</span>                <span class=n>Servers</span> <span class=k>in</span> <span class=n>this</span> <span class=nb>group </span><span class=n>run</span> <span class=n>virtual</span> <span class=n>machines</span> <span class=n>and</span> <span class=n>host</span> <span class=n>sessions</span> <span class=nb>where </span><span class=n>users</span> <span class=n>RemoteA</span><span class=p>...</span> 
<a id=__codelineno-25-48 name=__codelineno-25-48 href=#__codelineno-25-48></a><span class=n>RDS</span> <span class=n>Management</span> <span class=n>Servers</span>              <span class=n>Servers</span> <span class=k>in</span> <span class=n>this</span> <span class=nb>group </span><span class=n>can</span> <span class=n>perform</span> <span class=n>routine</span> <span class=n>administrative</span> <span class=n>actions</span> <span class=n>on</span> <span class=n>servers</span> <span class=n>runn</span><span class=p>...</span> 
<a id=__codelineno-25-49 name=__codelineno-25-49 href=#__codelineno-25-49></a><span class=n>RDS</span> <span class=n>Remote</span> <span class=n>Access</span> <span class=n>Servers</span>           <span class=n>Servers</span> <span class=k>in</span> <span class=n>this</span> <span class=nb>group </span><span class=n>enable</span> <span class=n>users</span> <span class=n>of</span> <span class=n>RemoteApp</span> <span class=n>programs</span> <span class=n>and</span> <span class=n>personal</span> <span class=n>virtual</span> <span class=n>de</span><span class=p>...</span> 
<a id=__codelineno-25-50 name=__codelineno-25-50 href=#__codelineno-25-50></a><span class=n>Remote</span> <span class=n>Desktop</span> <span class=n>Users</span>                <span class=n>Members</span> <span class=k>in</span> <span class=n>this</span> <span class=nb>group </span><span class=n>are</span> <span class=n>granted</span> <span class=n>the</span> <span class=n>right</span> <span class=n>to</span> <span class=n>logon</span> <span class=n>remotely</span>                       
<a id=__codelineno-25-51 name=__codelineno-25-51 href=#__codelineno-25-51></a><span class=n>Remote</span> <span class=n>Management</span> <span class=n>Users</span>             <span class=n>Members</span> <span class=n>of</span> <span class=n>this</span> <span class=nb>group </span><span class=n>can</span> <span class=n>access</span> <span class=n>WMI</span> <span class=n>resources</span> <span class=n>over</span> <span class=n>management</span> <span class=n>protocols</span> <span class=p>(</span><span class=n>such</span> <span class=n>a</span><span class=p>...</span> 
<a id=__codelineno-25-52 name=__codelineno-25-52 href=#__codelineno-25-52></a><span class=n>Replicator</span>                          <span class=n>Supports</span> <span class=n>file</span> <span class=n>replication</span> <span class=k>in</span> <span class=n>a</span> <span class=n>domain</span>                                               
<a id=__codelineno-25-53 name=__codelineno-25-53 href=#__codelineno-25-53></a><span class=n>Storage</span> <span class=n>Replica</span> <span class=n>Administrators</span>      <span class=n>Members</span> <span class=n>of</span> <span class=n>this</span> <span class=nb>group </span><span class=n>have</span> <span class=n>complete</span> <span class=n>and</span> <span class=n>unrestricted</span> <span class=n>access</span> <span class=n>to</span> <span class=n>all</span> <span class=n>features</span> <span class=n>of</span> <span class=n>S</span><span class=p>...</span> 
<a id=__codelineno-25-54 name=__codelineno-25-54 href=#__codelineno-25-54></a><span class=n>System</span> <span class=n>Managed</span> <span class=n>Accounts</span> <span class=nb>Group </span>      <span class=n>Members</span> <span class=n>of</span> <span class=n>this</span> <span class=nb>group </span><span class=n>are</span> <span class=n>managed</span> <span class=n>by</span> <span class=n>the</span> <span class=n>system</span><span class=p>.</span>                                    
<a id=__codelineno-25-55 name=__codelineno-25-55 href=#__codelineno-25-55></a><span class=n>Users</span>                               <span class=n>Users</span> <span class=n>are</span> <span class=n>prevented</span> <span class=n>from</span> <span class=n>making</span> <span class=n>accidental</span> <span class=n>or</span> <span class=n>intentional</span> <span class=n>system-wide</span> <span class=n>changes</span> <span class=n>an</span><span class=p>...</span>      
<a id=__codelineno-25-56 name=__codelineno-25-56 href=#__codelineno-25-56></a>
<a id=__codelineno-25-57 name=__codelineno-25-57 href=#__codelineno-25-57></a><span class=nb>PS </span><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>Administrator</span><span class=p>\</span><span class=n>Desktop</span><span class=p>&gt;</span> <span class=nb>get-localgroup</span> <span class=p>|</span> <span class=nb>measure</span>
<a id=__codelineno-25-58 name=__codelineno-25-58 href=#__codelineno-25-58></a><span class=hll><span class=n>Count</span>    <span class=p>:</span> <span class=n>24</span>                                                                                                           
</span><a id=__codelineno-25-59 name=__codelineno-25-59 href=#__codelineno-25-59></a><span class=n>Average</span>  <span class=p>:</span>                                                                                                              
<a id=__codelineno-25-60 name=__codelineno-25-60 href=#__codelineno-25-60></a><span class=n>Sum</span>      <span class=p>:</span>                                                                                                              
<a id=__codelineno-25-61 name=__codelineno-25-61 href=#__codelineno-25-61></a><span class=n>Maximum</span>  <span class=p>:</span>                                                                                                              
<a id=__codelineno-25-62 name=__codelineno-25-62 href=#__codelineno-25-62></a><span class=n>Minimum</span>  <span class=p>:</span>                                                                                                              
<a id=__codelineno-25-63 name=__codelineno-25-63 href=#__codelineno-25-63></a><span class=n>Property</span> <span class=p>:</span>         
</code></pre></div> </div> </div> </div> </div> <div class="admonition question"> <p class=admonition-title><strong>What command did you use to get the IP address info?</strong></p> <div class="tabbed-set tabbed-alternate" data-tabs=13:2><input checked=checked id=__tabbed_13_1 name=__tabbed_13 type=radio><input id=__tabbed_13_2 name=__tabbed_13 type=radio><div class=tabbed-labels><label for=__tabbed_13_1>Answer</label><label for=__tabbed_13_2>Explain</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=nb>Get-NetIPAddress</span>
</code></pre></div> </div> <div class=tabbed-block> <p>Use <code>Get-Command | Where-Object -property name -like "*ip*" | where-object -property Name -like "*address*"</code> to find cmdlets.</p> </div> </div> </div> </div> <div class="admonition question"> <p class=admonition-title><strong>How many ports are listed as listening?</strong></p> <div class="tabbed-set tabbed-alternate" data-tabs=14:2><input checked=checked id=__tabbed_14_1 name=__tabbed_14 type=radio><input id=__tabbed_14_2 name=__tabbed_14 type=radio><div class=tabbed-labels><label for=__tabbed_14_1>Answer</label><label for=__tabbed_14_2>Explain</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=n>20</span>
</code></pre></div> </div> <div class=tabbed-block> <p>Use this command: <code>get-nettcpconnection | where state -match listen | measure</code> </p> </div> </div> </div> </div> <div class="admonition question"> <p class=admonition-title><strong>What is the remote address of the local port listening on port 445?</strong></p> <div class="tabbed-set tabbed-alternate" data-tabs=15:2><input checked=checked id=__tabbed_15_1 name=__tabbed_15 type=radio><input id=__tabbed_15_2 name=__tabbed_15 type=radio><div class=tabbed-labels><label for=__tabbed_15_1>Answer</label><label for=__tabbed_15_2>Explain</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=p>::</span>
</code></pre></div> </div> <div class=tabbed-block> <p>Use this command: <code>get-nettcpconnection | where localport -match 445</code></p> </div> </div> </div> </div> <div class="admonition question"> <p class=admonition-title><strong>How many patches have been applied?</strong></p> <div class="tabbed-set tabbed-alternate" data-tabs=16:2><input checked=checked id=__tabbed_16_1 name=__tabbed_16 type=radio><input id=__tabbed_16_2 name=__tabbed_16 type=radio><div class=tabbed-labels><label for=__tabbed_16_1>Answer</label><label for=__tabbed_16_2>Explain</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=n>20</span>
</code></pre></div> </div> <div class=tabbed-block> <p>Use this command: <code>get-hostfix</code> </p> </div> </div> </div> </div> <div class="admonition question"> <p class=admonition-title><strong>When was the patch with ID KB4023834 installed?</strong></p> <div class="tabbed-set tabbed-alternate" data-tabs=17:2><input checked=checked id=__tabbed_17_1 name=__tabbed_17 type=radio><input id=__tabbed_17_2 name=__tabbed_17 type=radio><div class=tabbed-labels><label for=__tabbed_17_1>Answer</label><label for=__tabbed_17_2>Explain</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=n>6</span><span class=p>/</span><span class=n>15</span><span class=p>/</span><span class=n>2017</span> <span class=n>12</span><span class=p>:</span><span class=n>00</span><span class=p>:</span><span class=n>00</span> <span class=n>AM</span>
</code></pre></div> </div> <div class=tabbed-block> <p>Use this command: <code>get-hostfix | where hostfixID -match KB4023834</code> </p> </div> </div> </div> </div> <div class="admonition question"> <p class=admonition-title><strong>Find the contents of a backup file.</strong></p> <div class="tabbed-set tabbed-alternate" data-tabs=18:2><input checked=checked id=__tabbed_18_1 name=__tabbed_18 type=radio><input id=__tabbed_18_2 name=__tabbed_18 type=radio><div class=tabbed-labels><label for=__tabbed_18_1>Answer</label><label for=__tabbed_18_2>Explain</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=n>backpassflag</span>
</code></pre></div> </div> <div class=tabbed-block> <p>First, you must find backup (in window, it has the extension <strong>.bak</strong>). Find it by <div class=highlight><pre><span></span><code><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a>get-childitem -path C:\ -include *.bak* -file  -recurse -erroraction silentlycontinue
</code></pre></div></p> <p>Second, read it <div class=highlight><pre><span></span><code><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=nb>PS </span><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>Administrator</span><span class=p>&gt;</span> <span class=n>more</span> <span class=s1>&#39;C:\Program Files (x86)\Internet Explorer\passwords.bak.txt&#39;</span> 
<a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a><span class=n>backpassflag</span>                                                                                                                                                                            
</code></pre></div></p> </div> </div> </div> </div> <div class="admonition question"> <p class=admonition-title><strong>Search for all files containing API_KEY</strong></p> <div class="tabbed-set tabbed-alternate" data-tabs=19:2><input checked=checked id=__tabbed_19_1 name=__tabbed_19 type=radio><input id=__tabbed_19_2 name=__tabbed_19 type=radio><div class=tabbed-labels><label for=__tabbed_19_1>Answer</label><label for=__tabbed_19_2>Explain</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=n>fakekey123</span>
</code></pre></div> </div> <div class=tabbed-block> <p>Use this command to solve: <div class=highlight><pre><span></span><code><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a><span class=nb>get-childitem</span> <span class=n>-path</span> <span class=n>c</span><span class=p>:\*</span> <span class=n>-recurse</span> <span class=n>-erroraction</span> <span class=n>silentlycontinue</span> <span class=p>|</span> <span class=nb>select-string</span> <span class=n>-pattern</span> <span class=n>API_KEY</span>
</code></pre></div></p> </div> </div> </div> </div> <div class="admonition question"> <p class=admonition-title><strong>What command do you do to list all the running processes?</strong></p> <div class="tabbed-set tabbed-alternate" data-tabs=20:2><input checked=checked id=__tabbed_20_1 name=__tabbed_20 type=radio><input id=__tabbed_20_2 name=__tabbed_20 type=radio><div class=tabbed-labels><label for=__tabbed_20_1>Answer</label><label for=__tabbed_20_2>Explain</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a><span class=nb>Get-Process</span>
</code></pre></div> </div> <div class=tabbed-block> <p>Find cmdlet by using get-command command and filter</p> </div> </div> </div> </div> <div class="admonition question"> <p class=admonition-title><strong>What is the path of the scheduled task called new-sched-task?</strong></p> <div class="tabbed-set tabbed-alternate" data-tabs=21:2><input checked=checked id=__tabbed_21_1 name=__tabbed_21 type=radio><input id=__tabbed_21_2 name=__tabbed_21 type=radio><div class=tabbed-labels><label for=__tabbed_21_1>Answer</label><label for=__tabbed_21_2>Explain</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a><span class=p>/</span>
</code></pre></div> </div> <div class=tabbed-block> <p>Find command that it provides schedule task: <code>get-command | where name -like *schedule*</code>. You will see <code>get-scheduledtask</code>, this is the command to look for. Then, filter output and get result. <div class=highlight><pre><span></span><code><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a><span class=nb>PS </span><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>Administrator</span><span class=p>&gt;</span> <span class=nb>get-scheduledtask</span> <span class=p>|</span> <span class=nb>where </span><span class=n>taskname</span> <span class=o>-like</span> <span class=p>*</span><span class=n>new</span><span class=p>*</span>                                                                                                                   
<a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a><span class=n>TaskPath</span>                                       <span class=n>TaskName</span>                          <span class=n>State</span>        
<a id=__codelineno-38-3 name=__codelineno-38-3 href=#__codelineno-38-3></a><span class=p>--------</span>                                       <span class=p>--------</span>                          <span class=p>-----</span>        
<a id=__codelineno-38-4 name=__codelineno-38-4 href=#__codelineno-38-4></a><span class=p>\</span>                                              <span class=nb>new-sched</span><span class=n>-task</span>                    <span class=n>Ready</span>        
</code></pre></div></p> </div> </div> </div> </div> <div class="admonition question"> <p class=admonition-title><strong>Who is the owner of the C:\?</strong></p> <div class="tabbed-set tabbed-alternate" data-tabs=22:2><input checked=checked id=__tabbed_22_1 name=__tabbed_22 type=radio><input id=__tabbed_22_2 name=__tabbed_22 type=radio><div class=tabbed-labels><label for=__tabbed_22_1>Answer</label><label for=__tabbed_22_2>Explain</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a><span class=n>NT</span> <span class=n>SERVICE</span><span class=p>\</span><span class=n>TrustedInstaller</span>
</code></pre></div> </div> <div class=tabbed-block> <p>To get owner of X (path_of_folder/path_of_file), use <code>Get-Acl command</code>.</p> <p>Full syntax to solve:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a><span class=nb>PS </span><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>Administrator</span><span class=p>\</span><span class=n>Desktop</span><span class=p>&gt;</span> <span class=nb>get-acl</span> <span class=n>C</span><span class=p>:\</span>          
<a id=__codelineno-40-2 name=__codelineno-40-2 href=#__codelineno-40-2></a>
<a id=__codelineno-40-3 name=__codelineno-40-3 href=#__codelineno-40-3></a>        <span class=n>Directory</span><span class=p>:</span>                                                                                                                                                                                           
<a id=__codelineno-40-4 name=__codelineno-40-4 href=#__codelineno-40-4></a><span class=n>Path</span>        <span class=n>Owner</span>                               <span class=n>Access</span>        
<a id=__codelineno-40-5 name=__codelineno-40-5 href=#__codelineno-40-5></a>
<a id=__codelineno-40-6 name=__codelineno-40-6 href=#__codelineno-40-6></a><span class=p>----</span>        <span class=p>-----</span>                               <span class=p>------</span>                           
<a id=__codelineno-40-7 name=__codelineno-40-7 href=#__codelineno-40-7></a><span class=n>C</span><span class=p>:\</span>         <span class=n>NT</span> <span class=n>SERVICE</span><span class=p>\</span><span class=n>TrustedInstaller</span>         <span class=n>CREATOR</span> <span class=n>OWNER</span> <span class=n>Allow</span>  <span class=n>268435456</span><span class=p>...</span> 
</code></pre></div> </div> </div> </div> </div> <h2 id=task-5-basic-scripting-challenge><strong>Task 5: Basic Scripting Challenge</strong><a class=headerlink href=#task-5-basic-scripting-challenge title="Permanent link">&para;</a></h2> <p>Now that we have run Powershell commands, let's try to write and run a script to do more complex and powerful actions. </p> <p>For this ask, we'll use Powershell ISE (the Powershell Text Editor). Let's use a particular scenario to show an example of this script. Given a list of port numbers, we want to use this list to see if the local port is listening. Open the listening-ports.ps1 script on the Desktop using Powershell ISE. Powershell scripts usually have the <strong><em>.ps1</em></strong> file extension. </p> <div class=highlight><pre><span></span><code><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a><span class=nv>$system_ports</span> <span class=p>=</span> <span class=nb>Get-NetTCPConnection</span> <span class=n>-State</span> <span class=n>Listen</span>
<a id=__codelineno-41-2 name=__codelineno-41-2 href=#__codelineno-41-2></a>
<a id=__codelineno-41-3 name=__codelineno-41-3 href=#__codelineno-41-3></a><span class=nv>$text_port</span> <span class=p>=</span> <span class=nb>Get-Content</span> <span class=n>-Path</span> <span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>Administrator</span><span class=p>\</span><span class=n>Desktop</span><span class=p>\</span><span class=n>ports</span><span class=p>.</span><span class=n>txt</span>
<a id=__codelineno-41-4 name=__codelineno-41-4 href=#__codelineno-41-4></a>
<a id=__codelineno-41-5 name=__codelineno-41-5 href=#__codelineno-41-5></a><span class=k>foreach</span><span class=p>(</span><span class=nv>$port</span> <span class=k>in</span> <span class=nv>$text_port</span><span class=p>){</span>
<a id=__codelineno-41-6 name=__codelineno-41-6 href=#__codelineno-41-6></a>
<a id=__codelineno-41-7 name=__codelineno-41-7 href=#__codelineno-41-7></a>    <span class=k>if</span><span class=p>(</span><span class=nv>$port</span> <span class=n>-in</span> <span class=nv>$system_ports</span><span class=p>.</span><span class=n>LocalPort</span><span class=p>){</span>
<a id=__codelineno-41-8 name=__codelineno-41-8 href=#__codelineno-41-8></a>        <span class=nb>echo </span><span class=nv>$port</span>
<a id=__codelineno-41-9 name=__codelineno-41-9 href=#__codelineno-41-9></a>     <span class=p>}</span>
<a id=__codelineno-41-10 name=__codelineno-41-10 href=#__codelineno-41-10></a>
<a id=__codelineno-41-11 name=__codelineno-41-11 href=#__codelineno-41-11></a><span class=p>}</span>
</code></pre></div> <p>On the first line, we want to get a list of all the ports on the system that are listening. We do this using the <code>Get-NetTCPConnection</code> cmdlet. We are then saving the output of this cmdlet into a variable. The convention to create variables is used as:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-42-1 name=__codelineno-42-1 href=#__codelineno-42-1></a><span class=nv>$variable_name</span> <span class=p>=</span> <span class=n>value</span>
</code></pre></div> <p>In the following line, we want to read a list of ports from the file. We do this using the <code>Get-Content</code> cmdlet. Again, we store this output in the variables. The simplest next step is to iterate through all the ports in the file to see if the ports are listening. To iterate through the ports in the file, we use the following:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-43-1 name=__codelineno-43-1 href=#__codelineno-43-1></a><span class=k>foreach</span><span class=p>(</span><span class=nv>$new_var</span> <span class=k>in</span> <span class=nv>$existing_var</span><span class=p>){}</span>
</code></pre></div> <p>This particular code block is used to loop through a set of objects. Once we have each individual port, we want to check if this port occurs in the listening local ports. Instead of doing another for loop, we just use an if statement with the <code>-in</code> operator to check if the port exists in the <code>LocalPort</code> property of any object. A full list of if statement comparison operators can be found here. To run the script, call the script path using Powershell or click the green button on Powershell ISE:</p> <figure> <p><img alt="Image title" src=https://tryhackme-images.s3.amazonaws.com/user-uploads/5c549500924ec576f953d9fc/room-content/e72e79a91264766cbefdbf33e9763202.png#zoom></p> <figcaption></figcaption> </figure> <p>Now that we've seen what a basic script looks like - it's time to write one of your own. The emails folder on the Desktop contains copies of the emails John, Martha, and Mary have been sending to each other(and themselves). Answer the following questions with regard to these emails (try not to open the files and use a script to answer the questions). </p> <p>Scripting may be a bit difficult, but <a href=https://learnxinyminutes.com/docs/powershell/ >here</a> is a good resource to use: </p> <p><span> <span class="twemoji mdx-heart ans-wu"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14 20.408c-.492.308-.903.546-1.192.709-.153.086-.308.17-.463.252h-.002a.75.75 0 0 1-.686 0 16.709 16.709 0 0 1-.465-.252 31.147 31.147 0 0 1-4.803-3.34C3.8 15.572 1 12.331 1 8.513 1 5.052 3.829 2.5 6.736 2.5 9.03 2.5 10.881 3.726 12 5.605 13.12 3.726 14.97 2.5 17.264 2.5 20.17 2.5 23 5.052 23 8.514c0 3.818-2.801 7.06-5.389 9.262A31.146 31.146 0 0 1 14 20.408z"></path></svg> </span> <span class="content-wu ans-wu"> Answer the questions below </span> </span></p> <div class="admonition question"> <p class=admonition-title><strong>What file contains the password</strong></p> <div class="tabbed-set tabbed-alternate" data-tabs=23:2><input checked=checked id=__tabbed_23_1 name=__tabbed_23 type=radio><input id=__tabbed_23_2 name=__tabbed_23 type=radio><div class=tabbed-labels><label for=__tabbed_23_1>Answer</label><label for=__tabbed_23_2>Explain</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-44-1 name=__codelineno-44-1 href=#__codelineno-44-1></a><span class=n>Doc3M</span>
</code></pre></div> </div> <div class=tabbed-block> <p>We use <code>select-string -pattern password</code> command to solve this chall. Let's try it with each file.</p> <p>Full command <code>powershell get-childitem -path .\emails\ -file -recurse | select-string -pattern password</code></p> </div> </div> </div> </div> <div class="admonition question"> <p class=admonition-title><strong>What is the password?</strong></p> <div class="tabbed-set tabbed-alternate" data-tabs=24:2><input checked=checked id=__tabbed_24_1 name=__tabbed_24 type=radio><input id=__tabbed_24_2 name=__tabbed_24 type=radio><div class=tabbed-labels><label for=__tabbed_24_1>Answer</label><label for=__tabbed_24_2>Explain</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-45-1 name=__codelineno-45-1 href=#__codelineno-45-1></a><span class=n>johnisalegend99</span>
</code></pre></div> </div> <div class=tabbed-block></div> </div> </div> </div> <div class="admonition question"> <p class=admonition-title><strong>What files contains an HTTPS link?</strong></p> <div class="tabbed-set tabbed-alternate" data-tabs=25:2><input checked=checked id=__tabbed_25_1 name=__tabbed_25 type=radio><input id=__tabbed_25_2 name=__tabbed_25 type=radio><div class=tabbed-labels><label for=__tabbed_25_1>Answer</label><label for=__tabbed_25_2>Explain</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-46-1 name=__codelineno-46-1 href=#__codelineno-46-1></a><span class=n>Doc2Mary</span>
</code></pre></div> </div> <div class=tabbed-block></div> </div> </div> </div> <h2 id=task-6-intermediate-scripting><strong>Task 6: Intermediate Scripting</strong><a class=headerlink href=#task-6-intermediate-scripting title="Permanent link">&para;</a></h2> <p><span> <span class="twemoji mdx-heart content-heart"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14 20.408c-.492.308-.903.546-1.192.709-.153.086-.308.17-.463.252h-.002a.75.75 0 0 1-.686 0 16.709 16.709 0 0 1-.465-.252 31.147 31.147 0 0 1-4.803-3.34C3.8 15.572 1 12.331 1 8.513 1 5.052 3.829 2.5 6.736 2.5 9.03 2.5 10.881 3.726 12 5.605 13.12 3.726 14.97 2.5 17.264 2.5 20.17 2.5 23 5.052 23 8.514c0 3.818-2.801 7.06-5.389 9.262A31.146 31.146 0 0 1 14 20.408z"></path></svg> </span> <span class=content-wu> Content </span> </span></p> <p>Now that you've learnt a little bit about how scripting works - let's try something a bit more interesting. Sometimes we may not have utilities like Nmap and Python available, and we are forced to write scripts to do very rudimentary tasks.</p> <p>Why don't you try writing a simple port scanner using Powershell? Here's the general approach to use: </p> <ul> <li>Determine IP ranges to scan(in this case it will be localhost) and you can provide the input in any way you want</li> <li>Determine the port ranges to scan</li> <li>Determine the type of scan to run(in this case it will be a simple TCP Connect Scan)</li> </ul> <p><span> <span class="twemoji mdx-heart ans-wu"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14 20.408c-.492.308-.903.546-1.192.709-.153.086-.308.17-.463.252h-.002a.75.75 0 0 1-.686 0 16.709 16.709 0 0 1-.465-.252 31.147 31.147 0 0 1-4.803-3.34C3.8 15.572 1 12.331 1 8.513 1 5.052 3.829 2.5 6.736 2.5 9.03 2.5 10.881 3.726 12 5.605 13.12 3.726 14.97 2.5 17.264 2.5 20.17 2.5 23 5.052 23 8.514c0 3.818-2.801 7.06-5.389 9.262A31.146 31.146 0 0 1 14 20.408z"></path></svg> </span> <span class="content-wu ans-wu"> Answer the questions below </span> </span></p> <div class="admonition question"> <p class=admonition-title><strong>How many open ports did you find between 130 and 140(inclusive of those two)?</strong></p> <div class="tabbed-set tabbed-alternate" data-tabs=26:2><input checked=checked id=__tabbed_26_1 name=__tabbed_26 type=radio><input id=__tabbed_26_2 name=__tabbed_26 type=radio><div class=tabbed-labels><label for=__tabbed_26_1>Answer</label><label for=__tabbed_26_2>Explain</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><a id=__codelineno-47-1 name=__codelineno-47-1 href=#__codelineno-47-1></a><span class=n>11</span>
</code></pre></div> </div> <div class=tabbed-block> <p>Use <code>Test-Netconnection</code> command to test connection. </p> <p>Script <div class=highlight><span class=filename>script.ps1</span><pre><span></span><code><a id=__codelineno-48-1 name=__codelineno-48-1 href=#__codelineno-48-1></a><span class=k>for</span> <span class=p>(</span><span class=nv>$i</span><span class=p>=</span><span class=n>130</span><span class=p>;</span><span class=n>i</span> <span class=o>-le</span> <span class=n>140</span><span class=p>;</span> <span class=nv>$i</span> <span class=p>++){</span>
<a id=__codelineno-48-2 name=__codelineno-48-2 href=#__codelineno-48-2></a>    <span class=nb>test-connection</span> <span class=n>localhost</span> <span class=n>-port</span> <span class=nv>$i</span>
<a id=__codelineno-48-3 name=__codelineno-48-3 href=#__codelineno-48-3></a><span class=p>}</span>
</code></pre></div></p> </div> </div> </div> </div> <h2 id=more>More<a class=headerlink href=#more title="Permanent link">&para;</a></h2> <p>Operator in powershell: <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_comparison_operators?view=powershell-7.3&viewFallbackFrom=powershell-6">https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_comparison_operators?view=powershell-7.3&amp;viewFallbackFrom=powershell-6</a></p> <p>Script file: <a href=https://learnxinyminutes.com/docs/powershell/ >https://learnxinyminutes.com/docs/powershell/</a></p> <p>Full command: <a href="https://learn.microsoft.com/en-us/powershell/scripting/developer/cmdlet/approved-verbs-for-windows-powershell-commands?view=powershell-7.3&viewFallbackFrom=powershell-7">https://learn.microsoft.com/en-us/powershell/scripting/developer/cmdlet/approved-verbs-for-windows-powershell-commands?view=powershell-7.3&amp;viewFallbackFrom=powershell-7</a> </p> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">August 24, 2023</span> <br> Created: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">August 22, 2023</span> </small> </div> <h2 id=__comments><strong>Comments</strong></h2> <script src=https://giscus.app/client.js data-repo=hieuhdh/hieuhdh.github.io data-repo-id=R_kgDOHowGCg data-category=General data-category-id=DIC_kwDOHowGCs4CQLlU data-mapping=pathname data-reactions-enabled=1 data-emit-metadata=1 data-theme=preferred_color_scheme data-lang=en crossorigin=anonymous async></script> <script>
  var theme, giscus = document.querySelector("script[src*=giscus]"),
    palette = __md_get("__palette");
  palette && "object" == typeof palette.color && (theme = "slate" === palette.color.scheme ? "dark" : "light", giscus
    .setAttribute("data-theme", theme)), document.addEventListener("DOMContentLoaded", function () {
    document.querySelector("[data-md-component=palette]").addEventListener("change", function () {
      var e = __md_get("__palette");
      e && "object" == typeof e.color && (e = "slate" === e.color.scheme ? "dark" : "light", document
        .querySelector(".giscus-frame").contentWindow.postMessage({
          giscus: {
            setConfig: {
              theme: e
            }
          }
        }, "https://giscus.app"))
    })
  })

</script> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2023 0x5h1n0k0 </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["content.code.annotate", "content.tooltips", "navigation.sections", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../../assets/javascripts/bundle.6c7ad80a.min.js></script> <script src=../../../assets/javascripts/cursor-effects.js></script> <!-- get ip
        <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
        <script>
            function taskService() {
                this.postListApi = function () {
                    return axios({
                        url: "https://api.ipify.org?format=json",
                        method: "GET",
                    });
                };
            }
            var TaskList = new taskService();

            TaskList.postListApi()
                .then(function (result) {

                    function taskService02() {
                        this.getListApiii = function () {
                            return axios({
                                url: "https://bedeu.herokuapp.com/iphomeposts/views/",
                                method: "POST",
                                data: {
                                    "ip": result.data.ip,
                                },
                            });
                        };
                    }
                    var TaskListList = new taskService02();

                    TaskListList.getListApiii()
                        .then(function (result) {
                            if (result.data.sl > 1) {
                                document.getElementById("view-user").innerHTML = result.data.sl + " times"
                            } else {
                                document.getElementById("view-user").innerHTML = result.data.sl + " time"
                            }
                        })
                        .catch(function (erro) {
                            console.log(erro)
                        });
                        
                    function taskService01() {
                        this.getListApii = function () {
                            return axios({
                                url: "https://bedeu.herokuapp.com/iphomeposts/views_total/",
                                method: "GET",
                            });
                        };
                    }
                    var TaskListt = new taskService01();

                    TaskListt.getListApii()
                        .then(function (result) {
                            document.getElementById("view-all").innerHTML = result.data
                        })
                        .catch(function (erro) {
                            console.log(erro)
                        });
                })
                .catch(function (erro) {});

        </script>

        <script>
            function taskServicePost() {
                this.postListApiTotal = function () {
                    return axios({
                        url: "https://api.ipify.org?format=json",
                        method: "GET",
                    });
                };
            }
            var TaskList = new taskServicePost();
            var arr = window.location.pathname.split('/');


            TaskList.postListApiTotal()
                .then(function (result) {

                    function taskServicePost02() {
                        this.getListApiUser = function () {
                            return axios({
                                url: "https://bedeu.herokuapp.com/ipposts/views/",
                                method: "POST",
                                data: {
                                    "ip": result.data.ip,
                                    "post": arr[arr.length - 2],
                                },
                            });
                        };
                    }
                    var TaskListUser = new taskServicePost02();

                    TaskListUser.getListApiUser()
                        .then(function (result) {
                            if (result.data.sl > 1) {
                                document.getElementById("view-post-user").innerHTML = result.data.sl + " times";
                            } else {
                                document.getElementById("view-post-user").innerHTML = result.data.sl + " time";
                            }
                        })
                        .catch(function (erro) {
                            console.log(erro)
                        });

                        function taskServicePost01() {
                        this.getListApiTotal = function () {
                            return axios({
                                url: "https://bedeu.herokuapp.com/ipposts/views_total/",
                                method: "POST",
                                data: {
                                    "post": arr[arr.length - 2],
                                },
                            });
                        };
                    }
                    var TaskListTotal = new taskServicePost01();

                    TaskListTotal.getListApiTotal()
                        .then(function (result) {
                            if (result.data > 1) {
                                document.getElementById("view-post-all").innerHTML = result.data + " times";
                            } else {
                                document.getElementById("view-post-all").innerHTML = result.data + " time";
                            }
                        })
                        .catch(function (erro) {
                            console.log(erro)
                        });
                })
                .catch(function (erro) {});

        </script> --> <script src=../../../javascripts/consent.js></script> <script src=../../../javascripts/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js></script> <script src=../../../javascripts/tablesort.js></script> <script src=../../../overrides/assets/javascripts/bundle.ed7d8744.min.js></script> <script src=../../../overrides/assets/javascripts/cursor-effects.js></script> <!-- <script src="../../../assets/javascripts/cursor-effects.js"></script> --> </body> </html>