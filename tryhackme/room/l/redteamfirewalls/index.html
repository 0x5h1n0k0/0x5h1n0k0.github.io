<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content=0x5h1n0k0><link href=https://0x5h1n0k0.github.io/tryhackme/room/l/redteamfirewalls/ rel=canonical><link rel=icon href=../../../../assets/favicon.png><meta name=generator content="mkdocs-1.5.2, mkdocs-material-8.3.9"><title>Firewalls | 0x5h1n0k0</title><link rel=stylesheet href=../../../../assets/stylesheets/main.1d29e8d0.min.css><link rel=stylesheet href=../../../../assets/stylesheets/cur.css><link rel=stylesheet href=../../../../assets/stylesheets/footer.scss><link rel=stylesheet href=../../../../assets/stylesheets/palette.cbb835fc.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Fira+Sans:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Fira Sans";--md-code-font:"Fira Code"}</style><link rel=stylesheet href=../../../../stylesheets/extra.css><script>__md_scope=new URL("../../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-XXXXXXXXXX"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&gtag("event","search",{search_term:this.value})}),"undefined"!=typeof location$&&location$.subscribe(function(e){gtag("config","G-XXXXXXXXXX",{page_path:e.pathname})})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script><!-- live 2d --><link href=https://r18-nmsl.cn/pio/pio.css rel=stylesheet type=text/css><!-- <link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css">
    <script src="https://fastly.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/autoload.js"></script> --></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#firewalls class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../.. title=0x5h1n0k0 class="md-header__button md-logo" aria-label=0x5h1n0k0 data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82z"></path></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> 0x5h1n0k0 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Firewalls </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/0x5h1n0k0/0x5h1n0k0.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> 0x5h1n0k0/0x5h1n0k0.github.io <ul class=md-source__facts> </ul> </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../.. title=0x5h1n0k0 class="md-nav__button md-logo" aria-label=0x5h1n0k0 data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82z"></path></svg> </a> 0x5h1n0k0 </label> <div class=md-nav__source> <a href=https://github.com/0x5h1n0k0/0x5h1n0k0.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> 0x5h1n0k0/0x5h1n0k0.github.io <ul class=md-source__facts> </ul> </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1> PINNED <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=PINNED data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> PINNED </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../cve/ class=md-nav__link> CVE </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1_2 type=checkbox id=__nav_1_2> <label class=md-nav__link for=__nav_1_2> Privilege Escalation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Privilege Escalation" data-md-level=2> <label class=md-nav__title for=__nav_1_2> <span class="md-nav__icon md-icon"></span> Privilege Escalation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../notes/privilege-escalation/linux/ class=md-nav__link> Linux Privilege Escalation </a> </li> <li class=md-nav__item> <a href=../../../../notes/privilege-escalation/windows/ class=md-nav__link> Windows Privilege Escalation </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../notes/reverse-shell/ class=md-nav__link> Reverse Shell Cheatsheet </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> Try Hack Me <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Try Hack Me" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Try Hack Me </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ class=md-nav__link> Machines </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> 247CTF <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=247CTF data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> 247CTF </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../247ctf/ class=md-nav__link> Web </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../dvwa/ class=md-nav__link> DVWA </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#task-1-introduction class=md-nav__link> Task 1 Introduction </a> <nav class=md-nav aria-label="Task 1  Introduction"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#learning-objectives class=md-nav__link> Learning Objectives </a> </li> <li class=md-nav__item> <a href=#warmup-questions class=md-nav__link> Warmup Questions </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#task-2-types-of-firewalls class=md-nav__link> Task 2: Types of Firewalls </a> </li> <li class=md-nav__item> <a href=#task-3-evasion-via-controlling-the-source-macipport class=md-nav__link> Task 3: Evasion via Controlling the Source MAC/IP/Port </a> <nav class=md-nav aria-label="Task 3: Evasion via Controlling the Source MAC/IP/Port"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#decoys class=md-nav__link> Decoy(s) </a> </li> <li class=md-nav__item> <a href=#proxy class=md-nav__link> Proxy </a> </li> <li class=md-nav__item> <a href=#spoofed-mac-address class=md-nav__link> Spoofed MAC Address </a> </li> <li class=md-nav__item> <a href=#spoofed-ip-address class=md-nav__link> Spoofed IP Address </a> </li> <li class=md-nav__item> <a href=#fixed-source-port-number class=md-nav__link> Fixed Source Port Number </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#task-4-evasion-via-forcing-fragmentation-mtu-and-data-length class=md-nav__link> Task 4: Evasion via Forcing Fragmentation, MTU, and Data Length </a> <nav class=md-nav aria-label="Task 4: Evasion via Forcing Fragmentation, MTU, and Data Length"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#fragment-your-packets-with-8-bytes-of-data class=md-nav__link> Fragment Your Packets with 8 Bytes of Data </a> </li> <li class=md-nav__item> <a href=#fragment-your-packets-with-16-bytes-of-data class=md-nav__link> Fragment Your Packets with 16 Bytes of Data </a> </li> <li class=md-nav__item> <a href=#fragment-your-packets-according-to-a-set-mtu class=md-nav__link> Fragment Your Packets According to a Set MTU </a> </li> <li class=md-nav__item> <a href=#generate-packets-with-specific-length class=md-nav__link> Generate Packets with Specific Length </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#task-5-evasion-via-modifying-header-fields class=md-nav__link> Task 5: Evasion via Modifying Header Fields </a> <nav class=md-nav aria-label="Task 5: Evasion via Modifying Header Fields"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#set-ttl class=md-nav__link> Set TTL </a> </li> <li class=md-nav__item> <a href=#set-ip-options class=md-nav__link> Set IP Options </a> </li> <li class=md-nav__item> <a href=#use-a-wrong-checksum class=md-nav__link> Use a Wrong Checksum </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#task-6-evasion-using-port-hopping class=md-nav__link> Task 6: Evasion Using Port Hopping </a> </li> <li class=md-nav__item> <a href=#task-7-evasion-using-port-tunneling class=md-nav__link> Task 7: Evasion Using Port Tunneling </a> <nav class=md-nav aria-label="Task 7: Evasion Using Port Tunneling"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#port-tunneling-using-ncat class=md-nav__link> Port Tunneling Using ncat </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#task-8-evasion-using-non-standard-ports class=md-nav__link> Task 8: Evasion Using Non-Standard Ports </a> </li> <li class=md-nav__item> <a href=#task-9-next-generation-firewalls class=md-nav__link> Task 9: Next-Generation Firewalls </a> </li> <li class=md-nav__item> <a href=#task-10-conclusion class=md-nav__link> Task 10: Conclusion </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/0x5h1n0k0/0x5h1n0k0.github.io/edit/master/docs/tryhackme/room/l/redteamfirewalls/index.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg> </a> <h1 id=firewalls><strong>Firewalls</strong><a class=headerlink href=#firewalls title="Permanent link">&para;</a></h1><p style="color:#bdbdbd"><i>Estimated time to read: 31 minutes</i></p>
 <hr> <h2 id=task-1-introduction><strong>Task 1 Introduction</strong><a class=headerlink href=#task-1-introduction title="Permanent link">&para;</a></h2> <p>A firewall is software or hardware that monitors the network traffic and compares it against a set of rules before passing or blocking it. One simple analogy is a guard or gatekeeper at the entrance of an event. This gatekeeper can check the ID of individuals against a set of rules before letting them enter (or leave).</p> <p>Before we go into more details about firewalls, it is helpful to remember the contents of an IP packet and TCP segment. The following figure shows the fields we expect to find in an IP header. If the figure below looks complicated, you don’t need to worry as we are only interested in a few fields. Different types of firewalls are capable of inspecting various packet fields; however, the most basic firewall should be able to inspect at least the following fields:</p> <ul> <li>Protocol</li> <li>Source Address</li> <li>Destination Address</li> </ul> <p><img alt src=image.png></p> <p>Depending on the protocol field, the data in the IP datagram can be one of many options. Three common protocols are:</p> <ul> <li>TCP</li> <li>UDP</li> <li>ICMP</li> </ul> <p>In the case of TCP or UDP, the firewall should at least be able to check the TCP and UDP headers for:</p> <ul> <li>Source Port Number</li> <li>Destination Port Number</li> </ul> <p>The TCP header is shown in the figure below. We notice that there are many fields that the firewall might or might not be able to analyze; however, even the most limited of firewalls should give the firewall administrator control over allowed or blocked source and destination port numbers.</p> <p><img alt src=image-1.png></p> <h3 id=learning-objectives><strong>Learning Objectives</strong><a class=headerlink href=#learning-objectives title="Permanent link">&para;</a></h3> <p>This room covers:</p> <ol> <li>The different types of firewalls, according to different classification criteria</li> <li>Various techniques to evade firewalls</li> </ol> <p>This room requires the user to have basic knowledge of:</p> <ul> <li>ISO/OSI layers and TCP/IP layers. We suggest going through the <a href=https://tryhackme.com/module/network-fundamentals>Network Fundamentals</a> module if you want to refresh your knowledge.</li> <li>Network and port scanning. We suggest you complete the Nmap module to learn more about this topic.</li> <li>Reverse and bind shells. We recommend the <a href=tryhackme/room/l/introtoshells>What the Shell</a>? room to learn more about shells.</li> </ul> <h3 id=warmup-questions><strong>Warmup Questions</strong><a class=headerlink href=#warmup-questions title="Permanent link">&para;</a></h3> <p>The design logic of traditional firewalls is that a port number would identify the service and the protocol. In traditional firewalls, i.e., packet-filtering firewalls, everything is allowed and blocked mainly based on the following:</p> <ul> <li>Protocol, such as TCP, UDP, and ICMP</li> <li>IP source address</li> <li>IP destination address</li> <li>Source TCP or UDP port number</li> <li>Destination TCP or UDP port number</li> </ul> <p>Let’s consider this very simplified example. If you want to block HTTP traffic, you need to block the TCP traffic from source TCP port 80, i.e., the port number used by HTTP by default. If you want to allow HTTPS traffic, you should allow the traffic from source TCP port number 443, i.e., the port number used by HTTPS. Obviously, this is not efficient because there are other default port numbers that we need to include. Furthermore, the service can be running on a non-default port number. Someone can run an HTTP server on port 53 or 6667.</p> <p>Visit <a href=http://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml>Service Name and Transport Protocol Port Number Registry</a> to learn more about the default port number and to answer the following questions.</p> <details class=question> <summary>Answer the questions bellow</summary> <p>Question: If you want to block telnet, which TCP port number would you deny?</p> <blockquote> <p>Ans: 23</p> </blockquote> <p>Question: You want to allow HTTPS, which TCP port number do you need to permit?</p> <blockquote> <p>Ans: 443</p> </blockquote> <p>Question: What is an alternate TCP port number used for HTTP? It is described as “HTTP Alternate.”</p> <blockquote> <p>Ans: 8080</p> </blockquote> <p>Question: You need to allow SNMP over SSH, snmpssh. Which port should be permitted?</p> <blockquote> <p>Ans: 5161</p> <p> <figure><img src=image-2.png><figcaption><a href="https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml?search=snmp">https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml?search=snmp</a></figcaption> </figure> </p> </blockquote> </details> <h2 id=task-2-types-of-firewalls><strong>Task 2: Types of Firewalls</strong><a class=headerlink href=#task-2-types-of-firewalls title="Permanent link">&para;</a></h2> <p>There are multiple ways to classify firewalls. One way to classify firewalls would be whether they are independent appliances.</p> <ol> <li>Hardware Firewall (appliance firewall): As the name implies, an appliance firewall is a separate piece of hardware that the network traffic has to go through. Examples include Cisco ASA (Adaptive Security Appliance), WatchGuard Firebox, and Netgate pfSense Plus appliance.</li> <li>Software firewall: This is a piece of software that comes bundled with the OS, or you can install it as an additional service. MS Windows has a built-in firewall, Windows Defender Firewall, that runs along with the other OS services and user applications. Another example is Linux iptables and firewalld.</li> </ol> <p><img alt src=image-3.png></p> <p>We can also classify firewalls into:</p> <ol> <li>Personal firewall: A personal firewall is designed to protect a single system or a small network, for example, a small number of devices and systems at a home network. Most likely, you are using a personal firewall at home without paying much attention to it. For instance, many wireless access points designed for homes have a built-in firewall. One example is Bitdefender BOX. Another example is the firewall that comes as part of many wireless access points and home routers from Linksys and Dlink.</li> <li>Commercial firewall: A commercial firewall protects medium-to-large networks. Consequently, you would expect higher reliability and processing power, in addition to supporting a higher network bandwidth. Most likely, you are going through such a firewall when accessing the Internet from within your university or company.</li> </ol> <p>From the red team perspective, the most crucial classification would be based on the firewall inspection abilities. It is worth thinking about the firewall abilities in terms of the ISO/OSI layers shown in the figure below. Before we classify firewalls based on their abilities, it is worthy of remembering that firewalls focus on layers 3 and 4 and, to a lesser extent, layer 2. Next-generation firewalls are also designed to cover layers 5, 6, and 7. The more layers a firewall can inspect, the more sophisticated it gets and the more processing power it needs.</p> <p><img alt src=image-4.png></p> <p>Based on firewall abilities, we can list the following firewall types:</p> <ul> <li>Packet-Filtering Firewall: Packet-filtering is the most basic type of firewall. This type of firewall inspects the protocol, source and destination IP addresses, and source and destination ports in the case of TCP and UDP datagrams. It is a stateless inspection firewall.</li> <li>Circuit-Level Gateway: In addition to the features offered by the packet-filtering firewalls, circuit-level gateways can provide additional capabilities, such as checking TCP three-way-handshake against the firewall rules.</li> <li>Stateful Inspection Firewall: Compared to the previous types, this type of firewall gives an additional layer of protection as it keeps track of the established TCP sessions. As a result, it can detect and block any TCP packet outside an established TCP session.</li> <li>Proxy Firewall: A proxy firewall is also referred to as Application Firewall (AF) and Web Application Firewall (WAF). It is designed to masquerade as the original client and requests on its behalf. This process allows the proxy firewall to inspect the contents of the packet payload instead of being limited to the packet headers. Generally speaking, this is used for web applications and does not work for all protocols.</li> <li>Next-Generation Firewall (NGFW): NGFW offers the highest firewall protection. It can practically monitor all network layers, from OSI Layer 2 to OSI Layer 7. It has application awareness and control. Examples include the Juniper SRX series and Cisco Firepower.</li> <li>Cloud Firewall or Firewall as a Service (FWaaS): FWaaS replaces a hardware firewall in a cloud environment. Its features might be comparable to NGFW, depending on the service provider; however, it benefits from the scalability of cloud architecture. One example is Cloudflare Magic Firewall, which is a network-level firewall. Another example is Juniper vSRX; it has the same features as an NGFW but is deployed in the cloud. It is also worth mentioning AWS WAF for web application protection and AWS Shield for DDoS protection.</li> </ul> <details class=question> <summary>Answer the questions bellow</summary> <p>Question: What is the most basic type of firewall?</p> <blockquote> <p>Ans: Packet-Filtering Firewall</p> </blockquote> <p>Question: What is the most advanced type of firewall that you can have on company premises?</p> <blockquote> <p>Ans: Next-Generation Firewall</p> </blockquote> </details> <h2 id=task-3-evasion-via-controlling-the-source-macipport><strong>Task 3: Evasion via Controlling the Source MAC/IP/Port</strong><a class=headerlink href=#task-3-evasion-via-controlling-the-source-macipport title="Permanent link">&para;</a></h2> <p>When scanning a host behind a firewall, the firewall will usually detect and block port scans. This situation would require you to adapt your network and port scan to evade the firewall. A network scanner like Nmap provides few features to help with such a task. In this room, we group Nmap techniques into three groups:</p> <ul> <li>Evasion via controlling the source MAC/IP/Port</li> <li>Evasion via fragmentation, MTU, and data length</li> <li>Evasion through modifying header fields</li> </ul> <p>Nmap allows you to hide or spoof the source as you can use:</p> <ul> <li>Decoy(s)</li> <li>Proxy</li> <li>Spoofed MAC Address</li> <li>Spoofed Source IP Address</li> <li>Fixed Source Port Number</li> </ul> <p>Before we elaborate on each approach, let’s show what a Nmap stealth (SYN) scan looks like. We are scanning an MS Windows target (with default built-in firewall), so we added <code>-Pn</code> to force the scan to proceed even if no ping reply is received. <code>-Pn</code> is used to skip host discovery and testing whether the host is live. Moreover, to speed up the scan, we limited ourselves to the 100 most common ports using the <code>-F</code> option. The scan was performed using the following command <code>nmap -sS -Pn -F MACHINE_IP</code>.</p> <p>The following screenshot shows Wireshark’s capture of the Nmap probe packets. Wireshark was running on the same system running Nmap.</p> <p><img alt src=image-5.png></p> <p>We can dive into all the details embedded into each packet; however, for this exercise, we would like to note the following:</p> <ul> <li>Our IP address <code>10.14.17.226</code> has generated and sent around 200 packets. The <code>-F</code> option limits the scan to the top 100 common ports; moreover, each port is sent a second SYN packet if it does not reply to the first one.</li> <li>The source port number is chosen at random. In the screenshot, you can see it is 37710.</li> <li>The total length of the IP packet is 44 bytes. There are 20 bytes for the IP header, which leaves 24 bytes for the TCP header. No data is sent via TCP.</li> <li>The Time to Live (TTL) is 42.</li> <li>No errors are introduced in the checksum.</li> </ul> <p>In the following sections and tasks, we will see how Nmap provides various options to evade the firewall and other network security solutions.</p> <details class=question> <summary>Answer the questions bellow</summary> <p>Question: What is the size of the IP packet when using a default Nmap stealth (SYN) scan?</p> <blockquote> <p>Ans: 44</p> </blockquote> <p>Question: How many bytes does the TCP segment hold in its data field when using a default Nmap stealth (SYN) scan?</p> <blockquote> <p>Ans: 0</p> </blockquote> <p>Question: Approximately, how many packets do you expect Nmap to send when running the command <code>nmap -sS -F MACHINE_IP</code>? Approximate to the nearest 100, such as 100, 200, 300, etc.</p> <blockquote> <p>Ans: 200</p> </blockquote> <h3 id=decoys><strong>Decoy(s)</strong><a class=headerlink href=#decoys title="Permanent link">&para;</a></h3> <p>Hide your scan with decoys. Using decoys makes your IP address mix with other “decoy” IP addresses. Consequently, it will be difficult for the firewall and target host to know where the port scan is coming from. Moreover, this can exhaust the blue team investigating each source IP address.</p> <p>Using the <code>-D</code> option, you can add decoy source IP addresses to confuse the target. Consider the following command, <code>nmap -sS -Pn -D 10.10.10.1,10.10.10.2,ME -F MACHINE_IP</code>. The Wireshark capture is shown in the following figure.</p> <p><img alt src=image-6.png></p> <p>The target <code>MACHINE_IP</code> will also see scans coming from 10.10.10.1 and 10.10.10.2 when only one source IP address, ME, is running the scan. Note that if you omit the ME entry in the scan command, Nmap will put your real IP address, i.e. ME, in a random position.</p> <p>You can also set Nmap to use random source IP addresses instead of explicitly specifying them. By running <code>nmap -sS -Pn -D RND,RND,ME -F MACHINE_IP</code>, Nmap will choose two random source IP addresses to use as decoys. Nmap will use new random IP addresses each time you run this command. In the screenshot below, we see how Nmap picked two random IP addresses in addition to our own, <code>10.14.17.226</code>.</p> <p><img alt src=image-7.png></p> <p>Approximately, how many packets do you expect Nmap to send when running the command <code>nmap -sS -Pn -D RND,10.10.55.33,ME,RND -F MACHINE_IP</code>? Approximate to the nearest 100, such as 100, 200, 300, etc.</p> <blockquote> <p>Ans: 800</p> </blockquote> <h3 id=proxy><strong>Proxy</strong><a class=headerlink href=#proxy title="Permanent link">&para;</a></h3> <p>Use an HTTP/SOCKS4 proxy. Relaying the port scan via a proxy helps keep your IP address unknown to the target host. This technique allows you to keep your IP address hidden while the target logs the IP address of the proxy server. You can go this route using the Nmap option <code>--proxies PROXY_URL</code>. For example, <code>nmap -sS -Pn --proxies PROXY_URL -F MACHINE_IP</code> will send all its packets via the proxy server you specify. Note that you can chain proxies using a comma-separated list.</p> <p>What do you expect the target to see as the source of the scan when you run the command <code>nmap -sS -Pn --proxies 10.10.13.37 MACHINE_IP</code></p> <blockquote> <p>Ans: 10.10.13.37</p> </blockquote> <h3 id=spoofed-mac-address><strong>Spoofed MAC Address</strong><a class=headerlink href=#spoofed-mac-address title="Permanent link">&para;</a></h3> <p>Spoof the source MAC address. Nmap allows you to spoof your MAC address using the option <code>--spoof-mac MAC_ADDRESS</code>. This technique is tricky; spoofing the MAC address works only if your system is on the same network segment as the target host. The target system is going to reply to a spoofed MAC address. If you are not on the same network segment, sharing the same Ethernet, you won’t be able to capture and read the responses. It allows you to exploit any trust relationship based on MAC addresses. Moreover, you can use this technique to hide your scanning activities on the network. For example, you can make your scans appear as if coming from a network printer.</p> <p>What company has registered the following Organizationally Unique Identifier (OUI), i.e., the first 24 bits of a MAC address, <code>00:02:DC</code>?</p> <blockquote> <p>Ans: Fujitsu General Ltd</p> <p>Visit <a href=https://maclookup.app/macaddress/0002DC/mac-address-details>https://maclookup.app/macaddress/0002DC/mac-address-details</a></p> </blockquote> <h3 id=spoofed-ip-address><strong>Spoofed IP Address</strong><a class=headerlink href=#spoofed-ip-address title="Permanent link">&para;</a></h3> <p>Spoof the source IP address. Nmap lets you spoof your IP address using <code>-S IP_ADDRESS</code>. Spoofing the IP address is useful if your system is on the same subnetwork as the target host; otherwise, you won’t be able to read the replies sent back. The reason is that the target host will reply to the spoofed IP address, and unless you can capture the responses, you won’t benefit from this technique. Another use for spoofing your IP address is when you control the system that has that particular IP address. Consequently, if you notice that the target started to block the spoofed IP address, you can switch to a different spoofed IP address that belongs to a system that you also control. This scanning technique can help you maintain stealthy existence; moreover, you can use this technique to exploit trust relationships on the network based on IP addresses.</p> <p>To mislead the opponent, you decided to make your port scans appear as if coming from a local access point that has the IP address <code>10.10.0.254</code>. What option needs to be added to your Nmap command to spoof your address accordingly?</p> <blockquote> <p>Ans: -S 10.10.0.254</p> </blockquote> <h3 id=fixed-source-port-number><strong>Fixed Source Port Number</strong><a class=headerlink href=#fixed-source-port-number title="Permanent link">&para;</a></h3> <p>Use a specific source port number. Scanning from one particular source port number can be helpful if you discover that the firewalls allow incoming packets from particular source port numbers, such as port 53 or 80. Without inspecting the packet contents, packets from source TCP port 80 or 443 look like packets from a web server, while packets from UDP port 53 look like responses to DNS queries. You can set your port number using <code>-g</code> or <code>--source-port</code> options.</p> <p>The following Wireshark screenshot shows a Nmap scan with the fixed source TCP port number 8080. We have used the following Nmap command, <code>nmap -sS -Pn -g 8080 -F MACHINE_IP</code>. You can see in the screenshot how it is that all the TCP connections are sent from the same TCP port number.</p> <p><img alt src=image-8.png></p> <p>You decide to use Nmap to scan for open UDP ports. You notice that using <code>nmap -sU -F MACHINE_IP</code> to discover the open common UDP ports won’t give you any meaningful results. What do you need to add to your Nmap command to set the source port number to 53?</p> <blockquote> <p>Ans: -g 53</p> </blockquote> <p>This is a quick summary of the Nmap options discussed in this task.</p> <table> <thead> <tr> <th><strong>Evasion Approach</strong></th> <th><strong>Nmap Argument</strong></th> </tr> </thead> <tbody> <tr> <td>Hide a scan with decoys</td> <td><code>-D DECOY1_IP1,DECOY_IP2,ME</code></td> </tr> <tr> <td>Hide a scan with random decoys</td> <td><code>-D RND,RND,ME</code></td> </tr> <tr> <td>Use an HTTP/SOCKS4 proxy to relay connections</td> <td><code>--proxies PROXY_URL</code></td> </tr> <tr> <td>Spoof source MAC address</td> <td><code>--spoof-mac MAC_ADDRESS</code></td> </tr> <tr> <td>Spoof source IP address</td> <td><code>-S IP_ADDRESS</code></td> </tr> <tr> <td>Use a specific source port number</td> <td><code>-g PORT_NUM</code> or <code>--source-port PORT_NUM</code></td> </tr> </tbody> </table> </details> <h2 id=task-4-evasion-via-forcing-fragmentation-mtu-and-data-length><strong>Task 4: Evasion via Forcing Fragmentation, MTU, and Data Length</strong><a class=headerlink href=#task-4-evasion-via-forcing-fragmentation-mtu-and-data-length title="Permanent link">&para;</a></h2> <p>You can control the packet size as it allows you to:</p> <ul> <li>Fragment packets, optionally with given MTU. If the firewall, or the IDS/IPS, does not reassemble the packet, it will most likely let it pass. Consequently, the target system will reassemble and process it.</li> <li>Send packets with specific data lengths.</li> </ul> <details class=question> <summary>Answer the questions bellow</summary> <h3 id=fragment-your-packets-with-8-bytes-of-data><strong>Fragment Your Packets with 8 Bytes of Data</strong><a class=headerlink href=#fragment-your-packets-with-8-bytes-of-data title="Permanent link">&para;</a></h3> <p>One easy way to fragment your packets would be to use the <code>-f</code> option. This option will fragment the IP packet to carry only 8 bytes of data. As mentioned earlier, running a Nmap TCP port scan means that the IP packet will hold 24 bytes, the TCP header. If you want to limit the IP data to 8 bytes, the 24 bytes of the TCP header will be divided across 3 IP packets. And this is precisely what we obtained when we ran this Nmap scan, <code>nmap -sS -Pn -f -F MACHINE_IP</code>. As we can see in the Wireshark capture in the figure below, each IP packet is fragmented into three packets, each with 8 bytes of data.</p> <p><img alt src=image-9.png></p> <p>What is the size of the IP packet when running Nmap with the <code>-f</code> option?</p> <blockquote> <p>Ans: 28</p> </blockquote> <h3 id=fragment-your-packets-with-16-bytes-of-data><strong>Fragment Your Packets with 16 Bytes of Data</strong><a class=headerlink href=#fragment-your-packets-with-16-bytes-of-data title="Permanent link">&para;</a></h3> <p>Another handy option is the <code>-ff</code>, limiting the IP data to 16 bytes. (One easy way to remember this is that one <code>f</code> is 8 bytes, but two <code>f</code>s are 16 bytes.) By running <code>nmap -sS -Pn -ff -F MACHINE_IP</code>, we expect the 24 bytes of the TCP header to be divided between two IP packets, 16 + 8, because <code>-ff</code> has put an upper limit of 16 bytes. The first few packets are shown in the Wireshark capture below.</p> <p><img alt src=image-10.png> </p> <p>What is the maximum size of the IP packet when running Nmap with the <code>-ff</code> option?</p> <blockquote> <p>Ans: 36</p> </blockquote> <h3 id=fragment-your-packets-according-to-a-set-mtu><strong>Fragment Your Packets According to a Set MTU</strong><a class=headerlink href=#fragment-your-packets-according-to-a-set-mtu title="Permanent link">&para;</a></h3> <p>Another neat way to fragment your packets is by setting the MTU. In Nmap, <code>--mtu VALUE</code> specifies the number of bytes per IP packet. In other words, the IP header size is not included. The value set for MTU must always be a multiple of 8.</p> <p>Note that the Maximum Transmission Unit (MTU) indicates the maximum packet size that can pass on a certain link-layer connection. For instance, Ethernet has an MTU of 1500, meaning that the largest IP packet that can be sent over an Ethernet (link layer) connection is 1500 bytes. Please don’t confuse this MTU with the <code>--mtu</code> in Nmap options.</p> <p>Running Nmap with <code>--mtu 8</code> will be identical to <code>-f</code> as the IP data will be limited to 8 bytes. The first few packets generated by this Nmap scan <code>nmap -sS -Pn --mtu 8 -F MACHINE_IP</code> are shown in the following Wireshark capture.</p> <p><img alt src=image-11.png></p> <p>What is the maximum size of the IP packet when running Nmap with <code>--mtu 36</code> option?</p> <blockquote> <p>Ans: 56</p> </blockquote> <h3 id=generate-packets-with-specific-length><strong>Generate Packets with Specific Length</strong><a class=headerlink href=#generate-packets-with-specific-length title="Permanent link">&para;</a></h3> <p>In some instances, you might find out that the size of the packets is triggering the firewall or the IDS/IPS to detect and block you. If you ever find yourself in such a situation, you can make your port scanning more evasive by setting a specific length. You can set the length of data carried within the IP packet using <code>--data-length VALUE</code>. Again, remember that the length should be a multiple of 8.</p> <p>If you run the following Nmap scan <code>nmap -sS -Pn --data-length 64 -F MACHINE_IP</code>, each TCP segment will be padded with random data till its length is 64 bytes. In the screenshot below, we can see that each TCP segment has a length of 64 bytes.</p> <p><img alt src=image-12.png></p> <p>What is the maximum size of the IP packet when running Nmap with <code>--data-length 128</code> option?</p> <blockquote> <p>Ans: 148</p> </blockquote> <p>This is a quick summary of the Nmap options discussed in this task.</p> <table> <thead> <tr> <th align=center><strong>Evasion Approach</strong></th> <th align=center><strong>Nmap Argument</strong></th> </tr> </thead> <tbody> <tr> <td align=center>Fragment IP data into 8 bytes</td> <td align=center>-f</td> </tr> <tr> <td align=center>Fragment IP data into 16 bytes</td> <td align=center>-ff</td> </tr> <tr> <td align=center>Fragment packets with given MTU</td> <td align=center>--mtu VALUE</td> </tr> <tr> <td align=center>Specify packet length</td> <td align=center>--data-length NUM</td> </tr> </tbody> </table> </details> <h2 id=task-5-evasion-via-modifying-header-fields><strong>Task 5: Evasion via Modifying Header Fields</strong><a class=headerlink href=#task-5-evasion-via-modifying-header-fields title="Permanent link">&para;</a></h2> <p>Nmap allows you to control various header fields that might help evade the firewall. You can:</p> <ul> <li>Set IP time-to-live</li> <li>Send packets with specified IP options</li> <li>Send packets with a wrong TCP/UDP checksum</li> </ul> <h3 id=set-ttl><strong>Set TTL</strong><a class=headerlink href=#set-ttl title="Permanent link">&para;</a></h3> <p>Nmap gives you further control over the different fields in the IP header. One of the fields you can control is the Time-to-Live (TTL). Nmap options include <code>--ttl VALUE</code> to set the TTL to a custom value. This option might be useful if you think the default TTL exposes your port scan activities.</p> <p>In the following screenshot, we can see the packets captured by Wireshark after using a custom TTL as we run our scan, <code>nmap -sS -Pn --ttl 81 -F MACHINE_IP</code>. As with the previous examples, the packets below are captured on the same system running Nmap.</p> <p><img alt src=image-13.png></p> <details class=question> <summary>Answer the questions bellow</summary> <p>Start the AttackBox and the machine attached to this task. After you give them time to load fully, scan the attached MS Windows machine using --ttl 1 option. Check the number of ports that appear to be open. The answer will vary depending on whether you are using the AttackBox or connecting over VPN. We suggest you try both.</p> <p>Question: Scan the attached MS Windows machine using <code>--ttl 2</code> option. How many ports appear to be open?</p> <blockquote> <p>Ans: 3 <img alt src=image-17.png></p> </blockquote> <h3 id=set-ip-options><strong>Set IP Options</strong><a class=headerlink href=#set-ip-options title="Permanent link">&para;</a></h3> <p>One of the IP header fields is the IP Options field. Nmap lets you control the value set in the IP Options field using --ip-options HEX_STRING, where the hex string can specify the bytes you want to use to fill in the IP Options field. Each byte is written as \xHH, where HH represents two hexadecimal digits, i.e., one byte.</p> <p>A shortcut provided by Nmap is using the letters to make your requests:</p> <ul> <li><code>R</code> to record-route.</li> <li><code>T</code> to record-timestamp.</li> <li><code>U</code> to record-route and record-timestamp.</li> <li><code>L</code> for loose source routing and needs to be followed by a list of IP addresses separated by space.</li> <li><code>S</code> for strict source routing and needs to be followed by a list of IP addresses separated by space.</li> </ul> <p>The loose and strict source routing can be helpful if you want to try to make your packets take a particular route to avoid a specific security system.</p> <h3 id=use-a-wrong-checksum><strong>Use a Wrong Checksum</strong><a class=headerlink href=#use-a-wrong-checksum title="Permanent link">&para;</a></h3> <p>Another trick you can use is to send your packets with an intentionally wrong checksum. Some systems would drop a packet with a bad checksum, while others won’t. You can use this to your advantage to discover more about the systems in your network. All you need to do is add the option <code>--badsum</code> to your Nmap command.</p> <p>Using <code>nmap -sS -Pn --badsum -F MACHINE_IP</code>, we scanned our target using intentionally incorrect TCP checksums. The target dropped all our packets and didn’t respond to any of them.</p> <div class=highlight><span class=filename>Pentester Terminal</span><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=n>pentester</span><span class=nv>@TryHackMe</span><span class=c># nmap -sS -Pn --badsum -F MACHINE_IP</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=n>Host</span> <span class=n>discovery</span> <span class=n>disabled</span> <span class=p>(</span><span class=n>-Pn</span><span class=p>).</span> <span class=n>All</span> <span class=n>addresses</span> <span class=n>will</span> <span class=n>be</span> <span class=n>marked</span> <span class=s1>&#39;up&#39;</span> <span class=n>and</span> <span class=n>scan</span> <span class=n>times</span> <span class=n>will</span> <span class=n>be</span> <span class=n>slower</span><span class=p>.</span>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=n>Starting</span> <span class=n>Nmap</span> <span class=n>7</span><span class=p>.</span><span class=n>91</span> <span class=p>(</span> <span class=n>https</span><span class=p>://</span><span class=n>nmap</span><span class=p>.</span><span class=n>org</span> <span class=p>)</span> <span class=n>at</span> <span class=n>2022</span><span class=p>-</span><span class=n>01</span><span class=p>-</span><span class=n>28</span> <span class=n>16</span><span class=p>:</span><span class=n>07</span> <span class=n>EET</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=n>Nmap</span> <span class=n>scan</span> <span class=n>report</span> <span class=k>for</span> <span class=n>MACHINE_IP</span>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=n>Host</span> <span class=n>is</span> <span class=n>up</span><span class=p>.</span>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=n>All</span> <span class=n>100</span> <span class=n>scanned</span> <span class=n>ports</span> <span class=n>on</span> <span class=n>MACHINE_IP</span> <span class=n>are</span> <span class=n>filtered</span>
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=n>Nmap</span> <span class=n>done</span><span class=p>:</span> <span class=n>1</span> <span class=n>IP</span> <span class=n>address</span> <span class=p>(</span><span class=n>1</span> <span class=n>host</span> <span class=n>up</span><span class=p>)</span> <span class=n>scanned</span> <span class=k>in</span> <span class=n>21</span><span class=p>.</span><span class=n>31</span> <span class=n>seconds</span>
</code></pre></div> <p>The screenshot below shows the packets captured by Wireshark on the system running Nmap. Wireshark can be optionally set to verify the checksums, and we can notice how it highlights the errors.</p> <p><img alt src=image-14.png></p> <p>Question: Scan the attached MS Windows machine using the <code>--badsum</code> option. How many ports appear to be open?</p> <blockquote> <p>Ans: 0 <figure><img src=image-18.png><figcaption>Alt text</figcaption> </figure> </p> </blockquote> <p>This is a quick summary of the Nmap options discussed in this task.</p> <table> <thead> <tr> <th align=center>Evasion Approach</th> <th align=center>Nmap Argument</th> </tr> </thead> <tbody> <tr> <td align=center>Set IP time-to-live field</td> <td align=center>--ttl VALUE</td> </tr> <tr> <td align=center>Send packets with specified IP options</td> <td align=center>--ip-options OPTIONS</td> </tr> <tr> <td align=center>Send packets with a wrong TCP/UDP checksum</td> <td align=center>--badsum</td> </tr> </tbody> </table> </details> <h2 id=task-6-evasion-using-port-hopping><strong>Task 6: Evasion Using Port Hopping</strong><a class=headerlink href=#task-6-evasion-using-port-hopping title="Permanent link">&para;</a></h2> <p>Three common firewall evasion techniques are:</p> <ul> <li>Port hopping</li> <li>Port tunneling</li> <li>Use of non-standard ports</li> </ul> <p>Port hopping is a technique where an application hops from one port to another till it can establish and maintain a connection. In other words, the application might try different ports till it can successfully establish a connection. Some “legitimate” applications use this technique to evade firewalls. In the following figure, the client kept trying different ports to reach the server till it discovered a destination port not blocked by the firewall.</p> <p><img alt src=image-15.png></p> <p>There is another type of port hopping where the application establishes the connection on one port and starts transmitting some data; after a while, it establishes a new connection on (i.e., hopping to) a different port and resumes sending more data. The purpose is to make it more difficult for the blue team to detect and track all the exchanged traffic.</p> <p>On the AttackBox, you can use the command <code>ncat -lvnp PORT_NUMBER</code> to listen on a certain TCP port.</p> <ul> <li><code>-l</code> listens for incoming connections</li> <li><code>-v</code> provides verbose details (optional)</li> <li><code>-n</code> does not resolve hostnames via DNS (optional)</li> <li><code>-p</code> specifies the port number to use</li> <li><code>-lvnp PORT_NUMBER</code> listens on TCP port <code>PORT_NUMBER</code>. If the port number is less than 1024, you need to run <code>ncat</code> as root.</li> </ul> <p>For example, run <code>ncat -lvnp 1025</code> on the AttackBox to listen on TCP port 1025, as shown in the terminal output below.</p> <div class=highlight><span class=filename>Pentester Terminal</span><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=n>pentester</span><span class=nv>@TryHackMe</span><span class=p>$</span> <span class=n>ncat</span> <span class=n>-lvnp</span> <span class=n>1025</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=n>Ncat</span><span class=p>:</span> <span class=n>Version</span> <span class=n>7</span><span class=p>.</span><span class=n>91</span> <span class=p>(</span> <span class=n>https</span><span class=p>://</span><span class=n>nmap</span><span class=p>.</span><span class=n>org</span><span class=p>/</span><span class=n>ncat</span> <span class=p>)</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=n>Ncat</span><span class=p>:</span> <span class=n>Listening</span> <span class=n>on</span> <span class=p>:::</span><span class=n>1025</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=n>Ncat</span><span class=p>:</span> <span class=n>Listening</span> <span class=n>on</span> <span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>:</span><span class=n>1025</span>
</code></pre></div> <p>We want to test if the target machine can connect to the AttackBox on TCP port 1025. By browsing to <code>http://MACHINE_IP:8080</code>, you will be faced with a web page that lets you execute commands on the target machine. Note that in a real-case scenario, you might be exploiting a vulnerable service that allows remote code execution (RCE) or a misconfigured system to execute some code of your choice.</p> <p>In this lab, you can simply run a Linux command by submitting it on the provided form at <code>http://MACHINE_IP:8080</code>. We can use Netcat to connect to the target port using the command <code>ncat IP_ADDRSS PORT_NUMBER</code>. For instance, we can run <code>ncat ATTACKBOX_IP 1024</code> to connect to the AttackBox at TCP port 1024. We want to check if the firewall is configured to allow connections. If the connection from the machine, with IP address <code>MACHINE_IP</code>, can pass through the firewall, we will be notified of the successful connection on the AttackBox terminal as shown below.</p> <div class=highlight><span class=filename>Pentester Terminal</span><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=n>pentester</span><span class=nv>@TryHackMe</span><span class=p>$</span> <span class=n>ncat</span> <span class=n>-lvnp</span> <span class=n>1025</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=n>Ncat</span><span class=p>:</span> <span class=n>Version</span> <span class=n>7</span><span class=p>.</span><span class=n>91</span> <span class=p>(</span> <span class=n>https</span><span class=p>://</span><span class=n>nmap</span><span class=p>.</span><span class=n>org</span><span class=p>/</span><span class=n>ncat</span> <span class=p>)</span>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=n>Ncat</span><span class=p>:</span> <span class=n>Listening</span> <span class=n>on</span> <span class=p>:::</span><span class=n>1025</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=n>Ncat</span><span class=p>:</span> <span class=n>Listening</span> <span class=n>on</span> <span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>:</span><span class=n>1025</span>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=n>Ncat</span><span class=p>:</span> <span class=n>Connection</span> <span class=n>from</span> <span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>30</span><span class=p>.</span><span class=n>130</span><span class=p>.</span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=n>Ncat</span><span class=p>:</span> <span class=n>Connection</span> <span class=n>from</span> <span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>30</span><span class=p>.</span><span class=n>130</span><span class=p>:</span><span class=n>51292</span><span class=p>.</span>
</code></pre></div> <details class=question> <summary>Answer the questions bellow</summary> <p>Using this simple technique, discover which port number of the following destination TCP port numbers are reachable from the protected system. - 21 - 23 - 25 - 26 - 27</p> <blockquote> <p>Ans: 21 <img alt src=image-19.png></p> </blockquote> </details> <h2 id=task-7-evasion-using-port-tunneling><strong>Task 7: Evasion Using Port Tunneling</strong><a class=headerlink href=#task-7-evasion-using-port-tunneling title="Permanent link">&para;</a></h2> <p>Port tunneling is also known as port forwarding and port mapping. In simple terms, this technique forwards the packets sent to one destination port to another destination port. For instance, packets sent to port 80 on one system are forwarded to port 8080 on another system.</p> <h3 id=port-tunneling-using-ncat><strong>Port Tunneling Using ncat</strong><a class=headerlink href=#port-tunneling-using-ncat title="Permanent link">&para;</a></h3> <p>Consider the case where you have a server behind the firewall that you cannot access from the outside. However, you discovered that the firewall does not block specific port(s). You can use this knowledge to your advantage by tunneling the traffic via a different port.</p> <p>Consider the following case. We have an SMTP server listening on port 25; however, we cannot connect to the SMTP server because the firewall blocks packets from the Internet sent to destination port 25. We discover that packets sent to destination port 443 are not blocked, so we decide to take advantage of this and send our packets to port 443, and after they pass through the firewall, we forward them to port 25. Let’s say that we can run a command of our choice on one of the systems behind the firewall. We can use that system to forward our packets to the SMTP server using the following command. <code>ncat -lvnp 443 -c "ncat TARGET_SERVER 25"</code></p> <p>The command <code>ncat</code> uses the following options:</p> <ul> <li><code>-lvnp 443</code> listens on TCP port 443. Because the port number is less than 1024, you need to run <code>ncat</code> as root in this case.</li> <li><code>-c</code> or <code>--sh-exec</code> executes the given command via <code>/bin/sh</code>.</li> <li><code>"ncat TARGET_SERVER 25"</code> will connect to the target server at port 25.</li> </ul> <p>As a result, <code>ncat</code> will listen on port 443, but it will forward all packets to port 25 on the target server. Because in this case, the firewall is blocking port 25 and allowing port 443, port tunneling is an efficient way to evade the firewall.</p> <p><img alt src=image-16.png></p> <details class=question> <summary>Answer the questions bellow</summary> <p>We have a web server listening on the HTTP port, 80. The firewall is blocking traffic to port 80 from the untrusted network; however, we have discovered that traffic to TCP port 8008 is not blocked. We’re continuing to use the web-form from Task 6 to set up the <code>ncat</code> listener that forwards the packets received to the forwarded port. Using port tunneling, browse to the web server and retrieve the flag.</p> <blockquote> <p>Ans: THM{1298331956} <img alt src=image-20.png></p> </blockquote> </details> <h2 id=task-8-evasion-using-non-standard-ports><strong>Task 8: Evasion Using Non-Standard Ports</strong><a class=headerlink href=#task-8-evasion-using-non-standard-ports title="Permanent link">&para;</a></h2> <p><code>ncat -lvnp PORT_NUMBER -e /bin/bash</code> will create a backdoor via the specified port number that lets you interact with the Bash shell.</p> <ul> <li><code>-e</code> or <code>--exec</code> executes the given command</li> <li><code>/bin/bash</code> location of the command we want to execute</li> </ul> <p>On the AttackBox, we can run <code>ncat MACHINE_IP PORT_NUMBER</code> to connect to the target machine and interact with its shell.</p> <p>Considering the case that we have a firewall, it is not enough to use <code>ncat</code> to create a backdoor unless we can connect to the listening port number. Moreover, unless we run <code>ncat</code> as a privileged user, <code>root</code>, or using <code>sudo</code>, we cannot use port numbers below 1024.</p> <details class=question> <summary>Answer the questions bellow</summary> <p>We’re continuing to use the web-form from Task 6 to set up the <code>ncat</code> listener. Knowing that the firewall does not block packets to destination port 8081, use <code>ncat</code> to listen for incoming connections and execute Bash shell. Use the AttackBox to connect to the listening shell. What is the user name associated with which you are logged in?</p> <blockquote> <p>Ans: thmredteam <img alt src=image-21.png></p> </blockquote> </details> <h2 id=task-9-next-generation-firewalls><strong>Task 9: Next-Generation Firewalls</strong><a class=headerlink href=#task-9-next-generation-firewalls title="Permanent link">&para;</a></h2> <p>Traditional firewalls, such as packet-filtering firewalls, expect a port number to dictate the protocol being used and identify the application. Consequently, if you want to block an application, you need to block a port. Unfortunately, this is no longer valid as many applications camouflage themselves using ports assigned for other applications. In other words, a port number is no longer enough nor reliable to identify the application being used. Add to this the pervasive use of encryption, for example, via SSL/TLS.</p> <p>Next-Generation Firewall (NGFW) is designed to handle the new challenges facing modern enterprises. For instance, some of NGFW capabilities include:</p> <ul> <li>Integrate a firewall and a real-time Intrusion Prevention System (IPS). It can stop any detected threat in real-time.</li> <li>Identify users and their traffic. It can enforce the security policy per-user or per-group basis.</li> <li>Identify the applications and protocols regardless of the port number being used.</li> <li>Identify the content being transmitted. It can enforce the security policy in case any violating content is detected.</li> <li>Ability to decrypt SSL/TLS and SSH traffic. For instance, it restricts evasive techniques built around encryption to transfer malicious files.</li> </ul> <p>A properly configured and deployed NGFW renders many attacks useless.</p> <details class=question> <summary>Answer the questions bellow</summary> <p>What is the number of the highest OSI layer that an NGFW can process?</p> <blockquote> <p>Ans: 7</p> </blockquote> </details> <h2 id=task-10-conclusion><strong>Task 10: Conclusion</strong><a class=headerlink href=#task-10-conclusion title="Permanent link">&para;</a></h2> <p>This room covered the different types of firewalls and the common evasion techniques. Correctly understanding the limitations of the firewall technology you are targeting helps you pick and construct suitable firewall evasion processes. This room demonstrated different evasion techniques using <code>ncat</code>; however, the same results can be achieved using a different tool, such as <code>socat</code>. It is recommended to check out the <a href=https://tryhackme.com/room/introtoshells>What the Shell</a>? room.</p> <p>The following table summarizes the Nmap arguments covered in this room.</p> <table> <thead> <tr> <th align=center><strong>Evasion Approach</strong></th> <th align=center><strong>Nmap Argument</strong></th> </tr> </thead> <tbody> <tr> <td align=center>Hide a scan with decoys</td> <td align=center><code>-D DECOY1_IP1,DECOY_IP2,ME</code></td> </tr> <tr> <td align=center>Use an HTTP/SOCKS4 proxy to relay connections</td> <td align=center><code>--proxies PROXY_URL</code></td> </tr> <tr> <td align=center>Spoof source MAC address</td> <td align=center><code>--spoof-mac MAC_ADDRESS</code></td> </tr> <tr> <td align=center>Spoof source IP address</td> <td align=center><code>-S IP_ADDRESS</code></td> </tr> <tr> <td align=center>Use a specific source port number</td> <td align=center><code>-g PORT_NUM</code> or <code>--source-port PORT_NUM</code></td> </tr> <tr> <td align=center>Fragment IP data into 8 bytes</td> <td align=center><code>-f</code></td> </tr> <tr> <td align=center>Fragment IP data into 16 bytes</td> <td align=center><code>-ff</code></td> </tr> <tr> <td align=center>Fragment packets with given MTU</td> <td align=center><code>--mtu VALUE</code></td> </tr> <tr> <td align=center>Specify packet length</td> <td align=center><code>--data-length NUM</code></td> </tr> <tr> <td align=center>Set IP time-to-live field</td> <td align=center><code>--ttl VALUE</code></td> </tr> <tr> <td align=center>Send packets with specified IP options</td> <td align=center><code>--ip-options OPTIONS</code></td> </tr> <tr> <td align=center>Send packets with a wrong TCP/UDP checksum</td> <td align=center><code>--badsum</code></td> </tr> </tbody> </table> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">September 16, 2023</span> <br> Created: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">September 16, 2023</span> </small> </div> <!-- Giscus --> <h2 id=__comments>Comments</h2> <!-- Replace with generated snippet --> <script src=https://giscus.app/client.js data-repo=hieuhdh/hieuhdh.github.io data-repo-id=R_kgDOHowGCg data-category=General data-category-id=DIC_kwDOHowGCs4CQLlU data-mapping=pathname data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=vi crossorigin=anonymous async>
  </script> <!-- Synchronize Giscus theme with palette --> <script>
    var giscus = document.querySelector("script[src*=giscus]")

    /* Set palette on initial load */
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
      var theme = palette.color.scheme === "slate" ? "dark" : "light"
      giscus.setAttribute("data-theme", theme) 
    }

    /* Register event handlers after documented loaded */
    document.addEventListener("DOMContentLoaded", function() {
      var ref = document.querySelector("[data-md-component=palette]")
      ref.addEventListener("change", function() {
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
          var theme = palette.color.scheme === "slate" ? "dark" : "light"

          /* Instruct Giscus to change theme */
          var frame = document.querySelector(".giscus-frame")
          frame.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            "https://giscus.app"
          )
        }
      })
    })
  </script> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2023 0x5h1n0k0 </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../../..", "features": ["content.code.annotate", "content.tooltips", "navigation.sections", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../../../assets/javascripts/bundle.6c7ad80a.min.js></script> <script src=../../../../assets/javascripts/cursor-effects.js></script> <!-- get ip
        <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
        <script>
            function taskService() {
                this.postListApi = function () {
                    return axios({
                        url: "https://api.ipify.org?format=json",
                        method: "GET",
                    });
                };
            }
            var TaskList = new taskService();

            TaskList.postListApi()
                .then(function (result) {

                    function taskService02() {
                        this.getListApiii = function () {
                            return axios({
                                url: "https://bedeu.herokuapp.com/iphomeposts/views/",
                                method: "POST",
                                data: {
                                    "ip": result.data.ip,
                                },
                            });
                        };
                    }
                    var TaskListList = new taskService02();

                    TaskListList.getListApiii()
                        .then(function (result) {
                            if (result.data.sl > 1) {
                                document.getElementById("view-user").innerHTML = result.data.sl + " times"
                            } else {
                                document.getElementById("view-user").innerHTML = result.data.sl + " time"
                            }
                        })
                        .catch(function (erro) {
                            console.log(erro)
                        });
                        
                    function taskService01() {
                        this.getListApii = function () {
                            return axios({
                                url: "https://bedeu.herokuapp.com/iphomeposts/views_total/",
                                method: "GET",
                            });
                        };
                    }
                    var TaskListt = new taskService01();

                    TaskListt.getListApii()
                        .then(function (result) {
                            document.getElementById("view-all").innerHTML = result.data
                        })
                        .catch(function (erro) {
                            console.log(erro)
                        });
                })
                .catch(function (erro) {});

        </script>

        <script>
            function taskServicePost() {
                this.postListApiTotal = function () {
                    return axios({
                        url: "https://api.ipify.org?format=json",
                        method: "GET",
                    });
                };
            }
            var TaskList = new taskServicePost();
            var arr = window.location.pathname.split('/');


            TaskList.postListApiTotal()
                .then(function (result) {

                    function taskServicePost02() {
                        this.getListApiUser = function () {
                            return axios({
                                url: "https://bedeu.herokuapp.com/ipposts/views/",
                                method: "POST",
                                data: {
                                    "ip": result.data.ip,
                                    "post": arr[arr.length - 2],
                                },
                            });
                        };
                    }
                    var TaskListUser = new taskServicePost02();

                    TaskListUser.getListApiUser()
                        .then(function (result) {
                            if (result.data.sl > 1) {
                                document.getElementById("view-post-user").innerHTML = result.data.sl + " times";
                            } else {
                                document.getElementById("view-post-user").innerHTML = result.data.sl + " time";
                            }
                        })
                        .catch(function (erro) {
                            console.log(erro)
                        });

                        function taskServicePost01() {
                        this.getListApiTotal = function () {
                            return axios({
                                url: "https://bedeu.herokuapp.com/ipposts/views_total/",
                                method: "POST",
                                data: {
                                    "post": arr[arr.length - 2],
                                },
                            });
                        };
                    }
                    var TaskListTotal = new taskServicePost01();

                    TaskListTotal.getListApiTotal()
                        .then(function (result) {
                            if (result.data > 1) {
                                document.getElementById("view-post-all").innerHTML = result.data + " times";
                            } else {
                                document.getElementById("view-post-all").innerHTML = result.data + " time";
                            }
                        })
                        .catch(function (erro) {
                            console.log(erro)
                        });
                })
                .catch(function (erro) {});

        </script> --> <script src=../../../../javascripts/consent.js></script> <script src=../../../../javascripts/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js></script> <script src=../../../../javascripts/tablesort.js></script> </body> </html>