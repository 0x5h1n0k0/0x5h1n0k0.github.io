<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content=0x5h1n0k0><link href=https://0x5h1n0k0.github.io/tryhackme/room/l/the-lay-of-the-land/ rel=canonical><link rel=icon href=../../../../assets/favicon.png><meta name=generator content="mkdocs-1.5.2, mkdocs-material-8.3.9"><title>The Lay of the Land | 0x5h1n0k0</title><link rel=stylesheet href=../../../../assets/stylesheets/main.1d29e8d0.min.css><link rel=stylesheet href=../../../../assets/stylesheets/cur.css><link rel=stylesheet href=../../../../assets/stylesheets/footer.scss><link rel=stylesheet href=../../../../assets/stylesheets/palette.cbb835fc.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Fira+Sans:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Fira Sans";--md-code-font:"Fira Code"}</style><link rel=stylesheet href=../../../../stylesheets/extra.css><script>__md_scope=new URL("../../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-XXXXXXXXXX"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&gtag("event","search",{search_term:this.value})}),"undefined"!=typeof location$&&location$.subscribe(function(e){gtag("config","G-XXXXXXXXXX",{page_path:e.pathname})})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script><link rel=stylesheet href=../../../../overrides/assets/stylesheets/main.82a244a8.min.css><!-- live 2d --><link href=https://r18-nmsl.cn/pio/pio.css rel=stylesheet type=text/css><!-- <link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css">
    <script src="https://fastly.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/autoload.js"></script> --></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#the-lay-of-the-land class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../.. title=0x5h1n0k0 class="md-header__button md-logo" aria-label=0x5h1n0k0 data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82z"></path></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> 0x5h1n0k0 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> The Lay of the Land </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/0x5h1n0k0/0x5h1n0k0.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> 0x5h1n0k0/0x5h1n0k0.github.io <ul class=md-source__facts> </ul> </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../.. title=0x5h1n0k0 class="md-nav__button md-logo" aria-label=0x5h1n0k0 data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82z"></path></svg> </a> 0x5h1n0k0 </label> <div class=md-nav__source> <a href=https://github.com/0x5h1n0k0/0x5h1n0k0.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> 0x5h1n0k0/0x5h1n0k0.github.io <ul class=md-source__facts> </ul> </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1> PINNED <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=PINNED data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> PINNED </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../cve/ class=md-nav__link> CVE </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1_2 type=checkbox id=__nav_1_2> <label class=md-nav__link for=__nav_1_2> Privilege Escalation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Privilege Escalation" data-md-level=2> <label class=md-nav__title for=__nav_1_2> <span class="md-nav__icon md-icon"></span> Privilege Escalation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../notes/privilege-escalation/linux/ class=md-nav__link> Linux Privilege Escalation </a> </li> <li class=md-nav__item> <a href=../../../../notes/privilege-escalation/windows/ class=md-nav__link> Windows Privilege Escalation </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../notes/reverse-shell/ class=md-nav__link> Reverse Shell Cheatsheet </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> Try Hack Me <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Try Hack Me" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Try Hack Me </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ class=md-nav__link> Machines </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> 247CTF <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=247CTF data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> 247CTF </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../247ctf/ class=md-nav__link> Web </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../dvwa/ class=md-nav__link> DVWA </a> </li> <li class=md-nav__item> <a href=../../../../tags/tags/ class=md-nav__link> Categories </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#task-1-introduction class=md-nav__link> Task 1: Introduction </a> <nav class=md-nav aria-label="Task 1: Introduction"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#answer-the-question-bellow class=md-nav__link> Answer the question bellow </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#task-2-deploy-the-vm class=md-nav__link> Task 2: Deploy the VM </a> <nav class=md-nav aria-label="Task 2: Deploy the VM"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#answer-the-question-bellow_1 class=md-nav__link> Answer the question bellow </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#task-3-network-infrastructure class=md-nav__link> Task 3: Network Infrastructure </a> <nav class=md-nav aria-label="Task 3: Network Infrastructure"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#noi-dung-chinh class=md-nav__link> Nội dung chính </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#task-4-active-directory-ad-environment class=md-nav__link> Task 4: Active Directory (AD) environment </a> <nav class=md-nav aria-label="Task 4: Active Directory (AD) environment"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#answer-the-questions-bellow class=md-nav__link> Answer the questions bellow </a> </li> <li class=md-nav__item> <a href=#active-directory-ad-enum class=md-nav__link> Active Directory (AD) Enum </a> </li> <li class=md-nav__item> <a href=#answer-the-questions-bellow_1 class=md-nav__link> Answer the questions bellow </a> </li> <li class=md-nav__item> <a href=#host-security-solutions class=md-nav__link> Host Security Solutions </a> </li> <li class=md-nav__item> <a href=#answer-the-questions-bellow_2 class=md-nav__link> Answer the questions bellow </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#task-7-host-security-solution-2 class=md-nav__link> Task 7: Host Security Solution #2 </a> <nav class=md-nav aria-label="Task 7: Host Security Solution #2"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#security-event-logging-and-monitoring class=md-nav__link> Security Event Logging and Monitoring </a> </li> <li class=md-nav__item> <a href=#system-monitor-sysmon1 class=md-nav__link> System Monitor (Sysmon)1 </a> </li> <li class=md-nav__item> <a href=#host-based-intrusion-detectionprevention-system-hidships class=md-nav__link> Host-based Intrusion Detection/Prevention System (HIDS/HIPS) </a> </li> <li class=md-nav__item> <a href=#endpoint-detection-and-response-edr class=md-nav__link> Endpoint Detection and Response (EDR) </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#task-8-network-security-solutions class=md-nav__link> Task 8: Network Security Solutions </a> </li> <li class=md-nav__item> <a href=#task-9-applications-and-services class=md-nav__link> Task 9: Applications and Services </a> <nav class=md-nav aria-label="Task 9: Applications and Services"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#installed-applications class=md-nav__link> Installed Applications </a> </li> <li class=md-nav__item> <a href=#services-and-process class=md-nav__link> Services and Process </a> </li> <li class=md-nav__item> <a href=#sharing-files-and-printers class=md-nav__link> Sharing files and Printers </a> </li> <li class=md-nav__item> <a href=#answer-the-question-bellow_2 class=md-nav__link> Answer the question bellow </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#task-10-conclusion class=md-nav__link> Task 10: Conclusion </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <aside class=mdx-author> </aside> <div class=tags-items style="color: var(--md-default-fg-color--light); padding-bottom: 10px; opacity: 0.9">Tags</div> <a href=https://github.com/0x5h1n0k0/0x5h1n0k0.github.io/edit/master/docs/tryhackme/room/l/the-lay-of-the-land/index.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg> </a> <a href=https://github.com/0x5h1n0k0/0x5h1n0k0.github.io/edit/master/docs/tryhackme/room/l/the-lay-of-the-land/index.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg> </a> <nav class=md-tags> <a href=../../../../tags/tags/#thm-room class=md-tag> THM-Room </a> </nav> <h1 id=the-lay-of-the-land><strong>The Lay of the Land</strong><a class=headerlink href=#the-lay-of-the-land title="Permanent link">&para;</a></h1><p style="color:#bdbdbd"><i>Estimated time to read: 12 minutes</i></p>
 <hr> <h2 id=task-1-introduction><strong>Task 1: Introduction</strong><a class=headerlink href=#task-1-introduction title="Permanent link">&para;</a></h2> <p>It is essential to be familiar with the environment where you have initial access to a compromised machine during a red team engagement. Therefore, performing reconnaissance and enumeration is a significant part, and the primary goal is to gather as much information as possible to be used in the next stage. </p> <p>With an initial foothold established, the post-exploitation process begins! </p> <p>This room introduces commonly-used concepts, technologies, and security products that we need to be aware of.</p> <p>In this room, the assumption is that we have already gained access to the machine, and we are ready to expand our knowledge more about the environment by performing enumerating for the following:</p> <ul> <li>Network infrastrucutre</li> <li>Active Directory Environment</li> <li>Users and Groups</li> <li>Host-based security solutions</li> <li>Network-based security solutions</li> <li>Applications and services</li> </ul> <h3 id=answer-the-question-bellow><strong>Answer the question bellow</strong><a class=headerlink href=#answer-the-question-bellow title="Permanent link">&para;</a></h3> <div class="admonition question"> <p class=admonition-title>Let's start learning!</p> <p>No needed answer</p> </div> <h2 id=task-2-deploy-the-vm><strong>Task 2: Deploy the VM</strong><a class=headerlink href=#task-2-deploy-the-vm title="Permanent link">&para;</a></h2> <h3 id=answer-the-question-bellow_1><strong>Answer the question bellow</strong><a class=headerlink href=#answer-the-question-bellow_1 title="Permanent link">&para;</a></h3> <div class="admonition question"> <p class=admonition-title>Let's discuss the common network infrastructure in the next task!</p> <p>No needed answer</p> </div> <h2 id=task-3-network-infrastructure><strong>Task 3: Network Infrastructure</strong><a class=headerlink href=#task-3-network-infrastructure title="Permanent link">&para;</a></h2> <h3 id=noi-dung-chinh><strong>Nội dung chính</strong><a class=headerlink href=#noi-dung-chinh title="Permanent link">&para;</a></h3> <p>Từ đây trở đi, tôi sẽ nói tiếng việt và có thể tóm tắt một vài điều mà cần nắm trong những task. Ta có một số thứ cơ bản về network như sau:</p> <p><strong>Internal Networks</strong>: Là vùng mạng nội bộ giúp chia sẻ thông tin và liên lạc nhanh hơn trong tổ chức. Những người system admin sẽ config những thứ này</p> <p> <figure><img src=image.png><figcaption>Alt text</figcaption> </figure> </p> <p>Trên đây là hình ảnh sơ lược</p> <p><strong>DMZ Zone</strong>: Vùng DMZ là vùng mạng ngoại biên dùng để bảo vệ cho vùng mạng nội bộ bằng cách đẩy các traffic không đáng tin cậy ra vùng này.</p> <p> <figure><img src=image-1.png><figcaption>Alt text</figcaption> </figure> </p> <p>Trong sơ đồ trước, chúng tôi biểu thị lưu lượng mạng đến mạng DMZ bằng màu đỏ, không đáng tin cậy (đến trực tiếp từ internet). Lưu lượng mạng xanh giữa mạng nội bộ là lưu lượng được kiểm soát có thể đi qua một hoặc nhiều thiết bị an ninh mạng.</p> <p>Việc liệt kê hệ thống và mạng nội bộ là giai đoạn khám phá, cho phép kẻ tấn công tìm hiểu về hệ thống và mạng nội bộ. Dựa trên thông tin thu được, chúng tôi sử dụng thông tin đó để xử lý chuyển động ngang hoặc leo thang đặc quyền nhằm đạt được nhiều đặc quyền hơn trên hệ thống hoặc môi trường AD.</p> <p><strong>Network Enumeration</strong>: </p> <p>Dùng netstat để kiểm tra các kết nối tcp, udp,...</p> <div class=highlight><span class=filename>Command Prompt</span><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nb>PS </span><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>thm</span><span class=p>&gt;</span> <span class=n>netstat</span> <span class=n>-na</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=n>Active</span> <span class=n>Connections</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>  <span class=n>Proto</span>  <span class=n>Local</span> <span class=n>Address</span>          <span class=n>Foreign</span> <span class=n>Address</span>        <span class=n>State</span>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>  <span class=n>TCP</span>    <span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>:</span><span class=n>80</span>             <span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>:</span><span class=n>0</span>              <span class=n>LISTENING</span>
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>  <span class=n>TCP</span>    <span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>:</span><span class=n>88</span>             <span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>:</span><span class=n>0</span>              <span class=n>LISTENING</span>
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>  <span class=n>TCP</span>    <span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>:</span><span class=n>135</span>            <span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>:</span><span class=n>0</span>              <span class=n>LISTENING</span>
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>  <span class=n>TCP</span>    <span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>:</span><span class=n>389</span>            <span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>:</span><span class=n>0</span>              <span class=n>LISTENING</span>
</code></pre></div> <div class=highlight><span class=filename>Command Prompt</span><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=nb>PS </span><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>thm</span><span class=p>&gt;</span> <span class=n>arp</span> <span class=n>-a</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=n>Interface</span><span class=p>:</span> <span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>141</span><span class=p>.</span><span class=n>51</span> <span class=p>---</span> <span class=n>0xa</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>  <span class=n>Internet</span> <span class=n>Address</span>      <span class=n>Physical</span> <span class=n>Address</span>      <span class=nb>Type</span>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>  <span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>1</span>             <span class=n>02-c8</span><span class=p>-</span><span class=n>85-b5</span><span class=p>-</span><span class=n>5a-aa</span>     <span class=n>dynamic</span>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>  <span class=n>10</span><span class=p>.</span><span class=n>10</span><span class=p>.</span><span class=n>255</span><span class=p>.</span><span class=n>255</span>         <span class=n>ff-ff-ff-ff-ff-ff</span>     <span class=n>static</span>
</code></pre></div> <h2 id=task-4-active-directory-ad-environment><strong>Task 4: Active Directory (AD) environment</strong><a class=headerlink href=#task-4-active-directory-ad-environment title="Permanent link">&para;</a></h2> <p>A list of Active Directory components that we need to be familiar with:</p> <ul> <li>Domain Controllers</li> <li>Organizational Units</li> <li>AD objects</li> <li>AD Domains</li> <li>Forest</li> <li>AD Service Accounts: Built-in local users, Domain users, Managed service accounts</li> <li>Domain Administrators</li> </ul> <p> <figure><img src=image-2.png><figcaption>Alt text</figcaption> </figure> </p> <p>Để kiểm tra xem máy tính có phải một phần trong AD hay không ta dùng lệnh <code>systeminfo</code></p> <div class=highlight><span class=filename>Powershell</span><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=nb>PS </span><span class=n>C</span><span class=p>:\</span><span class=n>Users</span><span class=p>\</span><span class=n>thm</span><span class=p>&gt;</span> <span class=n>systeminfo</span> <span class=p>|</span> <span class=n>findstr</span> <span class=n>Domain</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=n>OS</span> <span class=n>Configuration</span><span class=p>:</span>          <span class=n>Primary</span> <span class=n>Domain</span> <span class=n>Controller</span>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=n>Domain</span><span class=p>:</span>                    <span class=n>thmdomain</span><span class=p>.</span><span class=n>com</span>
</code></pre></div> <p>Với kết quả trên, máy đang là 1 phần của AD với domain <code>thmdomain.com</code></p> <p>Nếu kết quả bạn cho ra là <code>WORKGROUP</code> (thông thường test trên máy tính cá nhân) thì đây là môi trường cục bộ.</p> <h3 id=answer-the-questions-bellow><strong>Answer the questions bellow</strong><a class=headerlink href=#answer-the-questions-bellow title="Permanent link">&para;</a></h3> <div class="admonition question"> <p class=admonition-title>Before going any further, ensure the attached machine is deployed and try what we discussed. Is the attached machine part of the AD environment? (Y|N)</p> <p>y</p> </div> <p>Ta kiểm tra bằng lệnh <code>systeminfo | findstr Domain</code></p> <p> <figure><img src=image-3.png><figcaption>Alt text</figcaption> </figure> </p> <div class="admonition question"> <p class=admonition-title>If it is part of an AD environment, what is the domain name of the AD?</p> <p>thmredteam.com</p> </div> <p><strong>Task 5: Users and Groups Management</strong></p> <table> <thead> <tr> <th>BUILTIN\Administrator</th> <th>Local admin access on a domain controller</th> </tr> </thead> <tbody> <tr> <td>Domain Admins</td> <td>Administrative access to all resources in the domain</td> </tr> <tr> <td>Enterprise Admins</td> <td>Available only in the forest root</td> </tr> <tr> <td>Schema Admins</td> <td>Capable of modifying domain/forest; useful for red teamers</td> </tr> <tr> <td>Server Operators</td> <td>Can manage domain servers</td> </tr> <tr> <td>Account Operators</td> <td>Can manage users that are not in privileged groups</td> </tr> </tbody> </table> <h3 id=active-directory-ad-enum><strong>Active Directory (AD) Enum</strong><a class=headerlink href=#active-directory-ad-enum title="Permanent link">&para;</a></h3> <p>Ta dùng lệnh <code>Get-ADUser -Filter *</code> để lấy các tài khoản trong AD</p> <h3 id=answer-the-questions-bellow_1><strong>Answer the questions bellow</strong><a class=headerlink href=#answer-the-questions-bellow_1 title="Permanent link">&para;</a></h3> <div class="admonition question"> <p class=admonition-title>Use the <code>Get-ADUser -Filter * -SearchBase</code> command to list the available user accounts within <code>THM</code> OU in the <code>thmredteam.com</code> domain. How many users are available?</p> <p>6</p> </div> <p>Dùng lệnh <code>Get-ADUser -Filter * -SearchBase "OU=THM,DC=thmredteam,DC=com"</code> nhằm lấy user từ tổ chức <abbr title="TryHackMe is an online cyber security training platform to help individuals and teams break into and up skill in cyber security. The site you are on right now.">THM</abbr></p> <div class="admonition question"> <p class=admonition-title>Once you run the previous command, what is the UserPrincipalName (email) of the admin account?</p> <p><a href=mailto:thmadmin@thmredteam.com>&#116;&#104;&#109;&#97;&#100;&#109;&#105;&#110;&#64;&#116;&#104;&#109;&#114;&#101;&#100;&#116;&#101;&#97;&#109;&#46;&#99;&#111;&#109;</a> </p> </div> <p><strong>Task 6: Host Security Solution #1</strong></p> <h3 id=host-security-solutions><strong>Host Security Solutions</strong><a class=headerlink href=#host-security-solutions title="Permanent link">&para;</a></h3> <ol> <li> <p>Antivirus software:</p> <ul> <li> <p><strong>Signature-based detection</strong> is one of the common and traditional techniques used in antivirus software to identify malicious files. Often, researchers or users submit their infected files into an antivirus engine platform for further analysis by <abbr title="Antivirus software is a program or set of programs that are designed to prevent, search for, detect, and remove software viruses, and other malicious software like worms, trojans, adware, and more.">AV</abbr> vendors, and if it confirms as malicious, then the signature gets registered in their database. The antivirus software compares the scanned file with a database of known signatures for possible attacks and malware on the client-side. If we have a match, then it considers a threat.</p> </li> <li> <p><strong>Heuristic-based detection</strong> uses machine learning to decide whether we have the malicious file or not. It scans and statically analyses in real-time in order to find suspicious properties in the application's code or check whether it uses uncommon Windows or system APIs. It does not rely on the signature-based attack in making the decisions, or sometimes it does. This depends on the implementation of the antivirus software.</p> </li> <li> <p>Finally, <strong>Behavior-based detection</strong> relies on monitoring and examining the execution of applications to find abnormal behaviors and uncommon activities, such as creating/updating values in registry keys, killing/creating processes, etc.</p> </li> <li> <p>As a red teamer, it is essential to be aware of whether antivirus exists or not. It prevents us from doing what we are attempting to do. We can enumerate <abbr title="Antivirus software is a program or set of programs that are designed to prevent, search for, detect, and remove software viruses, and other malicious software like worms, trojans, adware, and more.">AV</abbr> software using Windows built-in tools, such as wmic.</p> </li> <li> <p>Dùng wmic (wmic /namespace:\root\securitycenter2 path antivirusproduct) để liệt kê phần mềm anti virus</p> </li> </ul> <p>Lệnh có ý nghĩa tương đương trên poweshell: <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=nb>Get-CimInstance</span> <span class=n>-Namespace</span> <span class=n>root</span><span class=p>/</span><span class=n>SecurityCenter2</span> <span class=n>-ClassName</span> <span class=n>AntivirusProduct</span>
</code></pre></div></p> </li> <li> <p>Microsoft Windows Defender: Kiểm tra trạng thái dịch vụ của Windows Defender: <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=nb>Get-Service</span> <span class=n>WinDefend</span>
</code></pre></div></p> <p>Kiểm tra trạng thái realtime protection: <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=nb>Get-MpComputerStatus</span> <span class=p>|</span> <span class=nb>select </span><span class=n>RealTimeProtectionEnabled</span>
</code></pre></div></p> </li> <li> <p>Host-based <abbr title="A security tool, hardware or software that is used to filter network traffic by stopping unauthorized incoming and outgoing traffic.">Firewall</abbr>:</p> <p>Kiểm tra tường lửa <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=nb>Get-NetFirewallProfile</span> <span class=p>|</span> <span class=nb>Format-Table</span> <span class=n>Name</span><span class=p>,</span> <span class=n>Enabled</span>
</code></pre></div></p> <p>Lệnh tắt tường lửa (ở vai trò quản trị viên) <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=nb>Set-NetFirewallProfile</span> <span class=n>-Profile</span> <span class=n>Domain</span><span class=p>,</span> <span class=n>Public</span><span class=p>,</span> <span class=n>Private</span> <span class=n>-Enabled</span> <span class=n>False</span>
</code></pre></div></p> <p>Select property của tường lửa: <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=nb>Get-NetFirewallRule</span> <span class=p>|</span> <span class=nb>select </span><span class=p>*</span>
</code></pre></div></p> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=nb>Get-NetFirewallRule</span> <span class=p>|</span> <span class=nb>select </span><span class=n>DisplayName</span><span class=p>,</span> <span class=n>Enabled</span><span class=p>,</span> <span class=n>Description</span>
</code></pre></div> <p>Kiểm tra kết nối <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=nb>Test-NetConnection</span> <span class=n>-ComputerName</span> <span class=n>127</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>0</span><span class=p>.</span><span class=n>1</span> <span class=n>-Port</span> <span class=n>80</span>
</code></pre></div></p> </li> <li> <p>Security Event Logging and Monitoring </p> </li> <li>Host-based Intrusion Detection System (HIDS)/ Host-based Intrusion Prevention System (HIPS)</li> <li>Endpoint Detection and Response (EDR)</li> </ol> <h3 id=answer-the-questions-bellow_2><strong>Answer the questions bellow</strong><a class=headerlink href=#answer-the-questions-bellow_2 title="Permanent link">&para;</a></h3> <div class="admonition question"> <p class=admonition-title>Enumerate the attached Windows machine and check whether the host-based firewall is enabled or not! (Y|N)</p> <p>N</p> </div> <p>Kiểm tra bằng lệnh <code>Get-NetFirewallProfile | Format-Table Name, Enabled</code> ta thấy tường lửa chưa được bật.</p> <p> <figure><img src=image-4.png><figcaption>Alt text</figcaption> </figure> </p> <div class="admonition question"> <p class=admonition-title>Using PowerShell cmdlets such <code>Get-MpThreat</code> can provide us with threats details that have been detected using MS Defender. Run it and answer the following: What is the file name that causes this alert to record?</p> <p>powerview.ps1</p> </div> <p>Xem hình sau <figure><img src=image-5.png><figcaption>Alt text</figcaption> </figure> </p> <div class="admonition question"> <p class=admonition-title>UEnumerate the firewall rules of the attached Windows machine. What is the port that is allowed under the <abbr title="TryHackMe is an online cyber security training platform to help individuals and teams break into and up skill in cyber security. The site you are on right now.">THM</abbr>-Connection rule?</p> <p>17337</p> </div> <p>Dùng lệnh <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=nb>get-netfirewallrule</span> <span class=p>|</span> <span class=nb>select </span><span class=n>displayname</span><span class=p>,</span> <span class=n>enabled</span><span class=p>,</span> <span class=n>description</span>
</code></pre></div></p> <p>Xem hình sau <figure><img src=image-6.png><figcaption>Alt text</figcaption> </figure> </p> <div class="admonition question"> <p class=admonition-title>In the next task, we will keep discussing the host security solution. I'm ready!</p> <p>No needed answer</p> </div> <h2 id=task-7-host-security-solution-2><strong>Task 7: Host Security Solution #2</strong><a class=headerlink href=#task-7-host-security-solution-2 title="Permanent link">&para;</a></h2> <p>Ta sẽ nói về một số giải pháp bảo mật</p> <h3 id=security-event-logging-and-monitoring><strong>Security Event Logging and Monitoring</strong><a class=headerlink href=#security-event-logging-and-monitoring title="Permanent link">&para;</a></h3> <p>Dùng lệnh <code>Get-EventLog -List</code></p> <h3 id=system-monitor-sysmon1><strong>System Monitor (Sysmon)<sup id=fnref:1><a class=footnote-ref href=#fn:1>1</a></sup></strong><a class=headerlink href=#system-monitor-sysmon1 title="Permanent link">&para;</a></h3> <p>Một trong những tính năng của sysmon</p> <ul> <li>Process creation and termination</li> <li>Network connections</li> <li>Modification on file</li> <li>Remote threats</li> <li>Process and memory access</li> <li>and many others</li> </ul> <p>Kiểm tra sysmon có được cài đặt chưa: - <code>Get-Process | Where-Object { $_.ProcessName -eq "Sysmon" }</code> - <code>reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\Channels\Microsoft-Windows-Sysmon/Operational</code></p> <h3 id=host-based-intrusion-detectionprevention-system-hidships><strong>Host-based Intrusion Detection/Prevention System (HIDS/HIPS)</strong><a class=headerlink href=#host-based-intrusion-detectionprevention-system-hidships title="Permanent link">&para;</a></h3> <p> <figure><img src=image-7.png><figcaption>Alt text</figcaption> </figure> </p> <p>HIDS stands for Host-based Intrusion Detection System. It is software that has the ability to monitor and detect abnormal and malicious activities in a host. The primary purpose of HIDS is to detect suspicious activities and not to prevent them. There are two methods that the host-based or network intrusion detection system works, including:</p> <ul> <li>Signature-based <abbr title="Intrusion Detection System (IDS) is a system that detects unauthorised network and system intrusions. Examples include detecting unauthorised devices connected to the local network and unauthorised users accessing a system or modifying a file.">IDS</abbr> - it looks at checksums and message authentication.</li> <li>Anomaly-based <abbr title="Intrusion Detection System (IDS) is a system that detects unauthorised network and system intrusions. Examples include detecting unauthorised devices connected to the local network and unauthorised users accessing a system or modifying a file.">IDS</abbr> looks for unexpected activities, including abnormal bandwidth usage, protocols, and ports.</li> </ul> <p>Host-based Intrusion Prevention Systems (HIPS) works by securing the operating system activities which where is installed. It is a detecting and prevention solution against well-known attacks and abnormal behaviors. HIPS is capable of auditing log files of the host, monitoring processes, and protecting system resources. HIPS is a mixture of best product features such as antivirus, behavior analysis, network, application firewall, etc.</p> <p>There is also a network-based <abbr title="Intrusion Detection System (IDS) is a system that detects unauthorised network and system intrusions. Examples include detecting unauthorised devices connected to the local network and unauthorised users accessing a system or modifying a file.">IDS</abbr>/IPS, which we will be covering in the next task. </p> <h3 id=endpoint-detection-and-response-edr><strong>Endpoint Detection and Response (EDR)</strong><a class=headerlink href=#endpoint-detection-and-response-edr title="Permanent link">&para;</a></h3> <p> <figure><img src=image-8.png><figcaption>Alt text</figcaption> </figure> </p> <p>It is also known as Endpoint Detection and Threat Response (EDTR). The EDR is a cybersecurity solution that defends against malware and other threats. EDRs can look for malicious files, monitor endpoint, system, and network events, and record them in a database for further analysis, detection, and investigation. EDRs are the next generation of antivirus and detect malicious activities on the host in real-time.</p> <p>EDR analyze system data and behavior for making section threats, including</p> <ul> <li>Malware, including viruses, trojans, adware, keyloggers</li> <li>Exploit chains</li> <li>Ransomware</li> </ul> <p>Below are some common EDR software for endpoints</p> <ul> <li>Cylance</li> <li>Crowdstrike</li> <li>Symantec</li> <li>SentinelOne</li> <li>Many others</li> </ul> <p>Even though an attacker successfully delivered their payload and bypassed EDR in receiving reverse shell, EDR is still running and monitors the system. It may block us from doing something else if it flags an alert.</p> <p>We can use scripts for enumerating security products within the machine, such as <a href=https://github.com/PwnDexter/Invoke-EDRChecker>Invoke-EDRChecker</a> and <a href=https://github.com/PwnDexter/SharpEDRChecker>SharpEDRChecker</a>. They check for commonly used Antivirus, EDR, logging monitor products by checking file metadata, processes, DLL loaded into current processes, Services, and drivers, directories.</p> <h2 id=task-8-network-security-solutions><strong>Task 8: Network Security Solutions</strong><a class=headerlink href=#task-8-network-security-solutions title="Permanent link">&para;</a></h2> <h2 id=task-9-applications-and-services><strong>Task 9: Applications and Services</strong><a class=headerlink href=#task-9-applications-and-services title="Permanent link">&para;</a></h2> <h3 id=installed-applications><strong>Installed Applications</strong><a class=headerlink href=#installed-applications title="Permanent link">&para;</a></h3> <p>Liệt kê các ứng dụng đã cài đặt: <code>wmic product get name,version</code></p> <p>Tìm kiếm thư mục/tệp tin ẩn bằng Get-ChildItem với cờ Hidden: <code>Get-ChildItem -Hidden -Path C:\Users\kkidd\Desktop\</code></p> <h3 id=services-and-process><strong>Services and Process</strong><a class=headerlink href=#services-and-process title="Permanent link">&para;</a></h3> <h3 id=sharing-files-and-printers><strong>Sharing files and Printers</strong><a class=headerlink href=#sharing-files-and-printers title="Permanent link">&para;</a></h3> <h3 id=answer-the-question-bellow_2><strong>Answer the question bellow</strong><a class=headerlink href=#answer-the-question-bellow_2 title="Permanent link">&para;</a></h3> <div class="admonition question"> <p class=admonition-title>Finally, we can see it is listening on port 8080. Now try to apply what we discussed and find the port number for <abbr title="TryHackMe is an online cyber security training platform to help individuals and teams break into and up skill in cyber security. The site you are on right now.">THM</abbr> Service. What is the port number?</p> <p>13337</p> </div> <p>Step 1: Kiểm tra dịch vụ đang chạy: <code>net start</code></p> <p> <figure><img src=image-9.png><figcaption>Alt text</figcaption> </figure> </p> <p>Step 2: Kiểm tra dịch vụ <abbr title="TryHackMe is an online cyber security training platform to help individuals and teams break into and up skill in cyber security. The site you are on right now.">THM</abbr> Seivice: <code>wmic service where "name like 'THM Seivice'" get Name,PathName</code></p> <p> <figure><img src=image-10.png><figcaption>Alt text</figcaption> </figure> </p> <p>Step 3: Xem tiến trình dịch vụ thông qua Name và Path: <code>Get-Process -Name thm-service</code></p> <p> <figure><img src=image-11.png><figcaption>Alt text</figcaption> </figure> </p> <p>Hình trên cho ta thấy tiến trình có ID 2736.</p> <p>Ta sẽ liệt kê port internet thông qua ID tiến trình: <code>netstat -noa | findstr "LISTENING" | findstr "2736"</code></p> <p> <figure><img src=image-12.png><figcaption>Alt text</figcaption> </figure> </p> <p>Ta thấy nó listen ở port <code>13337</code>, đây cũng là đáp án cho câu hỏi đầu tiên</p> <div class="admonition question"> <p class=admonition-title>Visit the localhost on the port you found in Question <a class="magiclink magiclink-github magiclink-issue" href=https://github.com/0x5h1n0k0/0x5h1n0k0.github.io/issues/1 title="GitHub Issue: 0x5h1n0k0/0x5h1n0k0.github.io #1">#1</a>. What is the flag?</p> <p><abbr s3rv1cs_1s_3numerat37ed=S3rv1cs_1s_3numerat37ed title="TryHackMe is an online cyber security training platform to help individuals and teams break into and up skill in cyber security. The site you are on right now.">THM</abbr></p> </div> <p> <figure><img src=image-13.png><figcaption>Alt text</figcaption> </figure> </p> <div class="admonition question"> <p class=admonition-title>Now enumerate the domain name of the domain controller, thmredteam.com, using the nslookup.exe, and perform a DNS zone transfer. What is the flag for one of the records?</p> <p><abbr dns-15-enumerated_=DNS-15-Enumerated! title="TryHackMe is an online cyber security training platform to help individuals and teams break into and up skill in cyber security. The site you are on right now.">THM</abbr></p> </div> <p>Step 1: Tranfer DNS bằng nslookup</p> <p>Step 2: Đặt: server MACHINE_IP</p> <p>Step 3: ls -d thmredteam.com</p> <p>Xem hình bên dưới <figure><img src=image-14.png><figcaption>Alt text</figcaption> </figure> </p> <h2 id=task-10-conclusion><strong>Task 10: Conclusion</strong><a class=headerlink href=#task-10-conclusion title="Permanent link">&para;</a></h2> <p>This room is an introduction to client systems in corporate environments. The student should have a better understanding of how clients are used in a corporate network including:</p> <ul> <li>Network Infrastructure</li> <li>AD environment</li> <li>security measures (HIPS, <abbr title="Antivirus software is a program or set of programs that are designed to prevent, search for, detect, and remove software viruses, and other malicious software like worms, trojans, adware, and more.">AV</abbr>, etc.)</li> <li>Internal applications and services</li> </ul> <div class=footnote> <hr> <ol> <li id=fn:1> <p>Xem thêm tại <a href=https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon>https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon</a>&#160;<a class=footnote-backref href=#fnref:1 title="Jump back to footnote 1 in the text">&#8617;</a></p> </li> </ol> </div> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">September 16, 2023</span> <br> Created: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">September 16, 2023</span> </small> </div> <h2 id=__comments><strong>Comments</strong></h2> <script src=https://giscus.app/client.js data-repo=hieuhdh/hieuhdh.github.io data-repo-id=R_kgDOHowGCg data-category=General data-category-id=DIC_kwDOHowGCs4CQLlU data-mapping=pathname data-reactions-enabled=1 data-emit-metadata=1 data-theme=preferred_color_scheme data-lang=en crossorigin=anonymous async></script> <script>
  var theme, giscus = document.querySelector("script[src*=giscus]"),
    palette = __md_get("__palette");
  palette && "object" == typeof palette.color && (theme = "slate" === palette.color.scheme ? "dark" : "light", giscus
    .setAttribute("data-theme", theme)), document.addEventListener("DOMContentLoaded", function () {
    document.querySelector("[data-md-component=palette]").addEventListener("change", function () {
      var e = __md_get("__palette");
      e && "object" == typeof e.color && (e = "slate" === e.color.scheme ? "dark" : "light", document
        .querySelector(".giscus-frame").contentWindow.postMessage({
          giscus: {
            setConfig: {
              theme: e
            }
          }
        }, "https://giscus.app"))
    })
  })

</script> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2023 0x5h1n0k0 </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../../..", "features": ["content.code.annotate", "content.tooltips", "navigation.sections", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../../../assets/javascripts/bundle.6c7ad80a.min.js></script> <script src=../../../../assets/javascripts/cursor-effects.js></script> <!-- get ip
        <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
        <script>
            function taskService() {
                this.postListApi = function () {
                    return axios({
                        url: "https://api.ipify.org?format=json",
                        method: "GET",
                    });
                };
            }
            var TaskList = new taskService();

            TaskList.postListApi()
                .then(function (result) {

                    function taskService02() {
                        this.getListApiii = function () {
                            return axios({
                                url: "https://bedeu.herokuapp.com/iphomeposts/views/",
                                method: "POST",
                                data: {
                                    "ip": result.data.ip,
                                },
                            });
                        };
                    }
                    var TaskListList = new taskService02();

                    TaskListList.getListApiii()
                        .then(function (result) {
                            if (result.data.sl > 1) {
                                document.getElementById("view-user").innerHTML = result.data.sl + " times"
                            } else {
                                document.getElementById("view-user").innerHTML = result.data.sl + " time"
                            }
                        })
                        .catch(function (erro) {
                            console.log(erro)
                        });
                        
                    function taskService01() {
                        this.getListApii = function () {
                            return axios({
                                url: "https://bedeu.herokuapp.com/iphomeposts/views_total/",
                                method: "GET",
                            });
                        };
                    }
                    var TaskListt = new taskService01();

                    TaskListt.getListApii()
                        .then(function (result) {
                            document.getElementById("view-all").innerHTML = result.data
                        })
                        .catch(function (erro) {
                            console.log(erro)
                        });
                })
                .catch(function (erro) {});

        </script>

        <script>
            function taskServicePost() {
                this.postListApiTotal = function () {
                    return axios({
                        url: "https://api.ipify.org?format=json",
                        method: "GET",
                    });
                };
            }
            var TaskList = new taskServicePost();
            var arr = window.location.pathname.split('/');


            TaskList.postListApiTotal()
                .then(function (result) {

                    function taskServicePost02() {
                        this.getListApiUser = function () {
                            return axios({
                                url: "https://bedeu.herokuapp.com/ipposts/views/",
                                method: "POST",
                                data: {
                                    "ip": result.data.ip,
                                    "post": arr[arr.length - 2],
                                },
                            });
                        };
                    }
                    var TaskListUser = new taskServicePost02();

                    TaskListUser.getListApiUser()
                        .then(function (result) {
                            if (result.data.sl > 1) {
                                document.getElementById("view-post-user").innerHTML = result.data.sl + " times";
                            } else {
                                document.getElementById("view-post-user").innerHTML = result.data.sl + " time";
                            }
                        })
                        .catch(function (erro) {
                            console.log(erro)
                        });

                        function taskServicePost01() {
                        this.getListApiTotal = function () {
                            return axios({
                                url: "https://bedeu.herokuapp.com/ipposts/views_total/",
                                method: "POST",
                                data: {
                                    "post": arr[arr.length - 2],
                                },
                            });
                        };
                    }
                    var TaskListTotal = new taskServicePost01();

                    TaskListTotal.getListApiTotal()
                        .then(function (result) {
                            if (result.data > 1) {
                                document.getElementById("view-post-all").innerHTML = result.data + " times";
                            } else {
                                document.getElementById("view-post-all").innerHTML = result.data + " time";
                            }
                        })
                        .catch(function (erro) {
                            console.log(erro)
                        });
                })
                .catch(function (erro) {});

        </script> --> <script src=../../../../javascripts/consent.js></script> <script src=../../../../javascripts/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js></script> <script src=../../../../javascripts/tablesort.js></script> <script src=../../../../overrides/assets/javascripts/bundle.ed7d8744.min.js></script> <script src=../../../../overrides/assets/javascripts/cursor-effects.js></script> <!-- <script src="../../../../assets/javascripts/cursor-effects.js"></script> --> </body> </html>