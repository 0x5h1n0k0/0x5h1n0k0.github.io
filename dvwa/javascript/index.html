<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content=0x5h1n0k0><link href=https://0x5h1n0k0.github.io/dvwa/javascript/ rel=canonical><link rel=icon href=../../assets/favicon.png><meta name=generator content="mkdocs-1.5.2, mkdocs-material-8.3.9"><title>JavaScript | 0x5h1n0k0</title><link rel=stylesheet href=../../assets/stylesheets/main.1d29e8d0.min.css><link rel=stylesheet href=../../assets/stylesheets/cur.css><link rel=stylesheet href=../../assets/stylesheets/footer.scss><link rel=stylesheet href=../../assets/stylesheets/palette.cbb835fc.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Fira+Sans:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Fira Sans";--md-code-font:"Fira Code"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-XXXXXXXXXX"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&gtag("event","search",{search_term:this.value})}),"undefined"!=typeof location$&&location$.subscribe(function(e){gtag("config","G-XXXXXXXXXX",{page_path:e.pathname})})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script><link rel=stylesheet href=../../overrides/assets/stylesheets/main.82a244a8.min.css><!-- live 2d --><link href=https://r18-nmsl.cn/pio/pio.css rel=stylesheet type=text/css><!-- <link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css">
    <script src="https://fastly.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/autoload.js"></script> --></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#javascript class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=0x5h1n0k0 class="md-header__button md-logo" aria-label=0x5h1n0k0 data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82z"></path></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> 0x5h1n0k0 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> JavaScript </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/0x5h1n0k0/0x5h1n0k0.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> 0x5h1n0k0/0x5h1n0k0.github.io <ul class=md-source__facts> </ul> </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=0x5h1n0k0 class="md-nav__button md-logo" aria-label=0x5h1n0k0 data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82z"></path></svg> </a> 0x5h1n0k0 </label> <div class=md-nav__source> <a href=https://github.com/0x5h1n0k0/0x5h1n0k0.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> 0x5h1n0k0/0x5h1n0k0.github.io <ul class=md-source__facts> </ul> </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1> PINNED <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=PINNED data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> PINNED </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cve/ class=md-nav__link> CVE </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1_2 type=checkbox id=__nav_1_2> <label class=md-nav__link for=__nav_1_2> Privilege Escalation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Privilege Escalation" data-md-level=2> <label class=md-nav__title for=__nav_1_2> <span class="md-nav__icon md-icon"></span> Privilege Escalation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../notes/privilege-escalation/linux/ class=md-nav__link> Linux Privilege Escalation </a> </li> <li class=md-nav__item> <a href=../../notes/privilege-escalation/windows/ class=md-nav__link> Windows Privilege Escalation </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../notes/reverse-shell/ class=md-nav__link> Reverse Shell Cheatsheet </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> Try Hack Me <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Try Hack Me" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Try Hack Me </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tryhackme/room/ class=md-nav__link> Machines </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> 247CTF <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=247CTF data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> 247CTF </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../247ctf/ class=md-nav__link> Web </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../ class=md-nav__link> DVWA </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#about class=md-nav__link> About </a> </li> <li class=md-nav__item> <a href=#objective class=md-nav__link> Objective </a> </li> <li class=md-nav__item> <a href=#security-level-low class=md-nav__link> Security Level: Low </a> <nav class=md-nav aria-label="Security Level: Low"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#analysis class=md-nav__link> Analysis </a> </li> <li class=md-nav__item> <a href=#exploition class=md-nav__link> Exploition </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#security-level-medium class=md-nav__link> Security Level: Medium </a> <nav class=md-nav aria-label="Security Level: Medium"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#analysis_1 class=md-nav__link> Analysis </a> </li> <li class=md-nav__item> <a href=#exploition_1 class=md-nav__link> Exploition </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#security-level-high class=md-nav__link> Security Level: High </a> <nav class=md-nav aria-label="Security Level: High"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#analysis_2 class=md-nav__link> Analysis </a> </li> <li class=md-nav__item> <a href=#exploition_2 class=md-nav__link> Exploition </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#security-level-impossible class=md-nav__link> Security Level: Impossible </a> </li> <li class=md-nav__item> <a href=#spoiler class=md-nav__link> Spoiler </a> <nav class=md-nav aria-label=Spoiler> <ul class=md-nav__list> <li class=md-nav__item> <a href=#low-level class=md-nav__link> Low Level </a> </li> <li class=md-nav__item> <a href=#medium-level class=md-nav__link> Medium Level </a> </li> <li class=md-nav__item> <a href=#high-level class=md-nav__link> High Level </a> </li> <li class=md-nav__item> <a href=#impossible-level class=md-nav__link> Impossible Level </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#more-information class=md-nav__link> More Information </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <aside class=mdx-author> </aside> <div class=tags-items style="color: var(--md-default-fg-color--light); padding-bottom: 10px; opacity: 0.9">Tags</div> <a href=https://github.com/0x5h1n0k0/0x5h1n0k0.github.io/edit/master/docs/dvwa/javascript/index.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg> </a> <a href=https://github.com/0x5h1n0k0/0x5h1n0k0.github.io/edit/master/docs/dvwa/javascript/index.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg> </a> <nav class=md-tags> <a href=../../tags/tags/#dvwa class=md-tag> DVWA </a> <a href=../../tags/tags/#javascript class=md-tag> JavaScript </a> </nav> <h1 id=javascript><strong>JavaScript</strong><a class=headerlink href=#javascript title="Permanent link">&para;</a></h1><p style="color:#bdbdbd"><i>Estimated time to read: 6 minutes</i></p>
 <hr> <h2 id=about><strong>About</strong><a class=headerlink href=#about title="Permanent link">&para;</a></h2> <p>The attacks in this section are designed to help you learn about how JavaScript is used in the browser and how it can be manipulated. The attacks could be carried out by just analysing network traffic, but that isn't the point and it would also probably be a lot harder.</p> <h2 id=objective><strong>Objective</strong><a class=headerlink href=#objective title="Permanent link">&para;</a></h2> <p>Simply submit the phrase "success" to win the level. Obviously, it isn't quite that easy, each level implements different protection mechanisms, the JavaScript included in the pages has to be analysed and then manipulated to bypass the protections.</p> <mark class="critic block"> <p>Công việc của ta cho toàn bộ thử thách ở phần này là dịch ngược đoạn mã JavaScript để tìm được giá trị và truyền nó vào thẻ &lt;input> có id là <code>token</code>. </p> </mark> <h2 id=security-level-low><strong>Security Level: Low</strong><a class=headerlink href=#security-level-low title="Permanent link">&para;</a></h2> <p>Source code</p> <div class=highlight><span class=filename>vulnerabilities/javascript/source/low.php</span><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=cp>&lt;?php</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=nv>$page</span><span class=p>[</span> <span class=s1>&#39;body&#39;</span> <span class=p>]</span> <span class=o>.=</span> <span class=s>&lt;&lt;&lt;</span><span class=dl>EOF</span>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=s>&lt;script&gt;</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=s>/*</span>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=s>MD5 code from here</span>
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=s>https://github.com/blueimp/JavaScript-MD5</span>
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=s>*/</span>
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=s>!function(n){&quot;use strict&quot;;function t(n,t){var r=(65535&amp;n)+(65535&amp;t);return(n&gt;&gt;16)+(t&gt;&gt;16)+(r&gt;&gt;16)&lt;&lt;16|65535&amp;r}function r(n,t){return n&lt;&lt;t|n&gt;&gt;&gt;32-t}function e(n,e,o,u,c,f){return t(r(t(t(e,n),t(u,f)),c),o)}function o(n,t,r,o,u,c,f){return e(t&amp;r|~t&amp;o,n,t,u,c,f)}function u(n,t,r,o,u,c,f){return e(t&amp;o|r&amp;~o,n,t,u,c,f)}function c(n,t,r,o,u,c,f){return e(t^r^o,n,t,u,c,f)}function f(n,t,r,o,u,c,f){return e(r^(t|~o),n,t,u,c,f)}function i(n,r){n[r&gt;&gt;5]|=128&lt;&lt;r%32,n[14+(r+64&gt;&gt;&gt;9&lt;&lt;4)]=r;var e,i,a,d,h,l=1732584193,g=-271733879,v=-1732584194,m=271733878;for(e=0;e&lt;n.length;e+=16)i=l,a=g,d=v,h=m,g=f(g=f(g=f(g=f(g=c(g=c(g=c(g=c(g=u(g=u(g=u(g=u(g=o(g=o(g=o(g=o(g,v=o(v,m=o(m,l=o(l,g,v,m,n[e],7,-680876936),g,v,n[e+1],12,-389564586),l,g,n[e+2],17,606105819),m,l,n[e+3],22,-1044525330),v=o(v,m=o(m,l=o(l,g,v,m,n[e+4],7,-176418897),g,v,n[e+5],12,1200080426),l,g,n[e+6],17,-1473231341),m,l,n[e+7],22,-45705983),v=o(v,m=o(m,l=o(l,g,v,m,n[e+8],7,1770035416),g,v,n[e+9],12,-1958414417),l,g,n[e+10],17,-42063),m,l,n[e+11],22,-1990404162),v=o(v,m=o(m,l=o(l,g,v,m,n[e+12],7,1804603682),g,v,n[e+13],12,-40341101),l,g,n[e+14],17,-1502002290),m,l,n[e+15],22,1236535329),v=u(v,m=u(m,l=u(l,g,v,m,n[e+1],5,-165796510),g,v,n[e+6],9,-1069501632),l,g,n[e+11],14,643717713),m,l,n[e],20,-373897302),v=u(v,m=u(m,l=u(l,g,v,m,n[e+5],5,-701558691),g,v,n[e+10],9,38016083),l,g,n[e+15],14,-660478335),m,l,n[e+4],20,-405537848),v=u(v,m=u(m,l=u(l,g,v,m,n[e+9],5,568446438),g,v,n[e+14],9,-1019803690),l,g,n[e+3],14,-187363961),m,l,n[e+8],20,1163531501),v=u(v,m=u(m,l=u(l,g,v,m,n[e+13],5,-1444681467),g,v,n[e+2],9,-51403784),l,g,n[e+7],14,1735328473),m,l,n[e+12],20,-1926607734),v=c(v,m=c(m,l=c(l,g,v,m,n[e+5],4,-378558),g,v,n[e+8],11,-2022574463),l,g,n[e+11],16,1839030562),m,l,n[e+14],23,-35309556),v=c(v,m=c(m,l=c(l,g,v,m,n[e+1],4,-1530992060),g,v,n[e+4],11,1272893353),l,g,n[e+7],16,-155497632),m,l,n[e+10],23,-1094730640),v=c(v,m=c(m,l=c(l,g,v,m,n[e+13],4,681279174),g,v,n[e],11,-358537222),l,g,n[e+3],16,-722521979),m,l,n[e+6],23,76029189),v=c(v,m=c(m,l=c(l,g,v,m,n[e+9],4,-640364487),g,v,n[e+12],11,-421815835),l,g,n[e+15],16,530742520),m,l,n[e+2],23,-995338651),v=f(v,m=f(m,l=f(l,g,v,m,n[e],6,-198630844),g,v,n[e+7],10,1126891415),l,g,n[e+14],15,-1416354905),m,l,n[e+5],21,-57434055),v=f(v,m=f(m,l=f(l,g,v,m,n[e+12],6,1700485571),g,v,n[e+3],10,-1894986606),l,g,n[e+10],15,-1051523),m,l,n[e+1],21,-2054922799),v=f(v,m=f(m,l=f(l,g,v,m,n[e+8],6,1873313359),g,v,n[e+15],10,-30611744),l,g,n[e+6],15,-1560198380),m,l,n[e+13],21,1309151649),v=f(v,m=f(m,l=f(l,g,v,m,n[e+4],6,-145523070),g,v,n[e+11],10,-1120210379),l,g,n[e+2],15,718787259),m,l,n[e+9],21,-343485551),l=t(l,i),g=t(g,a),v=t(v,d),m=t(m,h);return[l,g,v,m]}function a(n){var t,r=&quot;&quot;,e=32*n.length;for(t=0;t&lt;e;t+=8)r+=String.fromCharCode(n[t&gt;&gt;5]&gt;&gt;&gt;t%32&amp;255);return r}function d(n){var t,r=[];for(r[(n.length&gt;&gt;2)-1]=void 0,t=0;t&lt;r.length;t+=1)r[t]=0;var e=8*n.length;for(t=0;t&lt;e;t+=8)r[t&gt;&gt;5]|=(255&amp;n.charCodeAt(t/8))&lt;&lt;t%32;return r}function h(n){return a(i(d(n),8*n.length))}function l(n,t){var r,e,o=d(n),u=[],c=[];for(u[15]=c[15]=void 0,o.length&gt;16&amp;&amp;(o=i(o,8*n.length)),r=0;r&lt;16;r+=1)u[r]=909522486^o[r],c[r]=1549556828^o[r];return e=i(u.concat(d(t)),512+8*t.length),a(i(c.concat(e),640))}function g(n){var t,r,e=&quot;&quot;;for(r=0;r&lt;n.length;r+=1)t=n.charCodeAt(r),e+=&quot;0123456789abcdef&quot;.charAt(t&gt;&gt;&gt;4&amp;15)+&quot;0123456789abcdef&quot;.charAt(15&amp;t);return e}function v(n){return unescape(encodeURIComponent(n))}function m(n){return h(v(n))}function p(n){return g(m(n))}function s(n,t){return l(v(n),v(t))}function C(n,t){return g(s(n,t))}function A(n,t,r){return t?r?s(t,n):C(t,n):r?m(n):p(n)}&quot;function&quot;==typeof define&amp;&amp;define.amd?define(function(){return A}):&quot;object&quot;==typeof module&amp;&amp;module.exports?module.exports=A:n.md5=A}(this);</span>
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>
<a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=s>    function rot13(inp) {</span>
<a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=s>        return inp.replace(/[a-zA-Z]/g,function(c){return String.fromCharCode((c&lt;=&quot;Z&quot;?90:122)&gt;=(c=c.charCodeAt(0)+13)?c:c-26);});</span>
<a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=s>    }</span>
<a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a>
<a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a><span class=s>    function generate_token() {</span>
<a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a><span class=s>        var phrase = document.getElementById(&quot;phrase&quot;).value;</span>
<a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a><span class=s>        document.getElementById(&quot;token&quot;).value = md5(rot13(phrase));</span>
<a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a><span class=s>    }</span>
<a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a>
<a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a><span class=s>    generate_token();</span>
<a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a><span class=s>&lt;/script&gt;</span>
<a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a><span class=dl>EOF</span><span class=p>;</span>
<a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a><span class=cp>?&gt;</span>
</code></pre></div> <h3 id=analysis><strong>Analysis</strong><a class=headerlink href=#analysis title="Permanent link">&para;</a></h3> <p>Để ý hàm <code class=highlight><span class=nx>generate_token</span><span class=p>()</span></code> ta thấy hàm này sẽ tạo token từ keyword <code>success</code> mà ta nhập vào. Công việc của chúng ta ở thời điểm này là điều chỉnh token hệ thống sinh ra thành token được tạo thông qua hàm <code class=highlight><span class=nx>generate_token</span><span class=p>()</span></code>. Chúng ta sẽ hoàn thành thử thách.</p> <h3 id=exploition><strong>Exploition</strong><a class=headerlink href=#exploition title="Permanent link">&para;</a></h3> <p>F12 website ta thấy dòng token bị <code>hidden</code></p> <p><img alt src=image.png></p> <p>Ta sẽ tiêm <code>38581812b435834ebf84ebcc2c6424d6</code> (MD5(ROT13(success))) vào token và sẽ bypass được challenge này.</p> <p>Và xong, kết quả sẽ hiển thị như hình bên dưới</p> <p><img alt src=image-1.png></p> <hr> <h2 id=security-level-medium><strong>Security Level: Medium</strong><a class=headerlink href=#security-level-medium title="Permanent link">&para;</a></h2> <p>Source code</p> <div class=highlight><span class=filename>vulnerabilities/javascript/source/medium.php</span><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=cp>&lt;?php</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=nv>$page</span><span class=p>[</span> <span class=s1>&#39;body&#39;</span> <span class=p>]</span> <span class=o>.=</span> <span class=s1>&#39;&lt;script src=&quot;&#39;</span> <span class=o>.</span> <span class=nx>DVWA_WEB_PAGE_TO_ROOT</span> <span class=o>.</span> <span class=s1>&#39;vulnerabilities/javascript/source/medium.js&quot;&gt;&lt;/script&gt;&#39;</span><span class=p>;</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=cp>?&gt;</span>
</code></pre></div> <div class=highlight><span class=filename>vulnerabilities/javascript/source/medium.js</span><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=kd>function</span><span class=w> </span><span class=nx>do_something</span><span class=p>(</span><span class=nx>e</span><span class=p>){</span><span class=k>for</span><span class=p>(</span><span class=kd>var</span><span class=w> </span><span class=nx>t</span><span class=o>=</span><span class=s2>&quot;&quot;</span><span class=p>,</span><span class=nx>n</span><span class=o>=</span><span class=nx>e</span><span class=p>.</span><span class=nx>length</span><span class=o>-</span><span class=mf>1</span><span class=p>;</span><span class=nx>n</span><span class=o>&gt;=</span><span class=mf>0</span><span class=p>;</span><span class=nx>n</span><span class=o>--</span><span class=p>)</span><span class=nx>t</span><span class=o>+=</span><span class=nx>e</span><span class=p>[</span><span class=nx>n</span><span class=p>];</span><span class=k>return</span><span class=w> </span><span class=nx>t</span><span class=p>}</span><span class=nx>setTimeout</span><span class=p>(</span><span class=kd>function</span><span class=p>(){</span><span class=nx>do_elsesomething</span><span class=p>(</span><span class=s2>&quot;XX&quot;</span><span class=p>)},</span><span class=mf>300</span><span class=p>);</span><span class=kd>function</span><span class=w> </span><span class=nx>do_elsesomething</span><span class=p>(</span><span class=nx>e</span><span class=p>){</span><span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>&quot;token&quot;</span><span class=p>).</span><span class=nx>value</span><span class=o>=</span><span class=nx>do_something</span><span class=p>(</span><span class=nx>e</span><span class=o>+</span><span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>&quot;phrase&quot;</span><span class=p>).</span><span class=nx>value</span><span class=o>+</span><span class=s2>&quot;XX&quot;</span><span class=p>)}</span>
</code></pre></div> <h3 id=analysis_1><strong>Analysis</strong><a class=headerlink href=#analysis_1 title="Permanent link">&para;</a></h3> <p>Nhờ <a href=https://reqbin.com/code/javascript>https://reqbin.com/code/javascript</a> ta sẽ tìm được token mong muốn. </p> <div class=highlight><span class=filename>medium.js</span><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=kd>function</span><span class=w> </span><span class=nx>do_something</span><span class=p>(</span><span class=nx>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kd>var</span><span class=w> </span><span class=nx>t</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>n</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>e</span><span class=p>.</span><span class=nx>length</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mf>1</span><span class=p>;</span><span class=w> </span><span class=nx>n</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mf>0</span><span class=p>;</span><span class=w> </span><span class=nx>n</span><span class=o>--</span><span class=p>)</span>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=w>    </span><span class=nx>t</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=nx>e</span><span class=p>[</span><span class=nx>n</span><span class=p>];</span>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>t</span>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=p>}</span>
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=nx>setTimeout</span><span class=p>(</span><span class=kd>function</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=w>    </span><span class=nx>do_elsesomething</span><span class=p>(</span><span class=s2>&quot;XX&quot;</span><span class=p>)</span>
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=p>},</span><span class=w> </span><span class=mf>300</span><span class=p>);</span>
<a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a>
<a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=kd>function</span><span class=w> </span><span class=nx>do_elsesomething</span><span class=p>(</span><span class=nx>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a><span class=w>    </span><span class=kd>var</span><span class=w> </span><span class=nx>a</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>do_something</span><span class=p>(</span><span class=nx>e</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s2>&quot;successXX&quot;</span><span class=p>)</span>
<a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a><span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span>
<a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a><span class=p>}</span>
</code></pre></div> <h3 id=exploition_1><strong>Exploition</strong><a class=headerlink href=#exploition_1 title="Permanent link">&para;</a></h3> <p><img alt src=image-2.png></p> <hr> <h2 id=security-level-high><strong>Security Level: High</strong><a class=headerlink href=#security-level-high title="Permanent link">&para;</a></h2> <p>Source code</p> <div class=highlight><span class=filename>vulnerabilities/javascript/source/high.php</span><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=cp>&lt;?php</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=nv>$page</span><span class=p>[</span> <span class=s1>&#39;body&#39;</span> <span class=p>]</span> <span class=o>.=</span> <span class=s1>&#39;&lt;script src=&quot;&#39;</span> <span class=o>.</span> <span class=nx>DVWA_WEB_PAGE_TO_ROOT</span> <span class=o>.</span> <span class=s1>&#39;vulnerabilities/javascript/source/high.js&quot;&gt;&lt;/script&gt;&#39;</span><span class=p>;</span>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=cp>?&gt;</span>
</code></pre></div> <div class=highlight><span class=filename>vulnerabilities/javascript/source/high.js</span><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=kd>var</span><span class=w> </span><span class=nx>a</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;fromCharCode&#39;</span><span class=p>,</span><span class=s1>&#39;toString&#39;</span><span class=p>,</span><span class=s1>&#39;replace&#39;</span><span class=p>,</span><span class=s1>&#39;BeJ&#39;</span><span class=p>,</span><span class=s1>&#39;\x5cw+&#39;</span><span class=p>,</span><span class=s1>&#39;Lyg&#39;</span><span class=p>,</span><span class=s1>&#39;SuR&#39;</span><span class=p>,</span><span class=s1>&#39;(w(){\x273M\x203L\x27;q\x201l=\x273K\x203I\x203J\x20T\x27;q\x201R=1c\x202I===\x271n\x27;q\x20Y=1R?2I:{};p(Y.3N){1R=1O}q\x202L=!1R&amp;&amp;1c\x202M===\x271n\x27;q\x202o=!Y.2S&amp;&amp;1c\x202d===\x271n\x27&amp;&amp;2d.2Q&amp;&amp;2d.2Q.3S;p(2o){Y=3R}z\x20p(2L){Y=2M}q\x202G=!Y.3Q&amp;&amp;1c\x202g===\x271n\x27&amp;&amp;2g.X;q\x202s=1c\x202l===\x27w\x27&amp;&amp;2l.3P;q\x201y=!Y.3H&amp;&amp;1c\x20Z!==\x272T\x27;q\x20m=\x273G\x27.3z(\x27\x27);q\x202w=[-3y,3x,3v,3w];q\x20U=[24,16,8,0];q\x20K=[3A,3B,3F,3E,3D,3C,3T,3U,4d,4c,4b,49,4a,4e,4f,4j,4i,4h,3u,48,47,3Z,3Y,3X,3V,3W,40,41,46,45,43,42,4k,3f,38,36,39,37,34,33,2Y,31,2Z,35,3t,3n,3m,3l,3o,3p,3s,3r,3q,3k,3j,3d,3a,3c,3b,3e,3h,3g,3i,4g];q\x201E=[\x271e\x27,\x2727\x27,\x271G\x27,\x272R\x27];q\x20l=[];p(Y.2S||!1z.1K){1z.1K=w(1x){A\x204C.Q.2U.1I(1x)===\x27[1n\x201z]\x27}}p(1y&amp;&amp;(Y.50||!Z.1N)){Z.1N=w(1x){A\x201c\x201x===\x271n\x27&amp;&amp;1x.1w&amp;&amp;1x.1w.1J===Z}}q\x202m=w(1X,x){A\x20w(s){A\x20O\x20N(x,1d).S(s)[1X]()}};q\x202a=w(x){q\x20P=2m(\x271e\x27,x);p(2o){P=2P(P,x)}P.1T=w(){A\x20O\x20N(x)};P.S=w(s){A\x20P.1T().S(s)};1g(q\x20i=0;i&lt;1E.W;++i){q\x20T=1E[i];P[T]=2m(T,x)}A\x20P};q\x202P=w(P,x){q\x201S=2O(\x222N(\x271S\x27)\x22);q\x201Y=2O(\x222N(\x271w\x27).1Y\x22);q\x202n=x?\x271H\x27:\x271q\x27;q\x202z=w(s){p(1c\x20s===\x272p\x27){A\x201S.2x(2n).S(s,\x274S\x27).1G(\x271e\x27)}z{p(s===2q||s===2T){1u\x20O\x201t(1l)}z\x20p(s.1J===Z){s=O\x202r(s)}}p(1z.1K(s)||Z.1N(s)||s.1J===1Y){A\x201S.2x(2n).S(O\x201Y(s)).1G(\x271e\x27)}z{A\x20P(s)}};A\x202z};q\x202k=w(1X,x){A\x20w(G,s){A\x20O\x201P(G,x,1d).S(s)[1X]()}};q\x202f=w(x){q\x20P=2k(\x271e\x27,x);P.1T=w(G){A\x20O\x201P(G,x)};P.S=w(G,s){A\x20P.1T(G).S(s)};1g(q\x20i=0;i&lt;1E.W;++i){q\x20T=1E[i];P[T]=2k(T,x)}A\x20P};w\x20N(x,1v){p(1v){l[0]=l[16]=l[1]=l[2]=l[3]=l[4]=l[5]=l[6]=l[7]=l[8]=l[9]=l[10]=l[11]=l[12]=l[13]=l[14]=l[15]=0;k.l=l}z{k.l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}p(x){k.C=4I;k.B=4H;k.E=4l;k.F=4U;k.J=4J;k.I=4K;k.H=4L;k.D=4T}z{k.C=4X;k.B=4W;k.E=4Y;k.F=4Z;k.J=4V;k.I=4O;k.H=4F;k.D=4s}k.1C=k.1A=k.L=k.2i=0;k.1U=k.1L=1O;k.2j=1d;k.x=x}N.Q.S=w(s){p(k.1U){A}q\x202h,T=1c\x20s;p(T!==\x272p\x27){p(T===\x271n\x27){p(s===2q){1u\x20O\x201t(1l)}z\x20p(1y&amp;&amp;s.1J===Z){s=O\x202r(s)}z\x20p(!1z.1K(s)){p(!1y||!Z.1N(s)){1u\x20O\x201t(1l)}}}z{1u\x20O\x201t(1l)}2h=1d}q\x20r,M=0,i,W=s.W,l=k.l;4t(M&lt;W){p(k.1L){k.1L=1O;l[0]=k.1C;l[16]=l[1]=l[2]=l[3]=l[4]=l[5]=l[6]=l[7]=l[8]=l[9]=l[10]=l[11]=l[12]=l[13]=l[14]=l[15]=0}p(2h){1g(i=k.1A;M&lt;W&amp;&amp;i&lt;1k;++M){l[i&gt;&gt;2]|=s[M]&lt;&lt;U[i++&amp;3]}}z{1g(i=k.1A;M&lt;W&amp;&amp;i&lt;1k;++M){r=s.1Q(M);p(r&lt;R){l[i&gt;&gt;2]|=r&lt;&lt;U[i++&amp;3]}z\x20p(r&lt;2v){l[i&gt;&gt;2]|=(2t|(r&gt;&gt;6))&lt;&lt;U[i++&amp;3];l[i&gt;&gt;2]|=(R|(r&amp;V))&lt;&lt;U[i++&amp;3]}z\x20p(r&lt;2A||r&gt;=2E){l[i&gt;&gt;2]|=(2D|(r&gt;&gt;12))&lt;&lt;U[i++&amp;3];l[i&gt;&gt;2]|=(R|((r&gt;&gt;6)&amp;V))&lt;&lt;U[i++&amp;3];l[i&gt;&gt;2]|=(R|(r&amp;V))&lt;&lt;U[i++&amp;3]}z{r=2C+(((r&amp;23)&lt;&lt;10)|(s.1Q(++M)&amp;23));l[i&gt;&gt;2]|=(2X|(r&gt;&gt;18))&lt;&lt;U[i++&amp;3];l[i&gt;&gt;2]|=(R|((r&gt;&gt;12)&amp;V))&lt;&lt;U[i++&amp;3];l[i&gt;&gt;2]|=(R|((r&gt;&gt;6)&amp;V))&lt;&lt;U[i++&amp;3];l[i&gt;&gt;2]|=(R|(r&amp;V))&lt;&lt;U[i++&amp;3]}}}k.2u=i;k.L+=i-k.1A;p(i&gt;=1k){k.1C=l[16];k.1A=i-1k;k.1W();k.1L=1d}z{k.1A=i}}p(k.L&gt;4r){k.2i+=k.L/2H&lt;&lt;0;k.L=k.L%2H}A\x20k};N.Q.1s=w(){p(k.1U){A}k.1U=1d;q\x20l=k.l,i=k.2u;l[16]=k.1C;l[i&gt;&gt;2]|=2w[i&amp;3];k.1C=l[16];p(i&gt;=4q){p(!k.1L){k.1W()}l[0]=k.1C;l[16]=l[1]=l[2]=l[3]=l[4]=l[5]=l[6]=l[7]=l[8]=l[9]=l[10]=l[11]=l[12]=l[13]=l[14]=l[15]=0}l[14]=k.2i&lt;&lt;3|k.L&gt;&gt;&gt;29;l[15]=k.L&lt;&lt;3;k.1W()};N.Q.1W=w(){q\x20a=k.C,b=k.B,c=k.E,d=k.F,e=k.J,f=k.I,g=k.H,h=k.D,l=k.l,j,1a,1b,1j,v,1f,1h,1B,1Z,1V,1D;1g(j=16;j&lt;1k;++j){v=l[j-15];1a=((v&gt;&gt;&gt;7)|(v&lt;&lt;25))^((v&gt;&gt;&gt;18)|(v&lt;&lt;14))^(v&gt;&gt;&gt;3);v=l[j-2];1b=((v&gt;&gt;&gt;17)|(v&lt;&lt;15))^((v&gt;&gt;&gt;19)|(v&lt;&lt;13))^(v&gt;&gt;&gt;10);l[j]=l[j-16]+1a+l[j-7]+1b&lt;&lt;0}1D=b&amp;c;1g(j=0;j&lt;1k;j+=4){p(k.2j){p(k.x){1B=4m;v=l[0]-4n;h=v-4o&lt;&lt;0;d=v+4p&lt;&lt;0}z{1B=4v;v=l[0]-4w;h=v-4G&lt;&lt;0;d=v+4D&lt;&lt;0}k.2j=1O}z{1a=((a&gt;&gt;&gt;2)|(a&lt;&lt;30))^((a&gt;&gt;&gt;13)|(a&lt;&lt;19))^((a&gt;&gt;&gt;22)|(a&lt;&lt;10));1b=((e&gt;&gt;&gt;6)|(e&lt;&lt;26))^((e&gt;&gt;&gt;11)|(e&lt;&lt;21))^((e&gt;&gt;&gt;25)|(e&lt;&lt;7));1B=a&amp;b;1j=1B^(a&amp;c)^1D;1h=(e&amp;f)^(~e&amp;g);v=h+1b+1h+K[j]+l[j];1f=1a+1j;h=d+v&lt;&lt;0;d=v+1f&lt;&lt;0}1a=((d&gt;&gt;&gt;2)|(d&lt;&lt;30))^((d&gt;&gt;&gt;13)|(d&lt;&lt;19))^((d&gt;&gt;&gt;22)|(d&lt;&lt;10));1b=((h&gt;&gt;&gt;6)|(h&lt;&lt;26))^((h&gt;&gt;&gt;11)|(h&lt;&lt;21))^((h&gt;&gt;&gt;25)|(h&lt;&lt;7));1Z=d&amp;a;1j=1Z^(d&amp;b)^1B;1h=(h&amp;e)^(~h&amp;f);v=g+1b+1h+K[j+1]+l[j+1];1f=1a+1j;g=c+v&lt;&lt;0;c=v+1f&lt;&lt;0;1a=((c&gt;&gt;&gt;2)|(c&lt;&lt;30))^((c&gt;&gt;&gt;13)|(c&lt;&lt;19))^((c&gt;&gt;&gt;22)|(c&lt;&lt;10));1b=((g&gt;&gt;&gt;6)|(g&lt;&lt;26))^((g&gt;&gt;&gt;11)|(g&lt;&lt;21))^((g&gt;&gt;&gt;25)|(g&lt;&lt;7));1V=c&amp;d;1j=1V^(c&amp;a)^1Z;1h=(g&amp;h)^(~g&amp;e);v=f+1b+1h+K[j+2]+l[j+2];1f=1a+1j;f=b+v&lt;&lt;0;b=v+1f&lt;&lt;0;1a=((b&gt;&gt;&gt;2)|(b&lt;&lt;30))^((b&gt;&gt;&gt;13)|(b&lt;&lt;19))^((b&gt;&gt;&gt;22)|(b&lt;&lt;10));1b=((f&gt;&gt;&gt;6)|(f&lt;&lt;26))^((f&gt;&gt;&gt;11)|(f&lt;&lt;21))^((f&gt;&gt;&gt;25)|(f&lt;&lt;7));1D=b&amp;c;1j=1D^(b&amp;d)^1V;1h=(f&amp;g)^(~f&amp;h);v=e+1b+1h+K[j+3]+l[j+3];1f=1a+1j;e=a+v&lt;&lt;0;a=v+1f&lt;&lt;0}k.C=k.C+a&lt;&lt;0;k.B=k.B+b&lt;&lt;0;k.E=k.E+c&lt;&lt;0;k.F=k.F+d&lt;&lt;0;k.J=k.J+e&lt;&lt;0;k.I=k.I+f&lt;&lt;0;k.H=k.H+g&lt;&lt;0;k.D=k.D+h&lt;&lt;0};N.Q.1e=w(){k.1s();q\x20C=k.C,B=k.B,E=k.E,F=k.F,J=k.J,I=k.I,H=k.H,D=k.D;q\x201e=m[(C&gt;&gt;28)&amp;o]+m[(C&gt;&gt;24)&amp;o]+m[(C&gt;&gt;20)&amp;o]+m[(C&gt;&gt;16)&amp;o]+m[(C&gt;&gt;12)&amp;o]+m[(C&gt;&gt;8)&amp;o]+m[(C&gt;&gt;4)&amp;o]+m[C&amp;o]+m[(B&gt;&gt;28)&amp;o]+m[(B&gt;&gt;24)&amp;o]+m[(B&gt;&gt;20)&amp;o]+m[(B&gt;&gt;16)&amp;o]+m[(B&gt;&gt;12)&amp;o]+m[(B&gt;&gt;8)&amp;o]+m[(B&gt;&gt;4)&amp;o]+m[B&amp;o]+m[(E&gt;&gt;28)&amp;o]+m[(E&gt;&gt;24)&amp;o]+m[(E&gt;&gt;20)&amp;o]+m[(E&gt;&gt;16)&amp;o]+m[(E&gt;&gt;12)&amp;o]+m[(E&gt;&gt;8)&amp;o]+m[(E&gt;&gt;4)&amp;o]+m[E&amp;o]+m[(F&gt;&gt;28)&amp;o]+m[(F&gt;&gt;24)&amp;o]+m[(F&gt;&gt;20)&amp;o]+m[(F&gt;&gt;16)&amp;o]+m[(F&gt;&gt;12)&amp;o]+m[(F&gt;&gt;8)&amp;o]+m[(F&gt;&gt;4)&amp;o]+m[F&amp;o]+m[(J&gt;&gt;28)&amp;o]+m[(J&gt;&gt;24)&amp;o]+m[(J&gt;&gt;20)&amp;o]+m[(J&gt;&gt;16)&amp;o]+m[(J&gt;&gt;12)&amp;o]+m[(J&gt;&gt;8)&amp;o]+m[(J&gt;&gt;4)&amp;o]+m[J&amp;o]+m[(I&gt;&gt;28)&amp;o]+m[(I&gt;&gt;24)&amp;o]+m[(I&gt;&gt;20)&amp;o]+m[(I&gt;&gt;16)&amp;o]+m[(I&gt;&gt;12)&amp;o]+m[(I&gt;&gt;8)&amp;o]+m[(I&gt;&gt;4)&amp;o]+m[I&amp;o]+m[(H&gt;&gt;28)&amp;o]+m[(H&gt;&gt;24)&amp;o]+m[(H&gt;&gt;20)&amp;o]+m[(H&gt;&gt;16)&amp;o]+m[(H&gt;&gt;12)&amp;o]+m[(H&gt;&gt;8)&amp;o]+m[(H&gt;&gt;4)&amp;o]+m[H&amp;o];p(!k.x){1e+=m[(D&gt;&gt;28)&amp;o]+m[(D&gt;&gt;24)&amp;o]+m[(D&gt;&gt;20)&amp;o]+m[(D&gt;&gt;16)&amp;o]+m[(D&gt;&gt;12)&amp;o]+m[(D&gt;&gt;8)&amp;o]+m[(D&gt;&gt;4)&amp;o]+m[D&amp;o]}A\x201e};N.Q.2U=N.Q.1e;N.Q.1G=w(){k.1s();q\x20C=k.C,B=k.B,E=k.E,F=k.F,J=k.J,I=k.I,H=k.H,D=k.D;q\x202b=[(C&gt;&gt;24)&amp;u,(C&gt;&gt;16)&amp;u,(C&gt;&gt;8)&amp;u,C&amp;u,(B&gt;&gt;24)&amp;u,(B&gt;&gt;16)&amp;u,(B&gt;&gt;8)&amp;u,B&amp;u,(E&gt;&gt;24)&amp;u,(E&gt;&gt;16)&amp;u,(E&gt;&gt;8)&amp;u,E&amp;u,(F&gt;&gt;24)&amp;u,(F&gt;&gt;16)&amp;u,(F&gt;&gt;8)&amp;u,F&amp;u,(J&gt;&gt;24)&amp;u,(J&gt;&gt;16)&amp;u,(J&gt;&gt;8)&amp;u,J&amp;u,(I&gt;&gt;24)&amp;u,(I&gt;&gt;16)&amp;u,(I&gt;&gt;8)&amp;u,I&amp;u,(H&gt;&gt;24)&amp;u,(H&gt;&gt;16)&amp;u,(H&gt;&gt;8)&amp;u,H&amp;u];p(!k.x){2b.4A((D&gt;&gt;24)&amp;u,(D&gt;&gt;16)&amp;u,(D&gt;&gt;8)&amp;u,D&amp;u)}A\x202b};N.Q.27=N.Q.1G;N.Q.2R=w(){k.1s();q\x201w=O\x20Z(k.x?28:32);q\x201i=O\x204x(1w);1i.1p(0,k.C);1i.1p(4,k.B);1i.1p(8,k.E);1i.1p(12,k.F);1i.1p(16,k.J);1i.1p(20,k.I);1i.1p(24,k.H);p(!k.x){1i.1p(28,k.D)}A\x201w};w\x201P(G,x,1v){q\x20i,T=1c\x20G;p(T===\x272p\x27){q\x20L=[],W=G.W,M=0,r;1g(i=0;i&lt;W;++i){r=G.1Q(i);p(r&lt;R){L[M++]=r}z\x20p(r&lt;2v){L[M++]=(2t|(r&gt;&gt;6));L[M++]=(R|(r&amp;V))}z\x20p(r&lt;2A||r&gt;=2E){L[M++]=(2D|(r&gt;&gt;12));L[M++]=(R|((r&gt;&gt;6)&amp;V));L[M++]=(R|(r&amp;V))}z{r=2C+(((r&amp;23)&lt;&lt;10)|(G.1Q(++i)&amp;23));L[M++]=(2X|(r&gt;&gt;18));L[M++]=(R|((r&gt;&gt;12)&amp;V));L[M++]=(R|((r&gt;&gt;6)&amp;V));L[M++]=(R|(r&amp;V))}}G=L}z{p(T===\x271n\x27){p(G===2q){1u\x20O\x201t(1l)}z\x20p(1y&amp;&amp;G.1J===Z){G=O\x202r(G)}z\x20p(!1z.1K(G)){p(!1y||!Z.1N(G)){1u\x20O\x201t(1l)}}}z{1u\x20O\x201t(1l)}}p(G.W&gt;1k){G=(O\x20N(x,1d)).S(G).27()}q\x201F=[],2e=[];1g(i=0;i&lt;1k;++i){q\x20b=G[i]||0;1F[i]=4z^b;2e[i]=4y^b}N.1I(k,x,1v);k.S(2e);k.1F=1F;k.2c=1d;k.1v=1v}1P.Q=O\x20N();1P.Q.1s=w(){N.Q.1s.1I(k);p(k.2c){k.2c=1O;q\x202W=k.27();N.1I(k,k.x,k.1v);k.S(k.1F);k.S(2W);N.Q.1s.1I(k)}};q\x20X=2a();X.1q=X;X.1H=2a(1d);X.1q.2V=2f();X.1H.2V=2f(1d);p(2G){2g.X=X}z{Y.1q=X.1q;Y.1H=X.1H;p(2s){2l(w(){A\x20X})}}})();w\x202y(e){1g(q\x20t=\x22\x22,n=e.W-1;n&gt;=0;n--)t+=e[n];A\x20t}w\x202J(t,y=\x224B\x22){1m.1o(\x221M\x22).1r=1q(1m.1o(\x221M\x22).1r+y)}w\x202B(e=\x224E\x22){1m.1o(\x221M\x22).1r=1q(e+1m.1o(\x221M\x22).1r)}w\x202K(a,b){1m.1o(\x221M\x22).1r=2y(1m.1o(\x222F\x22).1r)}1m.1o(\x222F\x22).1r=\x22\x22;4u(w(){2B(\x224M\x22)},4N);1m.1o(\x224P\x22).4Q(\x224R\x22,2J);2K(\x223O\x22,44);&#39;</span><span class=p>,</span><span class=s1>&#39;||||||||||||||||||||this|blocks|HEX_CHARS||0x0F|if|var|code|message||0xFF|t1|function|is224||else|return|h1|h0|h7|h2|h3|key|h6|h5|h4||bytes|index|Sha256|new|method|prototype|0x80|update|type|SHIFT|0x3f|length|exports|root|ArrayBuffer|||||||||||s0|s1|typeof|true|hex|t2|for|ch|dataView|maj|64|ERROR|document|object|getElementById|setUint32|sha256|value|finalize|Error|throw|sharedMemory|buffer|obj|ARRAY_BUFFER|Array|start|ab|block|bc|OUTPUT_TYPES|oKeyPad|digest|sha224|call|constructor|isArray|hashed|token|isView|false|HmacSha256|charCodeAt|WINDOW|crypto|create|finalized|cd|hash|outputType|Buffer|da||||0x3ff||||array|||createMethod|arr|inner|process|iKeyPad|createHmacMethod|module|notString|hBytes|first|createHmacOutputMethod|define|createOutputMethod|algorithm|NODE_JS|string|null|Uint8Array|AMD|0xc0|lastByteIndex|0x800|EXTRA|createHash|do_something|nodeMethod|0xd800|token_part_2|0x10000|0xe0|0xe000|phrase|COMMON_JS|4294967296|window|token_part_3|token_part_1|WEB_WORKER|self|require|eval|nodeWrap|versions|arrayBuffer|JS_SHA256_NO_NODE_JS|undefined|toString|hmac|innerHash|0xf0|0xa2bfe8a1|0xc24b8b70||0xa81a664b||0x92722c85|0x81c2c92e|0xc76c51a3|0x53380d13|0x766a0abb|0x4d2c6dfc|0x650a7354|0x748f82ee|0x84c87814|0x78a5636f|0x682e6ff3|0x8cc70208|0x2e1b2138|0xa4506ceb|0x90befffa|0xbef9a3f7|0x5b9cca4f|0x4ed8aa4a|0x106aa070|0xf40e3585|0xd6990624|0x19a4c116|0x1e376c08|0x391c0cb3|0x34b0bcb5|0x2748774c|0xd192e819|0x0fc19dc6|32768|128|8388608|2147483648|split|0x428a2f98|0x71374491|0x59f111f1|0x3956c25b|0xe9b5dba5|0xb5c0fbcf|0123456789abcdef|JS_SHA256_NO_ARRAY_BUFFER|is|invalid|input|strict|use|JS_SHA256_NO_WINDOW|ABCD|amd|JS_SHA256_NO_COMMON_JS|global|node|0x923f82a4|0xab1c5ed5|0x983e5152|0xa831c66d|0x76f988da|0x5cb0a9dc|0x4a7484aa|0xb00327c8|0xbf597fc7|0x14292967|0x06ca6351||0xd5a79147|0xc6e00bf3|0x2de92c6f|0x240ca1cc|0x550c7dc3|0x72be5d74|0x243185be|0x12835b01|0xd807aa98|0x80deb1fe|0x9bdc06a7|0xc67178f2|0xefbe4786|0xe49b69c1|0xc19bf174|0x27b70a85|0x3070dd17|300032|1413257819|150054599|24177077|56|4294967295|0x5be0cd19|while|setTimeout|704751109|210244248|DataView|0x36|0x5c|push|ZZ|Object|143694565|YY|0x1f83d9ab|1521486534|0x367cd507|0xc1059ed8|0xffc00b31|0x68581511|0x64f98fa7|XX|300|0x9b05688c|send|addEventListener|click|utf8|0xbefa4fa4|0xf70e5939|0x510e527f|0xbb67ae85|0x6a09e667|0x3c6ef372|0xa54ff53a|JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW&#39;</span><span class=p>,</span><span class=s1>&#39;split&#39;</span><span class=p>];(</span><span class=kd>function</span><span class=p>(</span><span class=nx>c</span><span class=p>,</span><span class=nx>d</span><span class=p>){</span><span class=kd>var</span><span class=w> </span><span class=nx>e</span><span class=o>=</span><span class=kd>function</span><span class=p>(</span><span class=nx>f</span><span class=p>){</span><span class=k>while</span><span class=p>(</span><span class=o>--</span><span class=nx>f</span><span class=p>){</span><span class=nx>c</span><span class=p>[</span><span class=s1>&#39;push&#39;</span><span class=p>](</span><span class=nx>c</span><span class=p>[</span><span class=s1>&#39;shift&#39;</span><span class=p>]());}};</span><span class=nx>e</span><span class=p>(</span><span class=o>++</span><span class=nx>d</span><span class=p>);}(</span><span class=nx>a</span><span class=p>,</span><span class=mh>0x1f4</span><span class=p>));</span><span class=kd>var</span><span class=w> </span><span class=nx>b</span><span class=o>=</span><span class=kd>function</span><span class=p>(</span><span class=nx>c</span><span class=p>,</span><span class=nx>d</span><span class=p>){</span><span class=nx>c</span><span class=o>=</span><span class=nx>c</span><span class=o>-</span><span class=mh>0x0</span><span class=p>;</span><span class=kd>var</span><span class=w> </span><span class=nx>e</span><span class=o>=</span><span class=nx>a</span><span class=p>[</span><span class=nx>c</span><span class=p>];</span><span class=k>return</span><span class=w> </span><span class=nx>e</span><span class=p>;};</span><span class=nb>eval</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>d</span><span class=p>,</span><span class=nx>e</span><span class=p>,</span><span class=nx>f</span><span class=p>,</span><span class=nx>g</span><span class=p>,</span><span class=nx>h</span><span class=p>,</span><span class=nx>i</span><span class=p>){</span><span class=nx>h</span><span class=o>=</span><span class=kd>function</span><span class=p>(</span><span class=nx>j</span><span class=p>){</span><span class=k>return</span><span class=p>(</span><span class=nx>j</span><span class=o>&lt;</span><span class=nx>e</span><span class=o>?</span><span class=s1>&#39;&#39;</span><span class=o>:</span><span class=nx>h</span><span class=p>(</span><span class=nb>parseInt</span><span class=p>(</span><span class=nx>j</span><span class=o>/</span><span class=nx>e</span><span class=p>)))</span><span class=o>+</span><span class=p>((</span><span class=nx>j</span><span class=o>=</span><span class=nx>j</span><span class=o>%</span><span class=nx>e</span><span class=p>)</span><span class=o>&gt;</span><span class=mh>0x23</span><span class=o>?</span><span class=nb>String</span><span class=p>[</span><span class=nx>b</span><span class=p>(</span><span class=s1>&#39;0x0&#39;</span><span class=p>)](</span><span class=nx>j</span><span class=o>+</span><span class=mh>0x1d</span><span class=p>)</span><span class=o>:</span><span class=nx>j</span><span class=p>[</span><span class=nx>b</span><span class=p>(</span><span class=s1>&#39;0x1&#39;</span><span class=p>)](</span><span class=mh>0x24</span><span class=p>));};</span><span class=k>if</span><span class=p>(</span><span class=o>!</span><span class=s1>&#39;&#39;</span><span class=p>[</span><span class=nx>b</span><span class=p>(</span><span class=s1>&#39;0x2&#39;</span><span class=p>)](</span><span class=sr>/^/</span><span class=p>,</span><span class=nb>String</span><span class=p>)){</span><span class=k>while</span><span class=p>(</span><span class=nx>f</span><span class=o>--</span><span class=p>){</span><span class=nx>i</span><span class=p>[</span><span class=nx>h</span><span class=p>(</span><span class=nx>f</span><span class=p>)]</span><span class=o>=</span><span class=nx>g</span><span class=p>[</span><span class=nx>f</span><span class=p>]</span><span class=o>||</span><span class=nx>h</span><span class=p>(</span><span class=nx>f</span><span class=p>);}</span><span class=nx>g</span><span class=o>=</span><span class=p>[</span><span class=kd>function</span><span class=p>(</span><span class=nx>k</span><span class=p>){</span><span class=k>if</span><span class=p>(</span><span class=s1>&#39;wpA&#39;</span><span class=o>!==</span><span class=nx>b</span><span class=p>(</span><span class=s1>&#39;0x3&#39;</span><span class=p>)){</span><span class=k>return</span><span class=w> </span><span class=nx>i</span><span class=p>[</span><span class=nx>k</span><span class=p>];}</span><span class=k>else</span><span class=p>{</span><span class=k>while</span><span class=p>(</span><span class=nx>f</span><span class=o>--</span><span class=p>){</span><span class=nx>i</span><span class=p>[</span><span class=nx>k</span><span class=p>(</span><span class=nx>f</span><span class=p>)]</span><span class=o>=</span><span class=nx>g</span><span class=p>[</span><span class=nx>f</span><span class=p>]</span><span class=o>||</span><span class=nx>k</span><span class=p>(</span><span class=nx>f</span><span class=p>);}</span><span class=nx>g</span><span class=o>=</span><span class=p>[</span><span class=kd>function</span><span class=p>(</span><span class=nx>l</span><span class=p>){</span><span class=k>return</span><span class=w> </span><span class=nx>i</span><span class=p>[</span><span class=nx>l</span><span class=p>];}];</span><span class=nx>k</span><span class=o>=</span><span class=kd>function</span><span class=p>(){</span><span class=k>return</span><span class=w> </span><span class=nx>b</span><span class=p>(</span><span class=s1>&#39;0x4&#39;</span><span class=p>);};</span><span class=nx>f</span><span class=o>=</span><span class=mh>0x1</span><span class=p>;}}];</span><span class=nx>h</span><span class=o>=</span><span class=kd>function</span><span class=p>(){</span><span class=k>return</span><span class=w> </span><span class=nx>b</span><span class=p>(</span><span class=s1>&#39;0x4&#39;</span><span class=p>);};</span><span class=nx>f</span><span class=o>=</span><span class=mh>0x1</span><span class=p>;};</span><span class=k>while</span><span class=p>(</span><span class=nx>f</span><span class=o>--</span><span class=p>){</span><span class=k>if</span><span class=p>(</span><span class=nx>g</span><span class=p>[</span><span class=nx>f</span><span class=p>]){</span><span class=k>if</span><span class=p>(</span><span class=nx>b</span><span class=p>(</span><span class=s1>&#39;0x5&#39;</span><span class=p>)</span><span class=o>===</span><span class=nx>b</span><span class=p>(</span><span class=s1>&#39;0x6&#39;</span><span class=p>)){</span><span class=k>return</span><span class=w> </span><span class=nx>i</span><span class=p>[</span><span class=nx>h</span><span class=p>];}</span><span class=k>else</span><span class=p>{</span><span class=nx>d</span><span class=o>=</span><span class=nx>d</span><span class=p>[</span><span class=nx>b</span><span class=p>(</span><span class=s1>&#39;0x2&#39;</span><span class=p>)](</span><span class=ow>new</span><span class=w> </span><span class=nb>RegExp</span><span class=p>(</span><span class=s1>&#39;\x5cb&#39;</span><span class=o>+</span><span class=nx>h</span><span class=p>(</span><span class=nx>f</span><span class=p>)</span><span class=o>+</span><span class=s1>&#39;\x5cb&#39;</span><span class=p>,</span><span class=s1>&#39;g&#39;</span><span class=p>),</span><span class=nx>g</span><span class=p>[</span><span class=nx>f</span><span class=p>]);}}}</span><span class=k>return</span><span class=w> </span><span class=nx>d</span><span class=p>;}(</span><span class=nx>b</span><span class=p>(</span><span class=s1>&#39;0x7&#39;</span><span class=p>),</span><span class=mh>0x3e</span><span class=p>,</span><span class=mh>0x137</span><span class=p>,</span><span class=nx>b</span><span class=p>(</span><span class=s1>&#39;0x8&#39;</span><span class=p>)[</span><span class=nx>b</span><span class=p>(</span><span class=s1>&#39;0x9&#39;</span><span class=p>)](</span><span class=s1>&#39;|&#39;</span><span class=p>),</span><span class=mh>0x0</span><span class=p>,{}));</span>
</code></pre></div> <h3 id=analysis_2><strong>Analysis</strong><a class=headerlink href=#analysis_2 title="Permanent link">&para;</a></h3> <p>Với bài này, ta thấy đoạn code javascript khá khó hiểu. Thì thực ra đoạn mã này đã bị <a href=https://www.cleancss.com/javascript-obfuscate/index.php>Obfuscation</a>, và ta sẽ dùng <a href=http://deobfuscatejavascript.com/#>deobfuscate javascript</a> để xem code. </p> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=kd>function</span><span class=w> </span><span class=nx>do_something</span><span class=p>(</span><span class=nx>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kd>var</span><span class=w> </span><span class=nx>t</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>n</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>e</span><span class=p>.</span><span class=nx>length</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mf>1</span><span class=p>;</span><span class=w> </span><span class=nx>n</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mf>0</span><span class=p>;</span><span class=w> </span><span class=nx>n</span><span class=o>--</span><span class=p>)</span><span class=w> </span><span class=nx>t</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=nx>e</span><span class=p>[</span><span class=nx>n</span><span class=p>];</span>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>t</span>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=p>}</span>
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=kd>function</span><span class=w> </span><span class=nx>token_part_3</span><span class=p>(</span><span class=nx>t</span><span class=p>,</span><span class=w> </span><span class=nx>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;ZZ&quot;</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=w>    </span><span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>&quot;token&quot;</span><span class=p>).</span><span class=nx>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>sha256</span><span class=p>(</span><span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>&quot;token&quot;</span><span class=p>).</span><span class=nx>value</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>y</span><span class=p>)</span>
<a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=p>}</span>
<a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=kd>function</span><span class=w> </span><span class=nx>token_part_2</span><span class=p>(</span><span class=nx>e</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;YY&quot;</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=w>    </span><span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>&quot;token&quot;</span><span class=p>).</span><span class=nx>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>sha256</span><span class=p>(</span><span class=nx>e</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>&quot;token&quot;</span><span class=p>).</span><span class=nx>value</span><span class=p>)</span>
<a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=p>}</span>
<a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=kd>function</span><span class=w> </span><span class=nx>token_part_1</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span><span class=w> </span><span class=nx>b</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a><span class=w>    </span><span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>&quot;token&quot;</span><span class=p>).</span><span class=nx>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>do_something</span><span class=p>(</span><span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>&quot;phrase&quot;</span><span class=p>).</span><span class=nx>value</span><span class=p>)</span>
<a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a><span class=p>}</span>
<a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a><span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>&quot;phrase&quot;</span><span class=p>).</span><span class=nx>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;&quot;</span><span class=p>;</span>
<a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a><span class=nx>setTimeout</span><span class=p>(</span><span class=kd>function</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a><span class=w>    </span><span class=nx>token_part_2</span><span class=p>(</span><span class=s2>&quot;XX&quot;</span><span class=p>)</span>
<a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a><span class=p>},</span><span class=w> </span><span class=mf>300</span><span class=p>);</span>
<a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a><span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>&quot;send&quot;</span><span class=p>).</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&quot;click&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>token_part_3</span><span class=p>);</span>
<a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a><span class=nx>token_part_1</span><span class=p>(</span><span class=s2>&quot;ABCD&quot;</span><span class=p>,</span><span class=w> </span><span class=mf>44</span><span class=p>);</span>
</code></pre></div> <p>Ta lượm nhặt được các dòng quan trọng nằm cuối đoạn code. Lúc này ta sẽ phân tích xem trình tự thực thi của các hàm.</p> <p>Ta thấy tổng cộng có 3 hàm:</p> <ul> <li>token_part_1 - A</li> <li>token_part_2 - B</li> <li>token_part_3 - C</li> </ul> <p>Cái vấn đề nan giải ở đây là hàm setTimeout delay token_part_2() 300s, thì cho ta không biết được thứ tự chính xác của 3 hàm A, B, C chạy như thế nào. Hiển nhiên khi test với console.log("A"), console.log("B"), console.log("C") thì ta sẽ thấy được thứ tự gọi là C - A - B. Nhưng đây họ dùng SHA256 thì có thể thời gian nó chênh lệch và dẫn đến thứ tự gọi các hàm không còn đúng nữa.</p> <p>Well, sau một vài thao tác thử, ta có thể thấy được thứ tự gọi đúng là C - A - B và token cần tìm là <code>7f1bfaaf829f785ba5801d5bf68c1ecaf95ce04545462c8b8f311dfc9014068a</code> được lấy từ SHA256(XXsseccus)</p> <h3 id=exploition_2><strong>Exploition</strong><a class=headerlink href=#exploition_2 title="Permanent link">&para;</a></h3> <p>Khai thác như 2 challenge trước.</p> <p>Hãy xem một phần chatGPT phân tích cho đoạn mã javascript</p> <p><img alt src=image-3.png></p> <p>Sau khi gọi token_part_3. Ngay lập tức thực thi token_part_1 và có thể gần hết 300s (là thời điểm token_part_2 được gọi). </p> <p>Và token cần tìm là SHA256(XX + do_something("success"))</p> <hr> <h2 id=security-level-impossible><strong>Security Level: Impossible</strong><a class=headerlink href=#security-level-impossible title="Permanent link">&para;</a></h2> <p>You can never trust anything that comes from the user or prevent them from messing with it and so there is no impossible level.</p> <hr> <h2 id=spoiler><strong>Spoiler</strong><a class=headerlink href=#spoiler title="Permanent link">&para;</a></h2> <h3 id=low-level><strong>Low Level</strong><a class=headerlink href=#low-level title="Permanent link">&para;</a></h3> <p>All the JavaScript is included in the page. Read the source and work out what function is being used to generate the token required to match with the phrase and then call the function manually.</p> <p>Spoiler: Change the phrase to success and then use the function generate_token() to update the token.</p> <h3 id=medium-level><strong>Medium Level</strong><a class=headerlink href=#medium-level title="Permanent link">&para;</a></h3> <p>The JavaScript has been broken out into its own file and then minimized. You need to view the source for the included file and then work out what it is doing. Both Firefox and Chrome have a Pretty Print feature which attempts to reverse the compression and display code in a readable way.</p> <p>Spoiler: The file uses the setTimeout function to run the do_elsesomething function which generates the token.</p> <h3 id=high-level><strong>High Level</strong><a class=headerlink href=#high-level title="Permanent link">&para;</a></h3> <p>The JavaScript has been obfuscated by at least one engine. You are going to need to step through the code to work out what is useful, what is garbage and what is needed to complete the mission.</p> <p>Spoiler: <span style="background: #181826; color: #181826">If it helps, two packers have been used, the first is from <a href=https://www.danstools.com/javascript-obfuscate/index.php>Dan's Tools</a> and the second is the <a href=https://javascriptobfuscator.herokuapp.com/ >JavaScript Obfuscator Tool</a>. </span></p> <p>Spoiler 2: <span style="background: #181826; color: #181826">This deobfuscation tool seems to work the best on this code <a href=http://deobfuscatejavascript.com/ >deobfuscate javascript</a>.</span></p> <p>Spoiler 3: <span style="background: #181826; color: #181826">This is one way to do it... run the obfuscated JS through a deobfuscation app, intercept the response for the obfuscated JS and swap in the readable version. Work out the flow and you will see three functions that need to be called in order. Call the functions at the right time with the right parameters.</span></p> <h3 id=impossible-level><strong>Impossible Level</strong><a class=headerlink href=#impossible-level title="Permanent link">&para;</a></h3> <p>You can never trust the user and have to assume that any code sent to the user can be manipulated or bypassed and so there is no impossible level.</p> <hr> <h2 id=more-information><strong>More Information</strong><a class=headerlink href=#more-information title="Permanent link">&para;</a></h2> <ul> <li><a href=https://www.w3schools.com/js/ >https://www.w3schools.com/js/</a></li> <li><a href="https://www.youtube.com/watch?v=cs7EQdWO5o0&index=17&list=WL">https://www.youtube.com/watch?v=cs7EQdWO5o0&amp;index=17&amp;list=WL</a></li> <li><a href=https://ponyfoo.com/articles/es6-proxies-in-depth>https://ponyfoo.com/articles/es6-proxies-in-depth</a></li> </ul> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">September 29, 2023</span> <br> Created: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">September 16, 2023</span> </small> </div> <h2 id=__comments><strong>Comments</strong></h2> <script src=https://giscus.app/client.js data-repo=hieuhdh/hieuhdh.github.io data-repo-id=R_kgDOHowGCg data-category=General data-category-id=DIC_kwDOHowGCs4CQLlU data-mapping=pathname data-reactions-enabled=1 data-emit-metadata=1 data-theme=preferred_color_scheme data-lang=en crossorigin=anonymous async></script> <script>
  var theme, giscus = document.querySelector("script[src*=giscus]"),
    palette = __md_get("__palette");
  palette && "object" == typeof palette.color && (theme = "slate" === palette.color.scheme ? "dark" : "light", giscus
    .setAttribute("data-theme", theme)), document.addEventListener("DOMContentLoaded", function () {
    document.querySelector("[data-md-component=palette]").addEventListener("change", function () {
      var e = __md_get("__palette");
      e && "object" == typeof e.color && (e = "slate" === e.color.scheme ? "dark" : "light", document
        .querySelector(".giscus-frame").contentWindow.postMessage({
          giscus: {
            setConfig: {
              theme: e
            }
          }
        }, "https://giscus.app"))
    })
  })

</script> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2023 0x5h1n0k0 </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.annotate", "content.tooltips", "navigation.sections", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../assets/javascripts/bundle.6c7ad80a.min.js></script> <script src=../../assets/javascripts/cursor-effects.js></script> <!-- get ip
        <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
        <script>
            function taskService() {
                this.postListApi = function () {
                    return axios({
                        url: "https://api.ipify.org?format=json",
                        method: "GET",
                    });
                };
            }
            var TaskList = new taskService();

            TaskList.postListApi()
                .then(function (result) {

                    function taskService02() {
                        this.getListApiii = function () {
                            return axios({
                                url: "https://bedeu.herokuapp.com/iphomeposts/views/",
                                method: "POST",
                                data: {
                                    "ip": result.data.ip,
                                },
                            });
                        };
                    }
                    var TaskListList = new taskService02();

                    TaskListList.getListApiii()
                        .then(function (result) {
                            if (result.data.sl > 1) {
                                document.getElementById("view-user").innerHTML = result.data.sl + " times"
                            } else {
                                document.getElementById("view-user").innerHTML = result.data.sl + " time"
                            }
                        })
                        .catch(function (erro) {
                            console.log(erro)
                        });
                        
                    function taskService01() {
                        this.getListApii = function () {
                            return axios({
                                url: "https://bedeu.herokuapp.com/iphomeposts/views_total/",
                                method: "GET",
                            });
                        };
                    }
                    var TaskListt = new taskService01();

                    TaskListt.getListApii()
                        .then(function (result) {
                            document.getElementById("view-all").innerHTML = result.data
                        })
                        .catch(function (erro) {
                            console.log(erro)
                        });
                })
                .catch(function (erro) {});

        </script>

        <script>
            function taskServicePost() {
                this.postListApiTotal = function () {
                    return axios({
                        url: "https://api.ipify.org?format=json",
                        method: "GET",
                    });
                };
            }
            var TaskList = new taskServicePost();
            var arr = window.location.pathname.split('/');


            TaskList.postListApiTotal()
                .then(function (result) {

                    function taskServicePost02() {
                        this.getListApiUser = function () {
                            return axios({
                                url: "https://bedeu.herokuapp.com/ipposts/views/",
                                method: "POST",
                                data: {
                                    "ip": result.data.ip,
                                    "post": arr[arr.length - 2],
                                },
                            });
                        };
                    }
                    var TaskListUser = new taskServicePost02();

                    TaskListUser.getListApiUser()
                        .then(function (result) {
                            if (result.data.sl > 1) {
                                document.getElementById("view-post-user").innerHTML = result.data.sl + " times";
                            } else {
                                document.getElementById("view-post-user").innerHTML = result.data.sl + " time";
                            }
                        })
                        .catch(function (erro) {
                            console.log(erro)
                        });

                        function taskServicePost01() {
                        this.getListApiTotal = function () {
                            return axios({
                                url: "https://bedeu.herokuapp.com/ipposts/views_total/",
                                method: "POST",
                                data: {
                                    "post": arr[arr.length - 2],
                                },
                            });
                        };
                    }
                    var TaskListTotal = new taskServicePost01();

                    TaskListTotal.getListApiTotal()
                        .then(function (result) {
                            if (result.data > 1) {
                                document.getElementById("view-post-all").innerHTML = result.data + " times";
                            } else {
                                document.getElementById("view-post-all").innerHTML = result.data + " time";
                            }
                        })
                        .catch(function (erro) {
                            console.log(erro)
                        });
                })
                .catch(function (erro) {});

        </script> --> <script src=../../javascripts/consent.js></script> <script src=../../javascripts/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js></script> <script src=../../javascripts/tablesort.js></script> <script src=../../overrides/assets/javascripts/bundle.ed7d8744.min.js></script> <script src=../../overrides/assets/javascripts/cursor-effects.js></script> <!-- <script src="../../assets/javascripts/cursor-effects.js"></script> --> </body> </html>